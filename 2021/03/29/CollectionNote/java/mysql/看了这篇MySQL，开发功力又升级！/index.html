<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="momo"><meta name="copyright" content="momo"><meta name="generator" content="Hexo 5.2.0"><meta name="theme" content="hexo-theme-yun"><title>MySQL理解 | 我的笔记</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.25/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"ppxiaodi.gitee.io","root":"/","title":"momo的小站","version":"1.7.0","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"local_search":{"path":"/search.xml"},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><meta name="description" content="https:&#x2F;&#x2F;juejin.im&#x2F;post&#x2F;5e91d37ef265da47f7343db9 本文主要介绍 Mysql开发和面试中所必知的 本文较长，分为上下篇（可收藏，勿吃尘） 如有需要，可以参考 如有帮助，不忘 点赞 ❥  ¶一、MySQL架构 ¶1）MySQL简介  MySQL是一个关系型数据库管理系统，由瑞典MYSQL AB公司开发，目前属于Oracle公司。 MySQL是一种关联数据">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL理解">
<meta property="og:url" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/index.html">
<meta property="og:site_name" content="我的笔记">
<meta property="og:description" content="https:&#x2F;&#x2F;juejin.im&#x2F;post&#x2F;5e91d37ef265da47f7343db9 本文主要介绍 Mysql开发和面试中所必知的 本文较长，分为上下篇（可收藏，勿吃尘） 如有需要，可以参考 如有帮助，不忘 点赞 ❥  ¶一、MySQL架构 ¶1）MySQL简介  MySQL是一个关系型数据库管理系统，由瑞典MYSQL AB公司开发，目前属于Oracle公司。 MySQL是一种关联数据">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a21497b55c0">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a2150a24963">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a21536489af">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169d7d58bb2d3a">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a2160abc3f9">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a215bfcdb64">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a21635080fc">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a218c3f711b">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a2199803338">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a2184e2b41d">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a218fef62f4">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a21997b2554">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a219f6adb97">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a21d35f4a1d">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a21de367435">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a21e021194d">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a21e300d7ff">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a21e3dfa63b">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a21e6d89d74">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a221885c524">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cda63d2d72b">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cda63d16902">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cda6f300858">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cda718db9bc">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cda714f8a52">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cda72632657">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cda94bcfd7f">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cda9c901ebd">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cda9ea8063e">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cdaa20d6a27">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cdaa6b191c7">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cdac5d6037d">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cdad493f964">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cdad89dde87">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cdae6707299">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cdae8671279">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cdb00c57265">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cdb09eae7ac">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cdb09f6410f">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cdb14fdc8a9">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cdb221f4002">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cdb359d0bb2">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169e1eb70e393d">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169de0f8682350">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169de0f8ad7117">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169de0f97c20a4">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169de0fad94580">
<meta property="og:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169de0fad5dc5e">
<meta property="article:published_time" content="2021-03-28T16:00:00.000Z">
<meta property="article:modified_time" content="2021-07-11T08:54:53.957Z">
<meta property="article:author" content="momo">
<meta property="article:tag" content="mysql">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a21497b55c0"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="momo"><img width="96" loading="lazy" src="/yun.png" alt="momo"></a><div class="site-author-name"><a href="/about/">momo</a></div><a class="site-name" href="/about/site.html">我的笔记</a><sub class="site-subtitle"></sub><div class="site-desciption"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">198</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">58</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">47</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="文档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-rss-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://qm.qq.com/cgi-bin/qm/qr?k=kZJzggTTCf4SpvEQ8lXWoi5ZjhAx0ILZ&amp;jump_from=webapi" title="QQ 群 1050458482" target="_blank" style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/YunYouJun" title="GitHub" target="_blank" style="color:#6e5494"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://weibo.com/jizhideyunyoujun" title="微博" target="_blank" style="color:#E6162D"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-weibo-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.douban.com/people/yunyoujun/" title="豆瓣" target="_blank" style="color:#007722"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-douban-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=247102977" title="网易云音乐" target="_blank" style="color:#C20C0C"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-netease-cloud-music-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.zhihu.com/people/yunyoujun/" title="知乎" target="_blank" style="color:#0084FF"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-zhihu-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/1579790" title="哔哩哔哩" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/about/white-qrcode-and-search.jpg" title="微信公众号" target="_blank" style="color:#1AAD19"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-2-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://twitter.com/YunYouJun" title="Twitter" target="_blank" style="color:#1da1f2"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-twitter-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://t.me/elpsycn" title="Telegram Channel" target="_blank" style="color:#0088CC"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-telegram-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:me@yunyoujun.cn" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://travellings.link" title="Travelling" target="_blank" style="color:var(--hty-text-color)"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-train-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81MySQL%E6%9E%B6%E6%9E%84"><span class="toc-number">1.</span> <span class="toc-text">一、MySQL架构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89MySQL%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.</span> <span class="toc-text">1）MySQL简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%89MySQL%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.</span> <span class="toc-text">2）MySQL配置文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%EF%BC%89MySQL%E7%9A%84%E7%94%A8%E6%88%B7%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86"><span class="toc-number">1.3.</span> <span class="toc-text">3）MySQL的用户与权限管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%EF%BC%89MySQL%E5%85%B6%E4%BB%96%E9%85%8D%E7%BD%AE"><span class="toc-number">1.4.</span> <span class="toc-text">4）MySQL其他配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%EF%BC%89MySQL%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E"><span class="toc-number">1.5.</span> <span class="toc-text">5）MySQL存储引擎</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96%E5%88%86%E6%9E%90"><span class="toc-number">2.</span> <span class="toc-text">二、索引优化分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89%E6%80%A7%E8%83%BD%E4%B8%8B%E9%99%8D-SQL%E6%89%A7%E8%A1%8C%E6%97%B6%E9%97%B4%E9%95%BF"><span class="toc-number">2.1.</span> <span class="toc-text">1）性能下降&#x2F;SQL执行时间长</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%89JOIN%E6%9F%A5%E8%AF%A2"><span class="toc-number">2.2.</span> <span class="toc-text">2）JOIN查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%EF%BC%89%E7%B4%A2%E5%BC%95%E7%AE%80%E4%BB%8B"><span class="toc-number">2.3.</span> <span class="toc-text">3）索引简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%EF%BC%89%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90"><span class="toc-number">2.4.</span> <span class="toc-text">4）性能分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%EF%BC%89%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96"><span class="toc-number">2.5.</span> <span class="toc-text">5）查询优化</span></a></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="momo"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="我的笔记"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">MySQL理解</h1><div class="post-meta"><div class="post-time" style="display:inline-block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="创建时间：2021-03-29 00:00:00" itemprop="dateCreated datePublished" datetime="2021-03-29T00:00:00+08:00">2021-03-29</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="修改时间：2021-07-11 16:54:53" itemprop="dateModified" datetime="2021-07-11T16:54:53+08:00">2021-07-11</time></div><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/mysql/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">mysql</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/mysql/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">mysql</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#0078E7;"><blockquote>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/5e91d37ef265da47f7343db9">https://juejin.im/post/5e91d37ef265da47f7343db9</a></p>
<p>本文主要介绍 <strong>Mysql开发和面试中所必知的</strong><br>
<strong>本文较长，分为上下篇（可收藏，勿吃尘）</strong><br>
如有需要，可以参考<br>
如有帮助，不忘 <strong>点赞</strong> ❥</p>
</blockquote>
<h3 id="一、MySQL架构"><a class="header-anchor" href="#一、MySQL架构">¶</a>一、MySQL架构</h3>
<h4 id="1）MySQL简介"><a class="header-anchor" href="#1）MySQL简介">¶</a>1）MySQL简介</h4>
<blockquote>
<p>MySQL是一个关系型数据库管理系统，由瑞典MYSQL<br>
AB公司开发，目前属于Oracle公司。<br>
MySQL是一种关联数据库管理系统，将数据保存在不同的表中，而不是将所有数据放在一个大仓库中，这样就增加了速度并提高了灵活性。<br>
MySQL是开源的，是可以定制的，采用了GPL协议，你可以修改源码来开发自己的MySQL系统。<br>
MySQL支持大型的数据库。可以处理拥有上千万条记录的大型数据库。MySQL可以允许于多个系统上，并且支持多种语言。这些编程语言包括C、C++、Python、Java、Perl、PHP、Eiffel、Ruby和Tcl等。<br>
MySQL支持大型数据库，支持5000条记录的数据仓库，32位系统表文件最大可支持4GB，64位系统支持最大的表文件为8TB。</p>
</blockquote>
<h4 id="2）MySQL配置文件"><a class="header-anchor" href="#2）MySQL配置文件">¶</a>2）MySQL配置文件</h4>
<ul>
<li><code>binlog(二进制日志)</code><br>
用于主从复制及备份恢复：binlog中存放了所有操作记录，可用于恢复。相当于Redis中的AOF，my.ini中binlog配置（默认是关闭的）<strong>如何开启：</strong></li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">[mysqld]
log-bin &#x3D; mysql-bin
binlog-format &#x3D; row<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<ul>
<li><code>Error log(错误日志)</code><br>
默认是关闭的，通常用于记录数据库服务端启动、重启、主从复制时，记录错误，将日志详情保留在文件中，方便DBA、运维开发人员阅读。<strong>如何开启：</strong></li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">[mysqld]
log-error&#x3D;&#x2F;data&#x2F;mysql_error.log<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<ul>
<li><code>慢查询日志log</code><br>
默认是关闭的。记录查询的sql语句，如果开启会减低mysql的整体性能，因为记录日志也是需要消耗系统资源的。<strong>如何开启：</strong></li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">[mysqld]
slow_query_log &#x3D; ON
slow_query_log_file &#x3D; &#x2F;usr&#x2F;local&#x2F;mysql&#x2F;data&#x2F;slow.log &#x2F;&#x2F;linux
long_query_time &#x3D; 1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>
<p><code>数据文件</code><br>
<strong><code>windows</code>：</strong><br>
<code>..\mysql-8.0.19-winx64\data</code>目录下存储数据库文件<br>
<strong><code>linux</code>：</strong><br>
默认路径<code>/var/lib/mysql</code>（可在配置文件中更改/usr/share/mysql/下的my-huge.cnf）每个目录代表一个同名的库。<br>
<strong><code>Myisam存放方式</code>：</strong></p>
</li>
<li>
<p>frm文件（framework）：存放表结构</p>
</li>
<li>
<p>myd文件（data）：存放表数据</p>
</li>
<li>
<p>myi文件（index）：存放表索引<br>
<strong>innodb存放方式：</strong></p>
</li>
<li>
<p>ibdata1：Innodb引擎将所有表的数据都存放在这里面/usr/share/mysql/ibdata1而frm文件存放在库同名的包下</p>
</li>
<li>
<p>frm文件：存放表结构</p>
</li>
<li>
<p><code>配置方式</code></p>
</li>
<li>
<p>windows：<strong>my.ini</strong> 配置文件</p>
</li>
<li>
<p>linux：<strong>my.cnf</strong> 配置文件</p>
</li>
</ul>
<h4 id="3）MySQL的用户与权限管理"><a class="header-anchor" href="#3）MySQL的用户与权限管理">¶</a>3）MySQL的用户与权限管理</h4>
<ul>
<li><code>MysSQL用户管理</code></li>
<li><em>创建用户</em></li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">create user cbuc identified by &#39;123456&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li><em>关于 user 表</em></li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">select host,user,select_priv,insert_priv,drop_priv from mysql.user;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a21497b55c0" class="" title="img" loading="lazy">
<ul>
<li>
<p><strong>host：</strong> 表示连接类型<br>
**user：**表示用户名<br>
**select_priv，insert_priv，drop_priv等：**该用户所拥有的权限</p>
</li>
<li>
<p><em>设置密码</em><br>
– 修改当前用户的密码</p>
<pre class="line-numbers language-none"><code class="language-none">set password &#x3D; password(&#39;123456&#39;)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>– 修改某个用户的密码</p>
<pre class="line-numbers language-none"><code class="language-none">update mysql.user set password &#x3D; password(&#39;123456&#39;) where user &#x3D; &#39;cbuc&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><em>修改用户</em><br>
– 修改用户名：</p>
</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">update mysql.user set user &#x3D; &#39;cbuc&#39; where user&#x3D;&#39;c1&#39;;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>– 所有通过user表修改后必须用该命令才能生效<br>
flush privileges;</p>
<ul>
<li><em>删除用户</em><br>
– 不要通过**<code>delete from user t1 where t1.user='cbuc'</code>**进行删除，系统会有残留信息保留</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">drop user cbuc;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li>
<p><code>权限管理</code></p>
</li>
<li>
<p><em>授予权限：</em><br>
– 如果发现没有该用户，则会直接创建一个用户</p>
</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">grant 权限1，权限2,…,权限n on 数据库名.表名 to 用户名@用户地址 identified by &#39;密码&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>– 给cbuc用户赋予对表增删改查的权限</p>
<pre class="line-numbers language-none"><code class="language-none">grant select,insert,delete,update on db_crm.* to cbuc@localhost;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li><em>收回权限：</em><br>
– 如果已赋全库的表，就回收全库全表的所有权限\</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">revoke 权限1，权限2,…,权限n on 数据库名.表名 from 用户名@用户地址
revoke all privileges on mysql.* from cbuc@localhost<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<ul>
<li><em>收回权限：</em><br>
– 查看当前用户权限</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">show grants;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>– 查看某用户的全局权限</p>
<pre class="line-numbers language-none"><code class="language-none">select * from mysql.user;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>– 查看某用户的某库的权限</p>
<pre class="line-numbers language-none"><code class="language-none">select * from mysql.db;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>– 查看某用户的某个表的权限</p>
<pre class="line-numbers language-none"><code class="language-none">select * from mysql.tables_priv;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="4）MySQL其他配置"><a class="header-anchor" href="#4）MySQL其他配置">¶</a>4）MySQL其他配置</h4>
<ul>
<li><code>大小写问题</code></li>
</ul>
<blockquote>
<p>windows系统默认是大小写不敏感，但是linux系统是大小写敏感的。</p>
<ul>
<li><strong>0（默认）：</strong> 大小写敏感</li>
<li><strong>1：</strong> 大小写不敏感。创建的表，数据库都是以小写形式存放在磁盘中，对于sql语句都是转换为小写对表的DB进行查找。</li>
<li><strong>2：</strong> 创建的表和DB依据语句上格式存放，凡是查找都是转换为小写进行</li>
</ul>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">SHOW VARIABLES LIKE &#39;%lower_case_table_names%&#39;;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a2150a24963" class="" title="img" loading="lazy">
<p><strong>设置：</strong></p>
<pre class="line-numbers language-none"><code class="language-none">set lower_case_table_names &#x3D; 1;   #此变量是只读权限，需要在配置文件中修改<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ol>
<li>在my.inni / my.cnf中添加</li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">[mysqld]
lower_case_table_names &#x3D; 1 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<ol start="2">
<li>重启服务器（<strong>重启前要将原来的数据库和表转换为小写，否则更改后将找不到数据库名</strong>）</li>
</ol>
<ul>
<li><code>sql_mode</code></li>
</ul>
<blockquote>
<p><strong>sql_mode</strong> 是个很容易被忽视的变量，默认值是空值，在这种设置下是可以允许一些非法操作的，<br>
比如允许一些非法数据的插入。在生产环境必须将这个值设置为严格模式，所以开发、测试环境的数据库也必须要设置，这样在开发测试阶段就可以发现问题。</p>
</blockquote>
<p><strong>常用设置：</strong></p>
<pre class="line-numbers language-none"><code class="language-none">[mysqld]
sql-mode&#x3D;&quot;STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h4 id="5）MySQL存储引擎"><a class="header-anchor" href="#5）MySQL存储引擎">¶</a>5）MySQL存储引擎</h4>
<ul>
<li><code>查看引擎</code></li>
</ul>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a21536489af" class="" title="img" loading="lazy">
<p>码可以看出默认的存储引擎是<strong>InooDB</strong></p>
<ul>
<li>
<p><code>各引擎简介</code></p>
</li>
<li>
<p><strong>InnoDB存储引擎：</strong><br>
InnoDB是MySQL默认的<code>事务型引擎</code>，它被设计用来处理大量的短期（short-lived）事务。除非有非常特别的原因需要使用其他的存储引擎，否则应该优先考虑InnoDB引擎。具有<code>行级锁</code>，<code>外键</code>，<code>事务</code>等优势，适合<code>高并发情况</code>。</p>
</li>
<li>
<p><strong>MyISAM存储引擎：</strong><br>
MyISAM提供了大量的特性，包括全文索引、压缩、空间函数（GIS）等，但MyISAM<code>不支持事务和行级锁（MyISAM改表时会将整个表全锁住）</code>，缺陷：<code>崩溃后无法安全恢复</code>。</p>
</li>
<li>
<p><strong>Archive引擎：</strong><br>
rchive存储引擎<code>只支持 insert 和 select</code>操作，在MySQL5.1之前不支持索引。Archive表适合日志和数据采集类引用。<code>适合低访问量大数据等情况</code>。</p>
</li>
<li>
<p><strong>Blackhole引擎</strong><br>
Blackhole引擎没事实现任何存储机制，它会丢弃所有插入的数据，不任何保存。但服务器会记录Blackhole表的日志，所以可以用于复制数据到备库，或者简单地记录到日志。但这种应用方式会碰到很多问题，因此并不推荐。</p>
</li>
<li>
<p><strong>CSV引擎</strong><br>
CSV引擎可以将普通的CSV文件作为MySQL的表来处理，但不支持索引。可以作为一种数据交换的机制，非常有用。存储的数据直接可以在操作系统里，用文本编辑器，或者excel读取。</p>
</li>
<li>
<p><strong>Memory引擎</strong><br>
如果需要快速地访问数据，并且这些数据不会被修改，重启后丢失也没有关系的话，那么使用Memory表是非常有用的。Memory表至少比MyISAM表要快一个数量级。</p>
</li>
<li>
<p><strong>Federated引擎</strong><br>
Federated引擎是访问其他MySQL服务器的一个代理，尽管该引擎看起来提供了一种很好的跨服务器的灵活性，但也经常带来问题，因此默认是禁用的。</p>
</li>
<li>
<p><code>MyISAM和InnoDB比较</code></p>
</li>
</ul>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169d7d58bb2d3a" class="" title="img" loading="lazy">
<ul>
<li><strong>InnoDB主键为聚簇索引，基于聚簇索引的增删改查效率非常高</strong><br>
<strong>聚簇索引：</strong> 实际存储的循序结构与数据存储的物理机构是一致的<br>
<strong>非聚簇索引：</strong><br>
记录的物理顺序与逻辑顺序没有必然的联系，与数据的存储物理结构没有关系</li>
</ul>
<h3 id="二、索引优化分析"><a class="header-anchor" href="#二、索引优化分析">¶</a>二、索引优化分析</h3>
<h4 id="1）性能下降-SQL执行时间长"><a class="header-anchor" href="#1）性能下降-SQL执行时间长">¶</a>1）性能下降/SQL执行时间长</h4>
<ul>
<li>
<p><strong>查询数据过多</strong><br>
能拆则拆，条件过滤尽量少</p>
</li>
<li>
<p><strong>过多JOIN</strong><br>
JOIN原理：用A表的每一条数据扫描B表的所有数据，所以尽量先过滤再关联</p>
</li>
<li>
<p><strong>没有利用到索引</strong><br>
索引针对<code>列</code>建索引，但并不可能每一列都建索引<br>
索引并非越多越好。当数据更新了，索引会进行调整，也会很消耗性能。<br>
并且MySQL并不会把所有索引都用上，只会根据其算法挑一个索引用。所以建的准很重要</p>
</li>
<li>
<p><strong>服务器调优及各个参数设置（缓冲、线程数）</strong></p>
</li>
</ul>
<h4 id="2）JOIN查询"><a class="header-anchor" href="#2）JOIN查询">¶</a>2）JOIN查询</h4>
<ul>
<li>
<p><strong>SQL执行顺序</strong></p>
</li>
<li>
<p><code>人工读取顺序：</code></p>
</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">SELECT (DISTINCT)
&lt; select_list &gt;
FROM
&lt; left_table &gt; &lt; join_type &gt;
JOIN &lt; right_table &gt; ON &lt; join_condition &gt;
WHERE
&lt; where_condition &gt;
GROUP BY 
&lt; group_by_list &gt;
HAVING
&lt; having_condition&gt;
ORDER BY
&lt; order_by_condition &gt;
LIMIT &lt; limit_number &gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>引擎执行顺序：</code></p>
<pre class="line-numbers language-none"><code class="language-none">FROM &lt; left_table &gt;
ON &lt; join_condition &gt;
&lt; join_type &gt; JOIN &lt; right_table &gt;
WHERE &lt; where_condition &gt;
GROUP BY &lt; group_by_list &gt;
HAVING &lt; having_condition &gt;
SELECT 
(DISTINCT) &lt; select_list &gt;
ORDER BY &lt; order_by_condition &gt;
LIMIT &lt; limit_number &gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>总结：</code></p>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a2160abc3f9" class="" title="img" loading="lazy">
<ul>
<li>
<p><strong>共有/独有</strong><br>
有两个表，员工表Employee和部门表Dept，员工表里面有Dept字段与部门表的主键ID相对应。<br>
<code>共有：</code>满足employee.deptId = <a target="_blank" rel="noopener" href="http://dept.id">dept.id</a> 的数据 称为两表共有<br>
<code>独有：</code>employee.deptId &lt;&gt; <a target="_blank" rel="noopener" href="http://dept.id">dept.id</a> 的数据 称为员工表独有</p>
</li>
<li>
<p><strong>七种JOIN</strong><br>
有两个表，t1 表是员工表 emp，t1 表是部门表 dept</p>
</li>
</ul>
<p><code>1、</code> t1 表和 t2 表共有 (<strong>inner join</strong>)</p>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a215bfcdb64" class="" title="在这里插入图片描述" loading="lazy">
<p>在这里插入图片描述</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp t1 inner join dept t2 on t1.deptId &#x3D; t2.id<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><code>2、</code>t1 表和 t2 表共有 + t1 表独有 (<strong>left join</strong>)</p>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a21635080fc" class="" title="在这里插入图片描述" loading="lazy">
<p>在这里插入图片描述</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp t1 left join dept t2 on t1.deptId &#x3D; t2.id<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><code>3、</code>t1 表和 t2 表共有 + t2表独有（<strong>right join</strong>）</p>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a218c3f711b" class="" title="在这里插入图片描述" loading="lazy">
<p>在这里插入图片描述</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp t1 right join dept t2 on t1.deptId &#x3D; t2.id<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><code>4、</code> t1 表的独有（<strong>left join…where <a target="_blank" rel="noopener" href="http://t2.id">t2.id</a> is null</strong>）</p>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a2199803338" class="" title="在这里插入图片描述" loading="lazy">
<p>在这里插入图片描述</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp t1 left join dept t2 on t1.deptId &#x3D; t2.id where t2.id is null<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><code>5.</code>t2 表的独有（<strong>right join…where <a target="_blank" rel="noopener" href="http://t1.id">t1.id</a> is null</strong>）</p>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a2184e2b41d" class="" title="在这里插入图片描述" loading="lazy">
<p>在这里插入图片描述</p>
<p><code>6.</code> t1 表和 t2 表全有（<strong>union</strong>）</p>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a218fef62f4" class="" title="在这里插入图片描述" loading="lazy">
<p>在这里插入图片描述</p>
<p>MySQL中不支持FULL JOIN<br>
<strong>UNION：</strong> 可去除重复数据<br>
<strong>UNION ALL：</strong> 不去除重复数据</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp t1 left join dept t2 on t1.deptId &#x3D; t2.id
union
select * from emp t1 right join dept t2 on t1.deptid &#x3D; t2.id<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><code>7、</code> t1 表的独有 + t2 表的独有（<strong>union</strong>）</p>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a21997b2554" class="" title="在这里插入图片描述" loading="lazy">
<p>在这里插入图片描述</p>
<pre class="line-numbers language-none"><code class="language-none">select * from emp t1 left join dept t2 on t1.deptId &#x3D; t2.id where t2.id is null
UNION
select * from emp t1 right join dept t2 on t1.deptId &#x3D; t2.id 
where t1.deptId is null <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="3）索引简介"><a class="header-anchor" href="#3）索引简介">¶</a>3）索引简介</h4>
<blockquote>
<p>MySQL官方对索引的定义为：索引（Index）是帮助MySQL高效获取数据的数据结构。可以得到索引的本质：<strong>索引是数据结构。</strong><br>
目的在于提高查询效率，可以类比字典。</p>
</blockquote>
<ul>
<li>简单理解为 <strong>“排好序的快速查找数据结构”</strong> ：<br>
在数据之外，<strong>数据库系统还维护着满足特定查找算法的数据结构</strong>，这些数据结构以某种方式引用（指向）数据。</li>
</ul>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a219f6adb97" class="" title="在这里插入图片描述" loading="lazy">
<p>左边是数据表，一共有两列七条数据，最左边是数据记录的物理地址，为了加快Col2的查找，可以维护一个右边所示的二叉查找树，每个节点分别包含索引值和一个指向对应数据记录物理地址的指针，这样就可以运用二叉查找在一定的复杂度内获取到相应数据，从而快速的检索出符合条件的记录。<br>
<strong>二叉树：</strong> 二叉树很可能会发生两边不平衡的情况。<br>
<strong>B-Tree：</strong><br>
会自动根据两边的情况自动调节，使两端无限趋近于平衡状态，可以使性能最稳定。但是<code>插入/修改</code>操作过多时，B-TREE会不断调整平衡，消耗性能。</p>
<ul>
<li>
<p>一般来说索引本身也很大，不可能全部存储在内存中，因此索引往往以索引文件的形式存储在磁盘上。</p>
</li>
<li>
<p>我们平常所说的索引，如果没有特别指明，都是指<strong>B树</strong><br>
（多路搜索树，并不一定是二叉的）结构组织的索引。其中聚集索引，次要索引，覆盖索引，复合索引，前缀索引，唯一索引默认都是使用B+树这种类型的索引之外，还有哈希索引（hash index）等。</p>
</li>
<li>
<p><code>索引优势</code></p>
</li>
<li>
<p>类似图书馆简历书目索引，提高数据检索的效率，降低数据库的IO成本。</p>
</li>
<li>
<p>通过索引列对数据进行排序，降低数据排序的成本，降低了CPU的消耗。</p>
</li>
<li>
<p><code>索引劣势</code></p>
</li>
<li>
<p>实际上索引也是一张表，该表保存了主键与索引字段，并指向实体表的记录，所以索引列也是要占用空间的。</p>
</li>
<li>
<p>虽然索引大大提高了查询速度，同时却会<strong>降低更新表的速度</strong>，如对表进行INSERT、UPDATE、和DELETE，因为更新表时，MySQL不仅要保存数据，还要保存一下索引文件每次更新添加了索引列的字段，都会调整因为更新所带来的键值变化后的索引信息。</p>
</li>
<li>
<p><strong>索引只是提高效率的一个因素，如果你的MySQL有大量的表，就需要花时间研究建立最优秀的索引，或优化查询语句</strong></p>
</li>
<li>
<p><code>索引结构</code></p>
<ul>
<li><strong>BTree索引：</strong><br>
<code>真实数据存在于叶子节点</code>，即3、5、9、10、13、15、28、29、36、60、75、79、90、99.<br>
<code>非叶子节点不存储真实的数据，只存储指引搜索方向的数据项</code>，如17、35并不真实存在于数据表中。</li>
</ul>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a21d35f4a1d" class="" title="在这里插入图片描述" loading="lazy">
<ul>
<li>在这里插入图片描述</li>
</ul>
<p>【查找过程】<br>
如果要查找数据29，那么首先会把磁盘块1有磁盘加载到内存，此时发生一次IO，在内存中用二分查找确定29在17和35之间，锁定磁盘块1的P2指针，内存时间因为非常短（相比磁盘的IO）可以忽略不计，通过磁盘块1的的P2指针的磁盘的磁盘地址把磁盘块3由磁盘加载到内存，发生第二次IO，29在26和30之间，锁定磁盘块3的P2指针，通过指针加载磁盘块8到内存，发生第三次IO，同时内存中做二分查找到29，结束查询，总计三次IO</p>
<ul>
<li><strong>B+Tree索引：</strong></li>
</ul>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a21de367435" class="" title="在这里插入图片描述" loading="lazy">
<p>B+Tree<br>
第二级的数据并不能直接取出来，只作索引使用。在内存有限的情况下，查询效率高于BTree<br>
BTree第二级可以直接取出来，树形结构比较重，在内存无限大到时候有优势。</p>
</li>
<li>
<p><code>【B+Tree 和 BTree 的区别】</code><br>
<strong>1）</strong> 内存有限的情况下，B+Tree永远比BTree好，无限内存则反之<br>
**2）**B树的关键字和记录是放在一起的，叶子节点可以看做外部节点，不包含任何信息；B+树叶子节点中国你只有关键字和指向下一个节点的索引，记录只放在叶子节点中。（一次查询可能进行两次I/O操作）<br>
**3）**在B树中，越靠近根节点的记录查找时间越快，只要找到关键字即可确定记录存在；而B+树每个记录的查找时间基本是一样的，都需要从根节点走到叶子节点，而且在叶子节点中还要在比较关键字。从这个角度看B树的性能好像会比B+树好，而在实际应用中却是B+树的性能要好些。因为B+树的非叶子节点不存放实际的数据，这样每个节点可容纳的元素个数比B数多，树高比B树小，这样带来的好处是减少磁盘访问次数。尽管B+树找到一个记录所需的比较次数比B树多但是一次磁盘访问时间相当于成百上千次内存比较时间，因此实际中B+树的性能可能还会好写，而且B+树的叶子节点使用指针连接在一起，方便顺序遍历（例如查看一个目录下的所有文件，一个表中的所有记录等）<br>
<strong>4）</strong> B+树的磁盘读写代价更低，相对来说IO读写次数也就降低了。<br>
**5）**B+树的查询效率更加稳定。由于非终结点并不是指向文件内容的节点，而只是叶子节点中关键字的索引。所以任何关键字的查找必须走一条从根节点到叶子节点的路。所以关键字查询的路径长度相同，导致每一个数据的查询效率相当。</p>
<ul>
<li><strong>聚簇索引</strong></li>
</ul>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a21e021194d" class="" title="在这里插入图片描述" loading="lazy">
<p><code>好处：</code><br>
按照聚簇索引排序顺序，查询显示一定范围数据的时候，由于数据都是紧密相连，数据库不用从多个数据块中提取数据，所以节省了大量的IO操作。<br>
<code>限制：</code></p>
<ul>
<li>
<p>对于MySQL数据库目前只有InnoDB数据引擎支持聚簇索引，而MyISAM并不支持聚簇索引。</p>
</li>
<li>
<p>由于数据物理存储排序方式只能有一种，所以每个MySQL的表只能有一个聚簇索引。一般情况下就是该表的<strong>主键</strong>。</p>
</li>
<li>
<p><strong>full-text全文索引</strong></p>
</li>
</ul>
<blockquote>
<p>全文索引（也称全文检索）是目前搜索引擎使用的一种关键技术。它能够利用<code>分词技术</code>等多种算法智能分析出文本文字中关键词的频率和重要性，然后按照一定的算法规则智能地筛选出我们想要的搜索结果。</p>
</blockquote>
<ul>
<li><code>查询：</code></li>
</ul>
<pre class="line-numbers language-none"><code class="language-none"># 传统 LIKE 查询
select * from blink t1 where t1.content like &#39;%菜%&#39;

# 全文检索
select * from blink t1 where MATCH(title,content) AGAINST(&#39;菜&#39;) <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>
<p><code>限制：</code> MySQL5.6.4之前只用MyISAM 支持，5.6.4以后InnoDB才支持，但是官方版不支持中文分词，需要第三方分词插件。</p>
</li>
<li>
<p><strong>Hash索引</strong></p>
</li>
<li>
<p>Hash 索引只有Memory，NDB两种引擎支持，Memory引擎默认支持。</p>
</li>
<li>
<p>Hash索引，如果多个Hash值相同，出现哈希碰撞，那么索引以链表的方式存储。</p>
</li>
<li>
<p>NoSql采用此索引结构。</p>
</li>
<li>
<p><strong>RTree索引</strong><br>
R-Tree在MySQL很少使用，仅支持geometry数据结构，支持该类型的存储引擎只有MyISAM、bdb、InnoDB、ndb、archive几种。相对于B-Tree，R-Tree的优势在于<code>查找</code>。</p>
</li>
</ul>
</li>
<li>
<p><code>索引分类</code></p>
</li>
<li>
<p><strong>主键索引</strong><br>
设定为主键后数据库会自动简历索引，InnoDB采用聚簇索引<br>
<code>语法：</code></p>
</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">#随表一起创建
CREATE TABLE emp (
# 使用AUTO_INCREMENT关键字的列必须要有索引
ID int(10) UNSIGNED AUTO_INCREMENT
, NAME varchar(8)
, PRIMARY KEY(ID)
 )

# 单独建主键索引
ALTER TABLE emp add PRIMARY KEY emp(id);

# 删除主键索引
ALTER TABLE emp drop PRIMARY KEY;   # 修改主键索引前必须删除(drop)原索引，再新建(add)索引<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><strong>单值索引</strong><br>
即一个索引只包含单个列，一个表可以有多个单列索引。<br>
<code>语法：</code></li>
</ul>
<pre class="line-numbers language-none"><code class="language-none"># 随表一起创建
CREATE TABLE emp (
# 使用AUTO_INCREMENT关键字的列必须要有索引
ID int(10) UNSIGNED AUTO_INCREMENT
, EMP_NO varchar(8)
, NAME varchar(8)
, KEY(EMP_NO)
 )

# 单独建单列索引
create index idx_emp_no on emp(EMP_NO)

# 删除单列索引
drop index idx_emp_no<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><strong>唯一索引</strong><br>
索引列的值必须唯一，但允许有空值。<br>
建立唯一索引是必须保证所有的值是唯一的(除了null)，若有重复数据，会报错</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none"># 随表一起创建
CREATE TABLE emp (
# 使用AUTO_INCREMENT关键字的列必须要有索引
ID int(10) UNSIGNED AUTO_INCREMENT
, EMP_NO varchar(8)
, NAME varchar(8)
, UNIQUE(EMP_NO)
 )

# 单独建唯一索引
create unique index idx_emp_no on emp(EMP_NO)

# 删除主键索引
drop index idx_emp_no on emp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><strong>复合索引</strong><br>
在数据库操作期间，复合索引比单值索引所需要的开销更小（对于相同的多个列建索引）;<br>
当表的行数远大于索引列的数目时可以使用复合索引。</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none"># 随表一起创建
CREATE TABLE emp (
# 使用AUTO_INCREMENT关键字的列必须要有索引
ID int(10) UNSIGNED AUTO_INCREMENT
, EMP_NO varchar(8)
, NAME varchar(8)
, key(EMP_NO，NAME)
 )
#建立唯一索引是必须保证所有的值是唯一的(除了null)，若有重复数据，会报错

# 单独建唯一索引
create index idx_no_name on emp(EMP_NO,NAME)

# 删除主键索引
drop index idx_no_name on emp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>【基本语法】</code></p>
<pre class="line-numbers language-none"><code class="language-none"># 创建
alter &lt; table_name &gt; add [unique] index &lt;index_name&gt; on &lt;column_name&gt;

# 删除
drop index &lt;index_name&gt; on &lt;table_name&gt;

#查看
show index from &lt;table_name&gt;

#使用ALTER命令
#方式1：该语句添加一个主键，这意味着索引值必须是唯一的，且不能为null
alter table &lt;table_name&gt; add primary key &lt;column_name&gt;

#方式2：该语句添加一个唯一索引，值必须是唯一的(null外，null可能会出现很多次)
alter table &lt;table_name&gt; add unique key &lt;column_name&gt;

#方式3：该语句添加普通索引，索引值可以出现很多次
alter table &lt;table_name&gt; add index &lt;index_name&gt;(column_name)

#方式4：该语句指定了索引为FULLTEXT，用户全文索引
alter table &lt;table_name&gt; add FULLTEXT &lt;index_name&gt;(column_name)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>
<p><code>哪些情况需要建立索引</code></p>
</li>
<li>
<p>主键自动建立唯一索引</p>
</li>
<li>
<p>频繁作为<strong>查询条件</strong>的字段应该创建索引（where后面的语句）</p>
</li>
<li>
<p>查询中与其他表关联的字段，外键关系建立索引</p>
</li>
<li>
<p>单键/组合索引的选择问题（在高并发下倾向创建组合索引）</p>
</li>
<li>
<p><strong>查询中排序的字段</strong>，排序字段若通过索引去访问将大大提高排序速度</p>
</li>
<li>
<p><strong>查询中统计或者分组字段</strong></p>
</li>
<li>
<p><code>哪些情况不需要建立索引</code></p>
</li>
<li>
<p>表记录太少</p>
</li>
<li>
<p>经常增删改的表（因为更新表时，MySQL不仅要保存数据，还要保存一下索引文件）</p>
</li>
<li>
<p>where 条件里用不到的字段不创建索引</p>
</li>
<li>
<p>数据重复且分布平均的表字段，因此应该只为最经常查询和最经常排序的数据列建立索引。注意，如果某个数据列包含许多重复的内容，为它建立索引就没有太大的实际效果。</p>
</li>
</ul>
<h4 id="4）性能分析"><a class="header-anchor" href="#4）性能分析">¶</a>4）性能分析</h4>
<ul>
<li>
<p><code>MySQL常见瓶颈</code></p>
</li>
<li>
<p><strong>CPU</strong><br>
SQL中对大量数据进行比较、关联、排序、分组（最大的压力在于<strong>比较</strong>）</p>
</li>
<li>
<p><strong>IO</strong><br>
实例内存满足不了缓存数据或排序等需要，导致产生大量物理IP。查询执行效率低，扫描过多数据行。</p>
</li>
<li>
<p><strong>锁</strong><br>
不适宜的锁的设置，导致线程阻塞，性能下降。死锁，线程之间交叉调用资源，导致死锁，程序卡主。</p>
</li>
<li>
<p><code>服务器硬件的性能瓶颈：</code><br>
top，free，iostat和vmstat来查看系统的性能状态</p>
</li>
<li>
<p><code>Explain的使用</code></p>
</li>
</ul>
<blockquote>
<p>使用<strong>Explain</strong>关键字可以模拟优化器执行SQL查询语句，从而知道MySQL是如何处理你的SQL语句的。分析你的查询语句或是表结构的性能瓶颈</p>
</blockquote>
<ul>
<li><strong>可以查看的内容</strong></li>
</ul>
<ol>
<li>
<p>表的读取顺序</p>
</li>
<li>
<p>哪些索引可以使用</p>
</li>
<li>
<p>哪些索引被实际使用</p>
</li>
<li>
<p>表之间的引用</p>
</li>
<li>
<p>每张表有多少行被优化器查询</p>
</li>
</ol>
<ul>
<li><strong>怎么用</strong><br>
<code>explain + SQL语句</code><br>
包含的信息：</li>
</ul>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a21e300d7ff" class="" title="img" loading="lazy">
<ul>
<li><strong>各字段解释</strong></li>
</ul>
<p><code>1.【 id】</code><br>
select查询的序列号，包含一组数字，表示查询中执行select字句或操作表的顺序。<br>
<em><strong>三种情况：</strong></em></p>
<ul>
<li><strong>id相同，执行顺序由上至下</strong></li>
</ul>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a21e3dfa63b" class="" title="img" loading="lazy">
<ul>
<li><strong>id不同，如果是子查询，id的序号会递增，id值越大优先级越高，越被先执行</strong></li>
</ul>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a21e6d89d74" class="" title="img" loading="lazy">
<ul>
<li><strong>id相同和不同同时存在</strong></li>
</ul>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169a221885c524" class="" title="img" loading="lazy">
<p><strong>id如果相同，可以认为是一组，从上往下顺序执行；在所有组中，id值越大，优先级越高，越先执行。</strong><br>
<code>2.【select_type】</code></p>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cda63d2d72b" class="" title="img" loading="lazy">
<ul>
<li><strong>SIMPLE</strong><br>
简单的select查询，查询中不包含子查询或者UNION</li>
</ul>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cda63d16902" class="" title="img" loading="lazy">
<ul>
<li><strong>PRIMARY</strong><br>
查询中若包含任何复杂的子部分，最外层查询则被标记为Primary</li>
</ul>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cda6f300858" class="" title="img" loading="lazy">
<ul>
<li><strong>DERIVED</strong><br>
在FROM列表中包含的子查询被标记为DERIVED（衍生）MySQL会递归执行这些子查询，把结果放在临时表里。</li>
</ul>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cda718db9bc" class="" title="img" loading="lazy">
<ul>
<li><strong>SUBQUERY</strong><br>
在SELECT或WHERE列表中包含了子查询</li>
</ul>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cda714f8a52" class="" title="img" loading="lazy">
<ul>
<li><strong>DEPENDENT SUBQUERY</strong><br>
在SELECT或WHERE列表中包含了子查询，子查询基于外层</li>
</ul>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cda72632657" class="" title="img" loading="lazy">
<ul>
<li>
<p><code>【dependent subquery 和 subquery 的区别】</code><br>
依赖子查询：子查询结果为多值<br>
子查询：查询结果为单值</p>
</li>
<li>
<p><strong>UNCACHEABLE SUBQUERY</strong><br>
无法被缓存的子查询</p>
</li>
</ul>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cda94bcfd7f" class="" title="img" loading="lazy">
<ul>
<li>
<p>@@表示查的是环境参数，没办法缓存</p>
</li>
<li>
<p><strong>UNION</strong><br>
若第二个SELECT出现在UNION之后，则被标记为UNION；<br>
若UNION 包含在FROM字句的子查询中，外层SELECT将被标记为：DERIVED</p>
</li>
</ul>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cda9c901ebd" class="" title="img" loading="lazy">
<ul>
<li><strong>UNION RESULT</strong><br>
从UNION表获取结果的SELECT</li>
</ul>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cda9ea8063e" class="" title="img" loading="lazy">
<p><code>3.【table】</code><br>
显示这一行的数据是关于哪张表的<br>
<code>4.【type】</code><br>
type显示的是访问类型，是较为重要的一个指标，结果值从最好到最坏的依次排序：</p>
<pre class="line-numbers language-none"><code class="language-none">system &gt; const &gt; eq_ef &gt; ref &gt; range(尽量保证) &gt; index &gt; ALL<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><code>一般来说，得保证查询至少达到range级别，最好能达到ref</code></p>
<ul>
<li>
<p><strong>system</strong><br>
表只有一行记录（等于系统表），这是const类型的特列，平时不会出现，这个也可以忽略不计</p>
</li>
<li>
<p><strong>const</strong><br>
表示通过索引一次就找到了，const 用于比较primary key或者<br>
unique索引。因为只匹配一行数据，所以很快将主键置于where列表中，MySQL就能将该查询转换为一个常量</p>
</li>
<li>
<p><strong>eq_ref</strong><br>
唯一性索引扫描，对于每个索引键，表中只有一条记录与之匹配。常见于主键或唯一索引扫描</p>
</li>
<li>
<p><strong>ref</strong><br>
非唯一性索引扫描，返回匹配某个单独值的所有行，本质上也是一种索引访问，它返回所有匹配某个单独值的行，然而，他可能会找到多个符合条件的行，所以他应该属于查找和扫描的混合体</p>
</li>
<li>
<p><strong>range</strong><br>
只<strong>检索给定范围的行</strong>，使用一个索引来选择行。key列显示使用了哪个索引，一般就是在你的where语句中出现了<strong>between</strong>、<strong>&lt;</strong>、<strong>&gt;</strong>、<strong>in</strong>等查询。这种范围扫描索引比全表扫描要好，因为它只需要开始于索引的某一个点，而结束于另一点，不用扫描全部索引。</p>
</li>
<li>
<p><strong>index</strong><br>
Full Index Scan，index与ALL区别为<strong>index类型只遍历索引树</strong>。这通常比ALL快，因为索引文件通常比数据文件小。（<strong>也就是说虽然all和index都是读全表的</strong>），但index是从索引中读取的，而all是从硬盘中读的。</p>
</li>
<li>
<p><strong>all</strong><br>
Full Table Scan，将遍历全表以找到匹配的行</p>
</li>
</ul>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cdaa20d6a27" class="" title="img" loading="lazy">
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cdaa6b191c7" class="" title="img" loading="lazy">
<p><code>5.【possible_keys】</code><br>
显示可能应用到这张表中的索引，一个或多个。查询涉及到的字段上若存在的索引，则该索引将被列出，<strong>但不一定被查询实际使用</strong><br>
<code>6.【key】</code><br>
实际使用的索引，如果为NULL，则没有使用索引。查询中若使用了覆盖索引，则该索引和查询的select字段重叠。<br>
<code>7.【key_len】</code><br>
表示索引中使用的字节数，可通过该列计算查询中使用的索引的长度。key_len字段能够帮你检查是否充分利用上了索引。</p>
<p><strong>计算方式：</strong></p>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cdac5d6037d" class="" title="img" loading="lazy">
<p><strong>动态类型包括：varchar，detail text（）截取字符串</strong><br>
本张的表结构如下：</p>
<p>第一组计算为：</p>
<pre class="line-numbers language-none"><code class="language-none">key_len&#x3D;deptno(int)+null+ename(varchar(20)3+动态&#x3D;4+1+203+2&#x3D;67<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>第二组计算为：</p>
<pre class="line-numbers language-none"><code class="language-none">key_len&#x3D;deptno(int)+null&#x3D;4+1&#x3D;5<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><code>8.【ref】</code><br>
显示索引的哪一列被使用了，如果可能的话，是一个常数。哪些列或者常量被用于查找索引列上的值</p>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cdad493f964" class="" title="img" loading="lazy">
<p><code>9.【row】</code><br>
rows列显示MySQL认为它执行查询时必须检查的行数（越少越好）</p>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cdad89dde87" class="" title="img" loading="lazy">
<p><code>10.【Extra】</code><br>
包含不适合在其他列中显示但十分重要的额外信息。</p>
<ul>
<li>
<p><em><strong>Using filesort</strong></em><br>
说明mysql会对数据使用一个外部的索引排序，而不是按照表内的索引顺序进行读取。MySQL中无法利用索引完成的排序操作称为&quot;文件排序&quot;。</p>
</li>
<li>
<p><em><strong>Using temporary</strong></em><br>
使用了临时表保存中间结果，MySQL在对查询结果排序时使用临时表。常见于排序order by 和分组查询 group by。</p>
</li>
<li>
<p><em><strong>Using index</strong></em><br>
表示相应的select操作中使用了覆盖索引（Covering Index），避免了表的数据行，效率不错。如果同时出现<strong>using<br>
where</strong>，表明索引被用来执行索引键值的查找；如果没有同时出现<strong>using where</strong>，表明索引只是用来读取数据而非利用索引执行查找。<br>
<code>覆盖索引：</code><br>
一个索引包含了（或覆盖了）【select子句】与查询条件【where子句】中所有需要的字段就叫做覆盖索引。<br>
<strong>注意：</strong> 只取出需要的列，不可select *，不可将所有字段一起做索引</p>
</li>
<li>
<p><strong>Using where</strong><br>
表明使用了 where 过滤</p>
</li>
<li>
<p><em><strong>Using join buffer</strong></em><br>
使用了连接缓存</p>
</li>
</ul>
<h4 id="5）查询优化"><a class="header-anchor" href="#5）查询优化">¶</a>5）查询优化</h4>
<ul>
<li><code>索引的使用</code></li>
</ul>
<ol>
<li><strong>全值匹配我最爱</strong><br>
staffs 表建立索引<br>
idx_staffs_nameAgePos,以name，age，pos的顺序建立，全值匹配标识按顺序匹配。</li>
</ol>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cdae6707299" class="" title="img" loading="lazy">
<ol start="2">
<li>
<p><strong>最佳左前缀原则</strong><br>
如果索引了多列，要遵守最左前缀原则，值得是查询从索引的最左前列开始，并且<strong>不跳过索引中的列</strong><br>
<strong>and 忽略左右关系</strong>，即使没有按顺序，由于优化器的存在，会自动优化</p>
</li>
<li>
<p><strong>不在索引列上做任何操作（计算、函数、（自动或手动）类型转换），会导致索引失效而转向全表扫描。</strong></p>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cdae8671279" class="" title="img" loading="lazy">
</li>
<li>
<p><strong>存储引擎不能使用索引中范围条件右边的列</strong><br>
范围若有索引则能使用到索引，范围条件右边的索引会失效（范围条件右边与范围条件使用的同一个组合索引，右边的才会失效，若是不同索引则不会失效）</p>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cdb00c57265" class="" title="img" loading="lazy">
</li>
<li>
<p>**尽量使用覆盖索引（只访问索引的查询（索引列和查询列一致）），减少select **</p>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cdb09eae7ac" class="" title="img" loading="lazy">
</li>
<li>
<p><strong>MySQL在使用不等于（!= 或&lt;&gt;）的时候无法使用索引，会导致全表扫描。</strong><br>
where age != 10 and name = ‘xxx’ 这种情况下，mysql会自动优化将name = ‘xxx’ 放在 age != 10之前，name依然能使用索引，只是age的索引失效</p>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cdb09f6410f" class="" title="img" loading="lazy">
</li>
<li>
<p><strong>is not null 也无法使用索引，但是 is null 是可以使用索引</strong></p>
</li>
<li>
<p><strong>like 以通配符开头（‘%xxx’）索引失效变成全表扫描</strong><br>
like ‘%xxx’：type 类型会变成all<br>
like ‘xxx%’：type 类型为range，算是范围，可以使用索引</p>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cdb14fdc8a9" class="" title="img" loading="lazy">
</li>
<li>
<p><strong>字符串不加单引号索引失效</strong><br>
底层进行类型转换时索引失效，使用了函数造成了索引失效</p>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cdb221f4002" class="" title="img" loading="lazy">
</li>
</ol>
<p>10.<strong>少用or，用它连接时索引会失效</strong></p>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169cdb359d0bb2" class="" title="img" loading="lazy">
<p><code>【例子小节】</code><br>
此时复合索引index（a,b,c）</p>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169e1eb70e393d" class="" title="img" loading="lazy">
<p><code>【使用建议】</code></p>
<ol>
<li>
<p>对于单键索引，尽量选择针对当前query过滤性更好的索引</p>
</li>
<li>
<p>在选择组合索引的时候，当前query中过滤性最好的字段在索引字段顺序中，位置越靠前越好。（避免索引过滤性好的索引失效）</p>
</li>
<li>
<p>在选择组合索引的时候，尽量选择可以能够包含当前query中where字句中更多字段的索引</p>
</li>
<li>
<p>尽可能通过分析统计信息和调整query的写法来达到选择合适索引的目的</p>
</li>
</ol>
<ul>
<li><code>关联查询优化</code><br>
1、保证被驱动表的join字段已经被索引（join后的表为驱动表）<br>
2、left join时，选择小表作为驱动表，大表作为被驱动表（left join一定是左边是驱动表，右边是被驱动表）<br>
3、inner<br>
join时，MySQL会自己帮你把小结果集选为驱动表。因为<strong>驱动表无论如何都会被全表扫描</strong>，所以扫描次数越少越好。<br>
4、子查询尽量不要放在被驱动表，有可能使用不到索引。</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none"># 未加索引，type为ALL
explain select * from class left join book on class.card &#x3D; book.card
# 添加索引优化，第二行的type变成了ref
alter table book add index idx_card_B(card);
# 这是由左连接特效决定的，left join条件用于确定如何从右表搜索行，左边一定都有
# 继续优化，删除旧索引，新建新索引
drop index idx_card_B on book;
alter table class add index idx_card_A(card)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>
<p><code>子查询优化</code><br>
1、 有索引的情况下用 inner join 是最好的，其次是 in，exists最糟糕<br>
2、 无索引的情况下用小表驱动大表，因为 join 方式需要 distinct，没有索引distinct 消耗性能比较大，所以 exists 性能最佳，其次 in其次，join性能最差<br>
3、<br>
无索引的情况下大表驱动小表，in和exists的性能应该是接近的，都比较糟糕，exists稍微好一点，但是超不过5%</p>
</li>
<li>
<p><code>order by关键字优化</code><br>
尽量使用Index方式排序，避免使用FileSort方式排序。MySQL中支持两种方式的排序，<strong>FileSort</strong>和<strong>Index</strong>，其中index效率高，它指Mysql扫描索引本身完成排序，FileSort方式效率比较低。满足三种情况会使用Index排序。</p>
</li>
<li>
<p>Order By语句使用索引最左前列</p>
</li>
<li>
<p>使用where子句与order by子句条件列组合满足索引最左前列</p>
</li>
<li>
<p>where子句中如果出现索引的范围查询（即explain中出现range）会导致order<br>
by索引失效。</p>
</li>
</ul>
<p><code>例子：talA 表中有索引 （age,birth,name）</code></p>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169de0f8682350" class="" title="img" loading="lazy">
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169de0f8ad7117" class="" title="img" loading="lazy">
<ul>
<li><code>分页查询的优化--limit</code></li>
</ul>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169de0f97c20a4" class="" title="img" loading="lazy">
<pre class="line-numbers language-none"><code class="language-none">#加上索引
create index emp on emp(deptno)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169de0fad94580" class="" title="img" loading="lazy">
<pre class="line-numbers language-none"><code class="language-none"># 通过以上结果可以看出加上索引并不能改变
# 进一步优化：先利用覆盖索引把要取的数据行的主键取到，然后再用这个主键列与数据表做关联（查询数据量小了后）
explain select sql_no_cache * from emp e inner join (select id from emp e order by deptno limit 10000,40)a on a.id &#x3D; e.id <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<img src="/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/17169de0fad5dc5e" class="" title="img" loading="lazy">
<ul>
<li><code>GROUP BY 关键字优化</code><br>
1、group by实质上是先排序后进行分组，遵照索引建的最佳左前缀<br>
2、当无法使用索引列，增大max_length_for_sort_data参数的设置+增大sort_buffer_size参数的设置<br>
3、where高于having，能写在where限定的条件就不要去having限定了。</li>
<li><code>去重优化</code><br>
尽量不要使用distinct关键字去重<br>
<code>例子：</code></li>
</ul>
<pre class="line-numbers language-none"><code class="language-none"># 使用distinct关键字去重消耗性能
select distinct BOOK_NAME from book where id in(1,2,5,4,8)
# 使用 group by能够利用到索引
select BOOK_NAME from book where id in(1,2,5,4,8) group by BOOK_NAME<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="打赏" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">I'm so cute. Please give me money.</div><div id="qr" style="display:none;"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/alipay-qrcode.jpg"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/alipay-qrcode.jpg" alt="支付宝" title="支付宝"></a><div><span style="color:#00A3EE"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-alipay-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/qqpay-qrcode.png"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/qqpay-qrcode.png" alt="QQ 支付" title="QQ 支付"></a><div><span style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/wechatpay-qrcode.jpg"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/wechatpay-qrcode.jpg" alt="微信支付" title="微信支付"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>momo</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/" title="MySQL理解">https://ppxiaodi.gitee.io/2021/03/29/CollectionNote/java/mysql/%E7%9C%8B%E4%BA%86%E8%BF%99%E7%AF%87MySQL%EF%BC%8C%E5%BC%80%E5%8F%91%E5%8A%9F%E5%8A%9B%E5%8F%88%E5%8D%87%E7%BA%A7%EF%BC%81/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> 许可协议。</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2021/03/29/CollectionNote/java/mysql/%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%88%AA%E5%8F%96%E4%B9%8Bsubstring_index/" rel="prev" title="字符串"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">字符串</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2021/03/29/CollectionNote/java/mysql/%E8%A7%A6%E5%8F%91%E5%99%A8/" rel="next" title="触发器"><span class="post-nav-text">触发器</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>要不要和我说些什么？</span><br></div></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 – 2022 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> momo</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v5.2.0</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.7.0</span></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="搜索"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="/js/search/local-search.js" defer></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="搜索..." value=""></div><div id="local-search-result"></div></div></div></body></html>