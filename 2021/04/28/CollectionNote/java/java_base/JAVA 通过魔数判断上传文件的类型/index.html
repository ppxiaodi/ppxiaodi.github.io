<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="momo"><meta name="copyright" content="momo"><meta name="generator" content="Hexo 5.2.0"><meta name="theme" content="hexo-theme-yun"><title>JAVA 通过魔数判断上传文件的类型 | 我的笔记</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.25/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"ppxiaodi.github.io","root":"/","title":"momo的小站","version":"1.7.0","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"local_search":{"path":"/search.xml"},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><meta name="description" content="本文由 简悦 SimpRead 转码， 原文地址 blog.csdn.net  这里所说的表示不同文件类型的魔术数字，指定是文件的最开头的几个用于唯一区别其它文件类型的字节，有了这些魔术数字，我们就可以很方便的区别不同的文件，这也使得编程变得更加容易，因为我减少了我们用于区别一个文件的文件类型所要花费的时间。 比如，一个 JPEG 文件，它开头的一些字节可能是类似这样的”ffd8 ffe0 00">
<meta property="og:type" content="article">
<meta property="og:title" content="JAVA 通过魔数判断上传文件的类型">
<meta property="og:url" content="https://ppxiaodi.github.io/2021/04/28/CollectionNote/java/java_base/JAVA%20%E9%80%9A%E8%BF%87%E9%AD%94%E6%95%B0%E5%88%A4%E6%96%AD%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%E7%9A%84%E7%B1%BB%E5%9E%8B/index.html">
<meta property="og:site_name" content="我的笔记">
<meta property="og:description" content="本文由 简悦 SimpRead 转码， 原文地址 blog.csdn.net  这里所说的表示不同文件类型的魔术数字，指定是文件的最开头的几个用于唯一区别其它文件类型的字节，有了这些魔术数字，我们就可以很方便的区别不同的文件，这也使得编程变得更加容易，因为我减少了我们用于区别一个文件的文件类型所要花费的时间。 比如，一个 JPEG 文件，它开头的一些字节可能是类似这样的”ffd8 ffe0 00">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://hi.csdn.net/attachment/201007/1/0_1278000562caAl.gif">
<meta property="og:image" content="http://hi.csdn.net/attachment/201007/2/0_1278060916VsVS.gif">
<meta property="og:image" content="http://hi.csdn.net/attachment/201007/1/0_1278000562caAl.gif">
<meta property="og:image" content="http://hi.csdn.net/attachment/201007/2/0_1278060916VsVS.gif">
<meta property="article:published_time" content="2021-04-27T16:00:00.000Z">
<meta property="article:modified_time" content="2021-07-11T08:54:53.900Z">
<meta property="article:author" content="momo">
<meta property="article:tag" content="java">
<meta property="article:tag" content="java_base">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://hi.csdn.net/attachment/201007/1/0_1278000562caAl.gif"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="momo"><img width="96" loading="lazy" src="/yun.png" alt="momo"></a><div class="site-author-name"><a href="/about/">momo</a></div><a class="site-name" href="/about/site.html">我的笔记</a><sub class="site-subtitle"></sub><div class="site-desciption"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">198</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">58</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">47</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="文档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-rss-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://qm.qq.com/cgi-bin/qm/qr?k=kZJzggTTCf4SpvEQ8lXWoi5ZjhAx0ILZ&amp;jump_from=webapi" title="QQ 群 1050458482" target="_blank" style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/YunYouJun" title="GitHub" target="_blank" style="color:#6e5494"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://weibo.com/jizhideyunyoujun" title="微博" target="_blank" style="color:#E6162D"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-weibo-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.douban.com/people/yunyoujun/" title="豆瓣" target="_blank" style="color:#007722"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-douban-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=247102977" title="网易云音乐" target="_blank" style="color:#C20C0C"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-netease-cloud-music-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.zhihu.com/people/yunyoujun/" title="知乎" target="_blank" style="color:#0084FF"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-zhihu-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/1579790" title="哔哩哔哩" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/about/white-qrcode-and-search.jpg" title="微信公众号" target="_blank" style="color:#1AAD19"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-2-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://twitter.com/YunYouJun" title="Twitter" target="_blank" style="color:#1da1f2"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-twitter-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://t.me/elpsycn" title="Telegram Channel" target="_blank" style="color:#0088CC"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-telegram-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:me@yunyoujun.cn" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://travellings.link" title="Travelling" target="_blank" style="color:var(--hty-text-color)"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-train-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E7%89%87%E6%96%87%E4%BB%B6"><span class="toc-number">1.</span> <span class="toc-text">图片文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%8B%E7%BC%A9%E6%96%87%E4%BB%B6"><span class="toc-number">2.</span> <span class="toc-text">压缩文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%98%E6%A1%A3%E6%96%87%E4%BB%B6"><span class="toc-number">3.</span> <span class="toc-text">存档文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6"><span class="toc-number">4.</span> <span class="toc-text">可执行文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E5%AE%83%E6%96%87%E4%BB%B6"><span class="toc-number">5.</span> <span class="toc-text">其它文件</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://ppxiaodi.github.io/2021/04/28/CollectionNote/java/java_base/JAVA%20%E9%80%9A%E8%BF%87%E9%AD%94%E6%95%B0%E5%88%A4%E6%96%AD%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%E7%9A%84%E7%B1%BB%E5%9E%8B/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="momo"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="我的笔记"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">JAVA 通过魔数判断上传文件的类型</h1><div class="post-meta"><div class="post-time" style="display:inline-block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="创建时间：2021-04-28 00:00:00" itemprop="dateCreated datePublished" datetime="2021-04-28T00:00:00+08:00">2021-04-28</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="修改时间：2021-07-11 16:54:53" itemprop="dateModified" datetime="2021-07-11T16:54:53+08:00">2021-07-11</time></div><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/java/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">java</span></a></span> > <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/java/java-base/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">java_base</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/java/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">java</span></a><a class="tag-item" href="/tags/java-base/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">java_base</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#0078E7;"><blockquote>
<p>本文由 <a target="_blank" rel="noopener" href="http://ksria.com/simpread/">简悦 SimpRead</a> 转码， 原文地址 <a target="_blank" rel="noopener" href="https://blog.csdn.net/ycb1689/article/details/79712623">blog.csdn.net</a></p>
</blockquote>
<p>这里所说的表示不同文件类型的魔术数字，指定是文件的最开头的几个用于唯一区别其它文件类型的字节，有了这些魔术数字，我们就可以很方便的区别不同的文件，这也使得编程变得更加容易，因为我减少了我们用于区别一个文件的文件类型所要花费的时间。</p>
<p>比如，一个 JPEG 文件，它开头的一些字节可能是类似这样的”<strong>ffd8 ffe0 0010 4a46 4946 0001 0101 0047 ……JFIF……G</strong>“，这里”<strong>ffd8</strong>“就表示了这个文件是一个 JPEG 类型的文件，”<strong>ffe0</strong>“表示这是 JFIF 类型结构。</p>
<p>以下例出的是一些我们常见的文件类型，以及它用于判断这种文件的类型的几个开始字节及所对尖的 ASCII 数字：</p>
<h2 id="图片文件"><a class="header-anchor" href="#图片文件">¶</a>图片文件</h2>
<table border="1"><tbody><tr><th>文件类型</th><th>扩展名</th><th>16 进制数字<br>xx 这里表示变量</th><th>Ascii 数字<br>. = 不是 Ascii 字符</th></tr><tr><td>Bitmap format</td><td>.bmp</td><td>42 4d</td><td>BM</td></tr><tr><td>FITS format</td><td>.fits</td><td>53 49 4d 50 4c 45</td><td>SIMPLE</td></tr><tr><td>GIF format</td><td>.gif</td><td>47 49 46 38</td><td>GIF8</td></tr><tr><td>Graphics Kernel System</td><td>.gks</td><td>47 4b 53 4d</td><td>GKSM</td></tr><tr><td>IRIS rgb format</td><td>.rgb</td><td>01 da</td><td>..</td></tr><tr><td>ITC (CMU WM) format</td><td>.itc</td><td>f1 00 40 bb</td><td>….</td></tr><tr><td>JPEG File Interchange Format</td><td>.jpg</td><td>ff d8 ff e0</td><td>….</td></tr><tr><td>NIFF (Navy TIFF)</td><td>.nif</td><td>49 49 4e 31</td><td>IIN1</td></tr><tr><td>PM format</td><td>.pm</td><td>56 49 45 57</td><td>VIEW</td></tr><tr><td>PNG format</td><td>.png</td><td>89 50 4e 47</td><td>.PNG</td></tr><tr><td>Postscript format</td><td>.[e]ps</td><td>25 21</td><td>%!</td></tr><tr><td>Sun Rasterfile</td><td>.ras</td><td>59 a6 6a 95</td><td>Y.j.</td></tr><tr><td>Targa format</td><td>.tga</td><td>xx xx xx</td><td>…</td></tr><tr><td>TIFF format (Motorola – big endian)</td><td>.tif</td><td>4d 4d 00 2a</td><td>MM.*</td></tr><tr><td>TIFF format (Intel – little endian)</td><td>.tif</td><td>49 49 2a 00</td><td>II*.</td></tr><tr><td>X11 Bitmap format</td><td>.xbm</td><td>xx xx</td><td>&nbsp;</td></tr><tr><td>XCF Gimp file structure</td><td>.xcf</td><td>67 69 6d 70 20 78 63 66 20 76</td><td>gimp xcf</td></tr><tr><td>Xfig format</td><td>.fig</td><td>23 46 49 47</td><td>#FIG</td></tr><tr><td>XPM format</td><td>.xpm</td><td>2f 2a 20 58 50 4d 20 2a 2f</td><td>/* XPM */</td></tr></tbody></table>
<h2 id="压缩文件"><a class="header-anchor" href="#压缩文件">¶</a>压缩文件</h2>
<table border="1"><tbody><tr><th>文件类型</th><th>扩展名</th><th>16 进制数字<br>xx 这里表示变量</th><th>Ascii 数字<br>. = 不是 Ascii 字符</th></tr><tr><td>Bzip</td><td>.bz</td><td>42 5a</td><td>BZ</td></tr><tr><td>Compress</td><td>.Z</td><td>1f 9d</td><td>..</td></tr><tr><td>gzip format</td><td>.gz</td><td>1f 8b</td><td>..</td></tr><tr><td>pkzip format</td><td>.zip</td><td>50 4b 03 04</td><td>PK..</td></tr></tbody></table>
<h2 id="存档文件"><a class="header-anchor" href="#存档文件">¶</a>存档文件</h2>
<table border="1"><tbody><tr><th>文件类型</th><th>扩展名</th><th>16 进制数字<br>xx 这里表示变量</th><th>Ascii 数字<br>. = 不是 Ascii 字符</th></tr><tr><td>TAR (pre-POSIX)</td><td>.tar</td><td>xx xx</td><td>(a filename)</td></tr><tr><td>TAR (POSIX)</td><td>.tar</td><td>75 73 74 61 72</td><td>ustar (offset by 257 bytes)</td></tr></tbody></table>
<h2 id="可执行文件"><a class="header-anchor" href="#可执行文件">¶</a>可执行文件</h2>
<table border="1"><tbody><tr><th>文件类型</th><th>扩展名</th><th>16 进制数字<br>xx 这里表示变量</th><th>Ascii 数字<br>. = 不是 Ascii 字符</th></tr><tr><td>MS-DOS, OS/2 or MS Windows</td><td>&nbsp;</td><td>4d 5a</td><td>MZ</td></tr><tr><td>Unix elf</td><td>&nbsp;</td><td>7f 45 4c 46</td><td>.ELF</td></tr></tbody></table>
<h2 id="其它文件"><a class="header-anchor" href="#其它文件">¶</a>其它文件</h2>
<table border="1"><tbody><tr><th>文件类型</th><th>扩展名</th><th>16 进制数字<br>xx 这里表示变量</th><th>Ascii 数字<br>. = 不是 Ascii 字符</th></tr><tr><td>pgp public ring</td><td>&nbsp;</td><td>99 00</td><td>..</td></tr><tr><td>pgp security ring</td><td>&nbsp;</td><td>95 01</td><td>..</td></tr><tr><td>pgp security ring</td><td>&nbsp;</td><td>95 00</td><td>..</td></tr><tr><td>pgp encrypted data</td><td>&nbsp;</td><td>a6 00</td><td>¦.</td></tr></tbody></table>
<p>通常，在 WEB 系统中，上传文件时都需要做文件的类型校验，大致有如下几种方法：</p>
<ol>
<li>
<p>通过后缀名，如 exe,jpg,bmp,rar,zip 等等。</p>
</li>
<li>
<p>通过读取文件，获取文件的 Content-type 来判断。</p>
</li>
<li>
<p>通过读取文件流，根据文件流中特定的一些字节标识来区分不同类型的文件。</p>
</li>
<li>
<p>若是图片，则通过缩放来判断，可以缩放的为图片，不可以的则不是。</p>
</li>
</ol>
<p>然而，在安全性较高的业务场景中，1，2 两种方法的校验会被轻易绕过。</p>
<ol>
<li>
<p>伪造后缀名，如图片的，非常容易修改。</p>
</li>
<li>
<p>伪造文件的 Content-type，这个稍微复杂点，为了直观，截图如下：</p>
</li>
</ol>
<p><img src="http://hi.csdn.net/attachment/201007/1/0_1278000562caAl.gif" alt="" loading="lazy"></p>
<ol start="3">
<li>较安全，但是要读取文件，并有 16 进制转换等操作，性能稍差，但能满足一定条件下对安全的要求，所以建议使用。</li>
</ol>
<p>但是文件头的信息也可以伪造，截图如下，对于图片可以采用图片缩放或者获取图片宽高的方法避免伪造头信息漏洞。</p>
<p><img src="http://hi.csdn.net/attachment/201007/2/0_1278060916VsVS.gif" alt="" loading="lazy"></p>
<p>被伪装成 gif 的恶意图片文件</p>
<p>对应的 Java 代码如下：</p>
<pre class="line-numbers language-none"><code class="language-none">import org.apache.commons.lang3.StringUtils;
 
&#x2F;**
 * 文件类型与对应的文件魔数枚举类 
 *
 *&#x2F;
public enum FileTypeEnum &#123; 
    
	&#x2F;** JPEG  (jpg)*&#x2F;
    JPEG(&quot;JPG&quot;, &quot;FFD8FF&quot;),
 
    &#x2F;** PNG *&#x2F;
    PNG(&quot;PNG&quot;, &quot;89504E47&quot;),
 
    &#x2F;** GIF *&#x2F;
    GIF(&quot;GIF&quot;, &quot;47494638&quot;),
  
    &#x2F;** TIFF (tif)  *&#x2F;
    TIFF(&quot;TIF&quot;, &quot;49492A00&quot;),
 
    &#x2F;** Windows bitmap (bmp) *&#x2F;
    BMP(&quot;BMP&quot;,&quot;424D&quot;),
    
    BMP_16(&quot;BMP&quot;,&quot;424D228C010000000000&quot;), &#x2F;&#x2F;16色位图(bmp) 
    
	BMP_24(&quot;BMP&quot;,&quot;424D8240090000000000&quot;), &#x2F;&#x2F;24位位图(bmp)  
	
	BMP_256(&quot;BMP&quot;,&quot;424D8E1B030000000000&quot;), &#x2F;&#x2F;256色位图(bmp)     
 
    &#x2F;** CAD  (dwg) *&#x2F;
    DWG(&quot;DWG&quot;, &quot;41433130&quot;),
 
    &#x2F;** Adobe photoshop  (psd)*&#x2F;
    PSD(&quot;PSD&quot;, &quot;38425053&quot;),
 
    &#x2F;** Rich Text Format  (rtf)*&#x2F;
    RTF(&quot;RTF&quot;, &quot;7B5C727466&quot;),
 
    &#x2F;** XML *&#x2F;
    XML(&quot;XML&quot;, &quot;3C3F786D6C&quot;),
 
    &#x2F;** HTML (html)*&#x2F;
    HTML(&quot;HTML&quot;, &quot;68746D6C3E&quot;),
    
    &#x2F;** Email [thorough only] (eml)*&#x2F;
    EML(&quot;EML&quot;, &quot;44656C69766572792D646174653A&quot;),  
	
    &#x2F;** Outlook Express (dbx) *&#x2F;
    DBX(&quot;DBX&quot;, &quot;CFAD12FEC5FD746F &quot;),
 
    &#x2F;** Outlook (pst)*&#x2F;
    PST(&quot;&quot;, &quot;2142444E&quot;),
 
    &#x2F;** doc;xls;dot;ppt;xla;ppa;pps;pot;msi;sdw;db *&#x2F;
    OLE2(&quot;OLE2&quot;, &quot;0xD0CF11E0A1B11AE1&quot;),
 
    &#x2F;** Microsoft Word&#x2F;Excel 注意：word 和 excel的文件头一样 *&#x2F;
    XLS(&quot;XLS&quot;, &quot;D0CF11E0&quot;),
    
    &#x2F;** Microsoft Word&#x2F;Excel 注意：word 和 excel的文件头一样 *&#x2F;
    DOC(&quot;DOC&quot;, &quot;D0CF11E0&quot;),
    
    &#x2F;** Microsoft Word&#x2F;Excel 2007以上版本文件 注意：word 和 excel的文件头一样 *&#x2F;
    DOCX(&quot;DOCX&quot;, &quot;504B0304&quot;),  
 
    &#x2F;** Microsoft Word&#x2F;Excel 2007以上版本文件 注意：word 和 excel的文件头一样 504B030414000600080000002100*&#x2F;
    XLSX(&quot;XLSX&quot;, &quot;504B0304&quot;), 
 
    &#x2F;** Microsoft Access (mdb)*&#x2F;
    MDB(&quot;MDB&quot;, &quot;5374616E64617264204A&quot;),
 
    &#x2F;** Word Perfect (wpd)*&#x2F;
    WPB(&quot;WPB&quot;, &quot;FF575043&quot;),
 
    &#x2F;** Postscript *&#x2F;
    EPS(&quot;EPS&quot;, &quot;252150532D41646F6265&quot;),
 
    &#x2F;** Postscript *&#x2F;
    PS(&quot;PS&quot;, &quot;252150532D41646F6265&quot;),
 
    &#x2F;** Adobe Acrobat (pdf)  *&#x2F;
    PDF(&quot;PDF&quot;, &quot;255044462D312E&quot;),
    
    &#x2F;** Quicken (qdf) *&#x2F;
    QDF(&quot;qdf&quot;, &quot;AC9EBD8F&quot;),
    
    &#x2F;** QuickBooks Backup (qdb) *&#x2F;
    QDB(&quot;qbb&quot;, &quot;458600000600&quot;),
    
    &#x2F;** Windows Password  (pwl)*&#x2F;
    PWL(&quot;PWL&quot;, &quot;E3828596&quot;),
 
    &#x2F;** ZIP Archive *&#x2F;
    ZIP(&quot;&quot;, &quot;504B0304&quot;),
 
    &#x2F;** ARAR Archive *&#x2F;
    RAR(&quot;&quot;, &quot;52617221&quot;),
 
    &#x2F;** WAVE (wav) *&#x2F;
    WAV(&quot;WAV&quot;, &quot;57415645&quot;),
 
    &#x2F;** AVI *&#x2F;
    AVI(&quot;AVI&quot;, &quot;41564920&quot;),
 
    &#x2F;** Real Audio (ram)*&#x2F;
    RAM(&quot;RAM&quot;, &quot;2E7261FD&quot;),
 
    &#x2F;** Real Media (rm) rmvb&#x2F;rm相同  *&#x2F;
    RM(&quot;RM&quot;, &quot;2E524D46&quot;),
    
    &#x2F;** Real Media (rm) rmvb&#x2F;rm相同  *&#x2F;
    RMVB(&quot;RMVB&quot;, &quot;2E524D46000000120001&quot;),  
    
    &#x2F;** MPEG (mpg)  *&#x2F;
    MPG(&quot;MPG&quot;, &quot;000001BA&quot;),
	
    &#x2F;** Quicktime  (mov)*&#x2F;
    MOV(&quot;MOV&quot;, &quot;6D6F6F76&quot;),
 
    &#x2F;** Windows Media (asf) *&#x2F;
    ASF(&quot;ASF&quot;, &quot;3026B2758E66CF11&quot;),
 
    &#x2F;** ARJ Archive *&#x2F;
    ARJ(&quot;ARJ&quot;, &quot;60EA&quot;),
 
    &#x2F;** MIDI (mid) *&#x2F;
    MID(&quot;MID&quot;, &quot;4D546864&quot;),
    
    &#x2F;** MP4 *&#x2F;  
    MP4(&quot;MP4&quot;, &quot;00000020667479706D70&quot;), 
    
    &#x2F;** MP3 *&#x2F;  
    MP3(&quot;MP3&quot;, &quot;49443303000000002176&quot;),  
    
    &#x2F;** FLV *&#x2F;  
    FLV(&quot;FLV&quot;, &quot;464C5601050000000900&quot;), 
	
    &#x2F;** 1F8B0800000000000000 *&#x2F;
    GZ(&quot;GZ&quot;, &quot;1F8B08&quot;),
    
    &#x2F;** CSS *&#x2F; 
    CSS(&quot;CSS&quot;, &quot;48544D4C207B0D0A0942&quot;),
    
    &#x2F;**  JS *&#x2F;  
    JS(&quot;JS&quot;, &quot;696B2E71623D696B2E71&quot;), 
	 
    &#x2F;**  Visio *&#x2F;  
    VSD(&quot;VSD&quot;, &quot;d0cf11e0a1b11ae10000&quot;),
    
    &#x2F;** WPS文字wps、表格et、演示dps都是一样的 *&#x2F;  
    WPS(&quot;WPS&quot;, &quot;d0cf11e0a1b11ae10000&quot;),
    
    &#x2F;** torrent *&#x2F;  
    TORRENT(&quot;TORRENT&quot;, &quot;6431303A637265617465&quot;), 
    
    &#x2F;** JSP Archive *&#x2F;  
    JSP(&quot;JSP&quot;, &quot;3C2540207061676520&quot;),  
    
    &#x2F;** JAVA Archive *&#x2F;  
    JAVA(&quot;JAVA&quot;, &quot;7061636B61676520&quot;), 
    
    &#x2F;** CLASS Archive *&#x2F;  
    CLASS(&quot;CLASS&quot;, &quot;CAFEBABE0000002E00&quot;), 
    
    &#x2F;** JAR Archive *&#x2F;  
    JAR(&quot;JAR&quot;, &quot;504B03040A000000&quot;), 
    
    &#x2F;** MF Archive *&#x2F;  
    MF(&quot;MF&quot;, &quot;4D616E69666573742D56&quot;),
 
    &#x2F;** EXE Archive *&#x2F;  
    EXE(&quot;EXE&quot;, &quot;4D5A9000030000000400&quot;), 
 
    &#x2F;** ELF Executable *&#x2F;  
    ELF(&quot;ELF&quot;, &quot;7F454C4601010100&quot;), 
 
    &#x2F;** Lotus 123 v1 *&#x2F;  
    WK1(&quot;WK1&quot;, &quot;2000604060&quot;),
    
    &#x2F;** Lotus 123 v3 *&#x2F;  
    WK3(&quot;WK3&quot;, &quot;00001A0000100400&quot;),
    
    &#x2F;** Lotus 123 v5 *&#x2F;  
    WK4(&quot;WK4&quot;, &quot;00001A0002100400&quot;), 
 
    &#x2F;** Lotus WordPro v9 *&#x2F;  
    LWP(&quot;LWP&quot;, &quot;576F726450726F&quot;), 
    
    &#x2F;** Sage(sly.or.srt.or.slt;sly;srt;slt) *&#x2F;  
    SLY(&quot;SLY&quot;, &quot;53520100&quot;), 
    
    &#x2F;** CHM Archive *&#x2F;  
   &#x2F;* CHM(&quot;CHM&quot;, &quot;49545346030000006000&quot;),  
    INI(&quot;INI&quot;, &quot;235468697320636F6E66&quot;), 
    SQL(&quot;SQL&quot;, &quot;494E5345525420494E54&quot;), 
    BAT(&quot;BAT&quot;, &quot;406563686F206f66660D&quot;),  
    PROPERTIES(&quot;&quot;, &quot;6C6F67346A2E726F6F74&quot;), 
    MXP(&quot;&quot;, &quot;04000000010000001300&quot;),  *&#x2F;
    
	NOT_EXITS_ENUM(&quot;&quot;, &quot;&quot;);
	
	&#x2F;&#x2F;文件类型对应的名称
	private String fileTypeName;
	
	&#x2F;&#x2F;文件类型对应的魔数
	private String magicNumberCode;
	
	private FileTypeEnum(String fileTypeName, String magicNumberCode) &#123;
		this.fileTypeName &#x3D; fileTypeName;
		this.magicNumberCode &#x3D; magicNumberCode;
	&#125; 
	 
	public String getFileTypeName() &#123;
		return fileTypeName;
	&#125; 
 
	public String getMagicNumberCode() &#123;
		return magicNumberCode;
	&#125;
 
 
	&#x2F;**
	 * 根据文件类型获取文件类型魔数编码
	 * 默认返回标准件
	 * @param magicNumberCode - 文件类型魔数编码
	 * @return
	 *&#x2F;
	public static FileTypeEnum getByMagicNumberCode(String magicNumberCode) &#123;
		if (StringUtils.isNotBlank(magicNumberCode)) &#123;
			for (FileTypeEnum type : values()) &#123; 
				if (magicNumberCode.toUpperCase().startsWith(type.getMagicNumberCode())) &#123;
					return type; 
				&#125; 
			&#125; 
		&#125;
		
		return FileTypeEnum.NOT_EXITS_ENUM;
	&#125;
	
	&#x2F;**
	 * 根据文件类型后缀名获取枚举
	 * 
	 * @param fileTypeName - 文件类型后缀名
	 * @return
	 *&#x2F;
	public static FileTypeEnum getByFileTypeName(String fileTypeName) &#123; 
		if (StringUtils.isNotBlank(fileTypeName)) &#123;
			for (FileTypeEnum type : values()) &#123;
				if (type.getFileTypeName().equals(fileTypeName)) &#123;
					return type; 
				&#125; 
			&#125;
		&#125;
		return FileTypeEnum.NOT_EXITS_ENUM;
	&#125;
  
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>或</p>
<pre class="line-numbers language-none"><code class="language-none">import java.awt.image.BufferedImage;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.InputStream;
import java.util.Iterator;
 
import javax.imageio.ImageIO;
import javax.imageio.ImageReader;
import javax.imageio.stream.ImageInputStream;
 
import org.apache.commons.lang3.StringUtils;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
  
&#x2F;**
 * 通过文件魔数来判断文件类型
 * 可以最大量避免通过后缀名来判断文件类型的漏洞
 * 
 * @author 000125
 *
 *&#x2F;
public class FileTypeUtils &#123;   
	private static final Logger LOGGER &#x3D; LoggerFactory.getLogger(FileTypeUtils.class);
	
    &#x2F;**  
     * 获取图片文件实际类型,若不是图片则返回null]
     * @param file 
     * @return fileType  
     *&#x2F;  
    public final static String getImageFileType(File file) &#123;  
        if (isImage(file)) &#123;
            try &#123;
                ImageInputStream iis &#x3D; ImageIO.createImageInputStream(file);
                Iterator&lt;ImageReader&gt; iter &#x3D; ImageIO.getImageReaders(iis);
                if (!iter.hasNext()) &#123;
                    return null;
                &#125;
                ImageReader reader &#x3D; iter.next();
                iis.close();
                return reader.getFormatName();
            &#125; catch (IOException e) &#123;
                return null;
            &#125; catch (Exception e) &#123;
                return null;
            &#125;
        &#125;
        return null;
    &#125;  
  
    &#x2F;**   
     * 获取文件类型,包括图片,若格式不是已配置的,则返回null
     * @param file 
     * @return fileType  
     *&#x2F;  
    public final static String getFileByFile(File file) &#123;  
        String filetype &#x3D; null;  
        byte[] b &#x3D; new byte[50];  
        try &#123;  
            InputStream is &#x3D; new FileInputStream(file);  
            is.read(b);  
            filetype &#x3D; getFileTypeByStream(b);  
            is.close();  
        &#125; catch (FileNotFoundException e) &#123;  
            e.printStackTrace();  
        &#125; catch (IOException e) &#123;  
            e.printStackTrace();  
        &#125;  
        return filetype;  
    &#125;  
      
    &#x2F;** 
     * 通过数据流（二进制数据）判断文件类型
     * @param b 
     * @return fileType  
     *&#x2F;  
    public final static String getFileTypeByStream(byte[] b) &#123;  
        String magicNumberCode &#x3D; String.valueOf(getFileHexString(b));  
        
        if (StringUtils.isBlank(magicNumberCode)) &#123; 
            return FileTypeEnum.getByMagicNumberCode(magicNumberCode.toUpperCase()).getFileTypeName();
            
        &#125;
        return FileTypeEnum.NOT_EXITS_ENUM.getFileTypeName();  
    &#125;  
      
    &#x2F;** 
     * isImage,判断文件是否为图片
     * @param file
     * @return true 是 | false 否 
     *&#x2F;
    public static final boolean isImage(File file)&#123;
        boolean flag &#x3D; false;
        try &#123;
            BufferedImage bufreader &#x3D; ImageIO.read(file);
            int width &#x3D; bufreader.getWidth();
            int height &#x3D; bufreader.getHeight();
            if(width&#x3D;&#x3D;0 || height&#x3D;&#x3D;0)&#123;
                flag &#x3D; false;
            &#125;else &#123;
                flag &#x3D; true;
            &#125;
        &#125; catch (IOException e) &#123;
            flag &#x3D; false;
        &#125;catch (Exception e) &#123;
            flag &#x3D; false;
        &#125;
        return flag;
    &#125;
    
   
    &#x2F;**
     * 通过文件路径判断文件类型
     * @param path
     * @return
     * @throws IOException
     *&#x2F;
    public static FileTypeEnum getFileTypeByPath(String path) &#123;
        &#x2F;&#x2F; 获取文件头
        String magicNumberCode &#x3D; null;
		try &#123;
			magicNumberCode &#x3D; getFileHeader(path);
		&#125; catch (Exception e) &#123; 
			e.printStackTrace();
			return FileTypeEnum.NOT_EXITS_ENUM;
		&#125;
 
        if (StringUtils.isBlank(magicNumberCode)) &#123; 
            return FileTypeEnum.getByMagicNumberCode(magicNumberCode.toUpperCase());
            
        &#125;
 
        return FileTypeEnum.NOT_EXITS_ENUM;
    &#125;
 
    
    &#x2F;**
     * 通过文件路径获取文件头（即文件魔数）
     * @param path
     * @return
     * @throws IOException
     *&#x2F;
    public static String getFileHeader(String path) throws Exception &#123;
        byte[] b &#x3D; new byte[28];
        InputStream inputStream &#x3D; null;
 
        try &#123;
            inputStream &#x3D; new FileInputStream(path);
            inputStream.read(b, 0, 28);
        &#125; finally &#123;
            if (inputStream !&#x3D; null) &#123;
                inputStream.close();
            &#125;
        &#125;
 
        return getFileHexString(b);
    &#125;
    
    &#x2F;**   
     * 把文件二进制流转换成十六进制数据
     * @param b 
     * @return fileTypeHex  
     *&#x2F;  
    public final static String getFileHexString(byte[] b) &#123;  
        StringBuilder builder &#x3D; new StringBuilder();  
        if (b &#x3D;&#x3D; null || b.length &lt;&#x3D; 0) &#123;  
            return null;  
        &#125;  
        
        for (int i &#x3D; 0; i &lt; b.length; i++) &#123;  
            int v &#x3D; b[i] &amp; 0xFF;  
            String hv &#x3D; Integer.toHexString(v);  
            if (hv.length() &lt; 2) &#123;  
            	builder.append(0);  
            &#125;  
            builder.append(hv);  
        &#125;  
        return builder.toString();  
    &#125;  
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这样，不管是传入的文件有后缀名，还是无后缀名，或者修改了后缀名，真正获取到的才是该文件的实际类型，这样避免了一些想通过修改后缀名或者 Content-type 信息来攻击的因素。但是性能与安全永远是无法同时完美的，安全的同时付出了读取文件的代价。本人建议可采用后缀名与读取文件的方式结合校验，毕竟攻击是少数，后缀名的校验能排除大多数用户，在后缀名获取不到时再通过获取文件真实类型校验，这样来适当提高性能。</p>
<p><img src="http://hi.csdn.net/attachment/201007/1/0_1278000562caAl.gif" alt="" loading="lazy"></p>
<ol start="3">
<li>较安全，但是要读取文件，并有 16 进制转换等操作，性能稍差，但能满足一定条件下对安全的要求，所以建议使用。</li>
</ol>
<p>但是文件头的信息也可以伪造，截图如下，对于图片可以采用图片缩放或者获取图片宽高的方法避免伪造头信息漏洞。</p>
<p><img src="http://hi.csdn.net/attachment/201007/2/0_1278060916VsVS.gif" alt="" loading="lazy"></p>
<p>被伪装成 gif 的恶意图片文件</p>
<p>对应的 Java 代码如下：</p>
</div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="打赏" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">I'm so cute. Please give me money.</div><div id="qr" style="display:none;"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/alipay-qrcode.jpg"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/alipay-qrcode.jpg" alt="支付宝" title="支付宝"></a><div><span style="color:#00A3EE"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-alipay-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/qqpay-qrcode.png"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/qqpay-qrcode.png" alt="QQ 支付" title="QQ 支付"></a><div><span style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/wechatpay-qrcode.jpg"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/wechatpay-qrcode.jpg" alt="微信支付" title="微信支付"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>momo</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="https://ppxiaodi.github.io/2021/04/28/CollectionNote/java/java_base/JAVA%20%E9%80%9A%E8%BF%87%E9%AD%94%E6%95%B0%E5%88%A4%E6%96%AD%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%E7%9A%84%E7%B1%BB%E5%9E%8B/" title="JAVA 通过魔数判断上传文件的类型">https://ppxiaodi.github.io/2021/04/28/CollectionNote/java/java_base/JAVA%20%E9%80%9A%E8%BF%87%E9%AD%94%E6%95%B0%E5%88%A4%E6%96%AD%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%E7%9A%84%E7%B1%BB%E5%9E%8B/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> 许可协议。</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2021/04/28/CollectionNote/java/idea/Recent%20Files/" rel="prev" title="IntelliJ IDEA 学习笔记 - Ctrl + E查找Recent Files"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">IntelliJ IDEA 学习笔记 - Ctrl + E查找Recent Files</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2021/04/25/CollectionNote/java/mysql/%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/" rel="next" title="隔离级别"><span class="post-nav-text">隔离级别</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>要不要和我说些什么？</span><br></div></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 – 2022 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> momo</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v5.2.0</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.7.0</span></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="搜索"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="/js/search/local-search.js" defer></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="搜索..." value=""></div><div id="local-search-result"></div></div></div></body></html>