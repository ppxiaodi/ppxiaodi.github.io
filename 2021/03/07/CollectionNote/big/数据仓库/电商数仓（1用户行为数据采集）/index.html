<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="momo"><meta name="copyright" content="momo"><meta name="generator" content="Hexo 5.2.0"><meta name="theme" content="hexo-theme-yun"><title>1用户行为数据仓库 | 我的笔记</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.25/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"ppxiaodi.github.io","root":"/","title":"momo的小站","version":"1.7.0","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"local_search":{"path":"/search.xml"},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><meta name="description" content="尚硅谷大数据项目之电商数仓（用户行为数据采集） (作者：尚硅谷大数据研发部) 版本：V4.0 第1章 数据仓库概念  第2章 项目需求及架构设计 ¶2.1 项目需求分析  ¶2.2 项目框架 ¶2.2.1 技术选型  ¶2.2.2 系统数据流程设计  ¶2.2.3 框架版本选型   ¶2.2.4 服务器选型  ¶2.2.5 集群资源规划设计  2）测试集群服务器规划    服务名称 子服务 服务器">
<meta property="og:type" content="article">
<meta property="og:title" content="1用户行为数据仓库">
<meta property="og:url" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/index.html">
<meta property="og:site_name" content="我的笔记">
<meta property="og:description" content="尚硅谷大数据项目之电商数仓（用户行为数据采集） (作者：尚硅谷大数据研发部) 版本：V4.0 第1章 数据仓库概念  第2章 项目需求及架构设计 ¶2.1 项目需求分析  ¶2.2 项目框架 ¶2.2.1 技术选型  ¶2.2.2 系统数据流程设计  ¶2.2.3 框架版本选型   ¶2.2.4 服务器选型  ¶2.2.5 集群资源规划设计  2）测试集群服务器规划    服务名称 子服务 服务器">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307184306476.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307184417967.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307184442402.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307184504794.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307184640819.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307184654242.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307184712467.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307184800959.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307184826698.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307184844979.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307184916488.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307184933515.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307185025472.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307185051717.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307185110440.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307185124425.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307185147100.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307185810371.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307190133105.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307190144526.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307190231034.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307191301258.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307191357000.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307191558720.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307191818447.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307192044196.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307192434156.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307192448066.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307192513983.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307193005195.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307193052351.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307193218141.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307193532322.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307193759592.png">
<meta property="og:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307193909679.png">
<meta property="article:published_time" content="2021-03-06T16:00:00.000Z">
<meta property="article:modified_time" content="2021-07-11T08:54:53.431Z">
<meta property="article:author" content="momo">
<meta property="article:tag" content="大数据">
<meta property="article:tag" content="电商数仓">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307184306476.png"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="momo"><img width="96" loading="lazy" src="/yun.png" alt="momo"></a><div class="site-author-name"><a href="/about/">momo</a></div><a class="site-name" href="/about/site.html">我的笔记</a><sub class="site-subtitle"></sub><div class="site-desciption"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">199</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">58</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">47</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="文档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-rss-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://qm.qq.com/cgi-bin/qm/qr?k=kZJzggTTCf4SpvEQ8lXWoi5ZjhAx0ILZ&amp;jump_from=webapi" title="QQ 群 1050458482" target="_blank" style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/YunYouJun" title="GitHub" target="_blank" style="color:#6e5494"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://weibo.com/jizhideyunyoujun" title="微博" target="_blank" style="color:#E6162D"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-weibo-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.douban.com/people/yunyoujun/" title="豆瓣" target="_blank" style="color:#007722"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-douban-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=247102977" title="网易云音乐" target="_blank" style="color:#C20C0C"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-netease-cloud-music-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.zhihu.com/people/yunyoujun/" title="知乎" target="_blank" style="color:#0084FF"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-zhihu-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/1579790" title="哔哩哔哩" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/about/white-qrcode-and-search.jpg" title="微信公众号" target="_blank" style="color:#1AAD19"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-2-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://twitter.com/YunYouJun" title="Twitter" target="_blank" style="color:#1da1f2"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-twitter-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://t.me/elpsycn" title="Telegram Channel" target="_blank" style="color:#0088CC"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-telegram-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:me@yunyoujun.cn" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://travellings.link" title="Travelling" target="_blank" style="color:var(--hty-text-color)"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-train-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">第1章 数据仓库概念</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text">第2章 项目需求及架构设计</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E9%A1%B9%E7%9B%AE%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 项目需求分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 项目框架</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-1-%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B"><span class="toc-number">2.2.1.</span> <span class="toc-text">2.2.1 技术选型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-2-%E7%B3%BB%E7%BB%9F%E6%95%B0%E6%8D%AE%E6%B5%81%E7%A8%8B%E8%AE%BE%E8%AE%A1"><span class="toc-number">2.2.2.</span> <span class="toc-text">2.2.2 系统数据流程设计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-3-%E6%A1%86%E6%9E%B6%E7%89%88%E6%9C%AC%E9%80%89%E5%9E%8B"><span class="toc-number">2.2.3.</span> <span class="toc-text">2.2.3 框架版本选型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-4-%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%80%89%E5%9E%8B"><span class="toc-number">2.2.4.</span> <span class="toc-text">2.2.4 服务器选型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-5-%E9%9B%86%E7%BE%A4%E8%B5%84%E6%BA%90%E8%A7%84%E5%88%92%E8%AE%BE%E8%AE%A1"><span class="toc-number">2.2.5.</span> <span class="toc-text">2.2.5 集群资源规划设计</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">3.</span> <span class="toc-text">第3章 数据生成模块</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-%E5%9F%8B%E7%82%B9%E6%95%B0%E6%8D%AE%E5%9F%BA%E6%9C%AC%E6%A0%BC%E5%BC%8F"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 埋点数据基本格式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97%E6%95%B0%E6%8D%AE"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 事件日志数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-1-%E5%95%86%E5%93%81%E5%88%97%E8%A1%A8%E9%A1%B5-loading"><span class="toc-number">3.2.1.</span> <span class="toc-text">3.2.1 商品列表页(loading)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-2-%E5%95%86%E5%93%81%E7%82%B9%E5%87%BB-display"><span class="toc-number">3.2.2.</span> <span class="toc-text">3.2.2 商品点击(display)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-3-%E5%95%86%E5%93%81%E8%AF%A6%E6%83%85%E9%A1%B5-newsdetail"><span class="toc-number">3.2.3.</span> <span class="toc-text">3.2.3 商品详情页(newsdetail)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-4-%E5%B9%BF%E5%91%8A-ad"><span class="toc-number">3.2.4.</span> <span class="toc-text">3.2.4 广告(ad)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-5-%E6%B6%88%E6%81%AF%E9%80%9A%E7%9F%A5-notification"><span class="toc-number">3.2.5.</span> <span class="toc-text">3.2.5 消息通知(notification)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-6-%E7%94%A8%E6%88%B7%E5%89%8D%E5%8F%B0%E6%B4%BB%E8%B7%83-active-foreground"><span class="toc-number">3.2.6.</span> <span class="toc-text">3.2.6 用户前台活跃(active_foreground)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-7-%E7%94%A8%E6%88%B7%E5%90%8E%E5%8F%B0%E6%B4%BB%E8%B7%83-active-background"><span class="toc-number">3.2.7.</span> <span class="toc-text">3.2.7 用户后台活跃(active_background)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-8-%E8%AF%84%E8%AE%BA%EF%BC%88comment%EF%BC%89"><span class="toc-number">3.2.8.</span> <span class="toc-text">3.2.8 评论（comment）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-9-%E6%94%B6%E8%97%8F%EF%BC%88favorites%EF%BC%89"><span class="toc-number">3.2.9.</span> <span class="toc-text">3.2.9 收藏（favorites）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-10-%E7%82%B9%E8%B5%9E%EF%BC%88praise%EF%BC%89"><span class="toc-number">3.2.10.</span> <span class="toc-text">3.2.10 点赞（praise）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-11-%E9%94%99%E8%AF%AF%E6%97%A5%E5%BF%97"><span class="toc-number">3.2.11.</span> <span class="toc-text">3.2.11 错误日志</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-%E5%90%AF%E5%8A%A8%E6%97%A5%E5%BF%97%E6%95%B0%E6%8D%AE"><span class="toc-number">3.3.</span> <span class="toc-text">3.3 启动日志数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-4-%E6%95%B0%E6%8D%AE%E7%94%9F%E6%88%90%E8%84%9A%E6%9C%AC"><span class="toc-number">3.4.</span> <span class="toc-text">3.4 数据生成脚本</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-1-%E5%88%9B%E5%BB%BAMaven%E5%B7%A5%E7%A8%8B"><span class="toc-number">3.4.1.</span> <span class="toc-text">3.4.1 创建Maven工程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-2-%E5%85%AC%E5%85%B1%E5%AD%97%E6%AE%B5Bean"><span class="toc-number">3.4.2.</span> <span class="toc-text">3.4.2 公共字段Bean</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-3-%E5%90%AF%E5%8A%A8%E6%97%A5%E5%BF%97Bean"><span class="toc-number">3.4.3.</span> <span class="toc-text">3.4.3 启动日志Bean</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-3-%E9%94%99%E8%AF%AF%E6%97%A5%E5%BF%97Bean"><span class="toc-number">3.4.4.</span> <span class="toc-text">3.4.3 错误日志Bean</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-4-%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97Bean%E4%B9%8B%E5%95%86%E5%93%81%E7%82%B9%E5%87%BB"><span class="toc-number">3.4.5.</span> <span class="toc-text">3.4.4 事件日志Bean之商品点击</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-5-%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97Bean%E4%B9%8B%E5%95%86%E5%93%81%E8%AF%A6%E6%83%85%E9%A1%B5"><span class="toc-number">3.4.6.</span> <span class="toc-text">3.4.5 事件日志Bean之商品详情页</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-6-%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97Bean%E4%B9%8B%E5%95%86%E5%93%81%E5%88%97%E8%A1%A8%E9%A1%B5"><span class="toc-number">3.4.7.</span> <span class="toc-text">3.4.6 事件日志Bean之商品列表页</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-7-%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97Bean%E4%B9%8B%E5%B9%BF%E5%91%8A"><span class="toc-number">3.4.8.</span> <span class="toc-text">3.4.7 事件日志Bean之广告</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-8-%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97Bean%E4%B9%8B%E6%B6%88%E6%81%AF%E9%80%9A%E7%9F%A5"><span class="toc-number">3.4.9.</span> <span class="toc-text">3.4.8 事件日志Bean之消息通知</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-9-%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97Bean%E4%B9%8B%E7%94%A8%E6%88%B7%E5%89%8D%E5%8F%B0%E6%B4%BB%E8%B7%83"><span class="toc-number">3.4.10.</span> <span class="toc-text">3.4.9 事件日志Bean之用户前台活跃</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-10-%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97Bean%E4%B9%8B%E7%94%A8%E6%88%B7%E5%90%8E%E5%8F%B0%E6%B4%BB%E8%B7%83"><span class="toc-number">3.4.11.</span> <span class="toc-text">3.4.10 事件日志Bean之用户后台活跃</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-11-%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97Bean%E4%B9%8B%E7%94%A8%E6%88%B7%E8%AF%84%E8%AE%BA"><span class="toc-number">3.4.12.</span> <span class="toc-text">3.4.11 事件日志Bean之用户评论</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-12-%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97Bean%E4%B9%8B%E7%94%A8%E6%88%B7%E6%94%B6%E8%97%8F"><span class="toc-number">3.4.13.</span> <span class="toc-text">3.4.12 事件日志Bean之用户收藏</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-13-%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97Bean%E4%B9%8B%E7%94%A8%E6%88%B7%E7%82%B9%E8%B5%9E"><span class="toc-number">3.4.14.</span> <span class="toc-text">3.4.13 事件日志Bean之用户点赞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-14-%E4%B8%BB%E5%87%BD%E6%95%B0"><span class="toc-number">3.4.15.</span> <span class="toc-text">3.4.14 主函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-15-%E9%85%8D%E7%BD%AE%E6%97%A5%E5%BF%97%E6%89%93%E5%8D%B0Logback"><span class="toc-number">3.4.16.</span> <span class="toc-text">3.4.15 配置日志打印Logback</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-16-%E6%89%93%E5%8C%85"><span class="toc-number">3.4.17.</span> <span class="toc-text">3.4.16 打包</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">4.</span> <span class="toc-text">第4章 数据采集模块</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-Hadoop%E5%AE%89%E8%A3%85"><span class="toc-number">4.1.</span> <span class="toc-text">4.1 Hadoop安装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-1-%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C%E4%B9%8BHDFS%E5%AD%98%E5%82%A8%E5%A4%9A%E7%9B%AE%E5%BD%95"><span class="toc-number">4.1.1.</span> <span class="toc-text">4.1.1 项目经验之HDFS存储多目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-2-%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C%E4%B9%8B%E6%94%AF%E6%8C%81LZO%E5%8E%8B%E7%BC%A9%E9%85%8D%E7%BD%AE"><span class="toc-number">4.1.2.</span> <span class="toc-text">4.1.2 项目经验之支持LZO压缩配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-3-%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C%E4%B9%8B%E5%9F%BA%E5%87%86%E6%B5%8B%E8%AF%95"><span class="toc-number">4.1.3.</span> <span class="toc-text">4.1.3 项目经验之基准测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-4-%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C%E4%B9%8BHadoop%E5%8F%82%E6%95%B0%E8%B0%83%E4%BC%98"><span class="toc-number">4.1.4.</span> <span class="toc-text">4.1.4 项目经验之Hadoop参数调优</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-Zookeeper%E5%AE%89%E8%A3%85"><span class="toc-number">4.2.</span> <span class="toc-text">4.2 Zookeeper安装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-1-%E5%AE%89%E8%A3%85ZK"><span class="toc-number">4.2.1.</span> <span class="toc-text">4.2.1 安装ZK</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-2-ZK%E9%9B%86%E7%BE%A4%E5%90%AF%E5%8A%A8%E5%81%9C%E6%AD%A2%E8%84%9A%E6%9C%AC"><span class="toc-number">4.2.2.</span> <span class="toc-text">4.2.2 ZK集群启动停止脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-3-%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C%E4%B9%8BLinux%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-number">4.2.3.</span> <span class="toc-text">4.2.3 项目经验之Linux环境变量</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-%E6%97%A5%E5%BF%97%E7%94%9F%E6%88%90"><span class="toc-number">4.3.</span> <span class="toc-text">4.3 日志生成</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-1-%E6%97%A5%E5%BF%97%E5%90%AF%E5%8A%A8"><span class="toc-number">4.3.1.</span> <span class="toc-text">4.3.1 日志启动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-2-%E9%9B%86%E7%BE%A4%E6%97%A5%E5%BF%97%E7%94%9F%E6%88%90%E5%90%AF%E5%8A%A8%E8%84%9A%E6%9C%AC"><span class="toc-number">4.3.2.</span> <span class="toc-text">4.3.2 集群日志生成启动脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-3-%E9%9B%86%E7%BE%A4%E6%97%B6%E9%97%B4%E5%90%8C%E6%AD%A5%E4%BF%AE%E6%94%B9%E8%84%9A%E6%9C%AC"><span class="toc-number">4.3.3.</span> <span class="toc-text">4.3.3 集群时间同步修改脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-4-%E9%9B%86%E7%BE%A4%E6%89%80%E6%9C%89%E8%BF%9B%E7%A8%8B%E6%9F%A5%E7%9C%8B%E8%84%9A%E6%9C%AC"><span class="toc-number">4.3.4.</span> <span class="toc-text">4.3.4 集群所有进程查看脚本</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4-%E9%87%87%E9%9B%86%E6%97%A5%E5%BF%97Flume"><span class="toc-number">4.4.</span> <span class="toc-text">4.4 采集日志Flume</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-1-%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86Flume%E5%AE%89%E8%A3%85"><span class="toc-number">4.4.1.</span> <span class="toc-text">4.4.1 日志采集Flume安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-2-%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C%E4%B9%8BFlume%E7%BB%84%E4%BB%B6"><span class="toc-number">4.4.2.</span> <span class="toc-text">4.4.2 项目经验之Flume组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-3-%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86Flume%E9%85%8D%E7%BD%AE"><span class="toc-number">4.4.3.</span> <span class="toc-text">4.4.3 日志采集Flume配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-4-Flume%E7%9A%84ETL%E5%92%8C%E5%88%86%E7%B1%BB%E5%9E%8B%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="toc-number">4.4.4.</span> <span class="toc-text">4.4.4 Flume的ETL和分类型拦截器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-5-%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86Flume%E5%90%AF%E5%8A%A8%E5%81%9C%E6%AD%A2%E8%84%9A%E6%9C%AC"><span class="toc-number">4.4.5.</span> <span class="toc-text">4.4.5 日志采集Flume启动停止脚本</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-5-Kafka%E5%AE%89%E8%A3%85"><span class="toc-number">4.5.</span> <span class="toc-text">4.5 Kafka安装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-1-Kafka%E9%9B%86%E7%BE%A4%E5%AE%89%E8%A3%85"><span class="toc-number">4.5.1.</span> <span class="toc-text">4.5.1 Kafka集群安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-2-Kafka%E9%9B%86%E7%BE%A4%E5%90%AF%E5%8A%A8%E5%81%9C%E6%AD%A2%E8%84%9A%E6%9C%AC"><span class="toc-number">4.5.2.</span> <span class="toc-text">4.5.2 Kafka集群启动停止脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-3-%E6%9F%A5%E7%9C%8BKafka-Topic%E5%88%97%E8%A1%A8"><span class="toc-number">4.5.3.</span> <span class="toc-text">4.5.3 查看Kafka Topic列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-4-%E5%88%9B%E5%BB%BAKafka-Topic"><span class="toc-number">4.5.4.</span> <span class="toc-text">4.5.4 创建Kafka Topic</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-5-%E5%88%A0%E9%99%A4Kafka-Topic"><span class="toc-number">4.5.5.</span> <span class="toc-text">4.5.5 删除Kafka Topic</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-6-Kafka%E7%94%9F%E4%BA%A7%E6%B6%88%E6%81%AF"><span class="toc-number">4.5.6.</span> <span class="toc-text">4.5.6 Kafka生产消息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-7-Kafka%E6%B6%88%E8%B4%B9%E6%B6%88%E6%81%AF"><span class="toc-number">4.5.7.</span> <span class="toc-text">4.5.7 Kafka消费消息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-8-%E6%9F%A5%E7%9C%8BKafka-Topic%E8%AF%A6%E6%83%85"><span class="toc-number">4.5.8.</span> <span class="toc-text">4.5.8 查看Kafka Topic详情</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-9-Kafka-Manager%E5%AE%89%E8%A3%85"><span class="toc-number">4.5.9.</span> <span class="toc-text">4.5.9 Kafka Manager安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-10-Kafka-Manager%E5%90%AF%E5%8A%A8%E5%81%9C%E6%AD%A2%E8%84%9A%E6%9C%AC"><span class="toc-number">4.5.10.</span> <span class="toc-text">4.5.10 Kafka Manager启动停止脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-11-%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C%E4%B9%8BKafka%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95"><span class="toc-number">4.5.11.</span> <span class="toc-text">4.5.11 项目经验之Kafka压力测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-12-%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C%E4%B9%8BKafka%E6%9C%BA%E5%99%A8%E6%95%B0%E9%87%8F%E8%AE%A1%E7%AE%97"><span class="toc-number">4.5.12.</span> <span class="toc-text">4.5.12 项目经验之Kafka机器数量计算</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-6-%E6%B6%88%E8%B4%B9Kafka%E6%95%B0%E6%8D%AEFlume"><span class="toc-number">4.6.</span> <span class="toc-text">4.6 消费Kafka数据Flume</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-1-%E6%97%A5%E5%BF%97%E6%B6%88%E8%B4%B9Flume%E9%85%8D%E7%BD%AE"><span class="toc-number">4.6.1.</span> <span class="toc-text">4.6.1 日志消费Flume配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-2-%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C%E4%B9%8BFlume%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96"><span class="toc-number">4.6.2.</span> <span class="toc-text">4.6.2 项目经验之Flume内存优化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-3-%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C%E4%B9%8BFlume%E7%BB%84%E4%BB%B6"><span class="toc-number">4.6.3.</span> <span class="toc-text">4.6.3 项目经验之Flume组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-4-%E6%97%A5%E5%BF%97%E6%B6%88%E8%B4%B9Flume%E5%90%AF%E5%8A%A8%E5%81%9C%E6%AD%A2%E8%84%9A%E6%9C%AC"><span class="toc-number">4.6.4.</span> <span class="toc-text">4.6.4 日志消费Flume启动停止脚本</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-7-%E9%87%87%E9%9B%86%E9%80%9A%E9%81%93%E5%90%AF%E5%8A%A8-%E5%81%9C%E6%AD%A2%E8%84%9A%E6%9C%AC"><span class="toc-number">4.7.</span> <span class="toc-text">4.7 采集通道启动&#x2F;停止脚本</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">5.</span> <span class="toc-text">第5章 总结</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-%E6%95%B0%E4%BB%93%E6%A6%82%E5%BF%B5%E6%80%BB%E7%BB%93"><span class="toc-number">5.1.</span> <span class="toc-text">5.1 数仓概念总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-%E9%A1%B9%E7%9B%AE%E9%9C%80%E6%B1%82%E5%8F%8A%E6%9E%B6%E6%9E%84%E6%80%BB%E7%BB%93"><span class="toc-number">5.2.</span> <span class="toc-text">5.2 项目需求及架构总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-1-%E9%9B%86%E7%BE%A4%E8%A7%84%E6%A8%A1%E8%AE%A1%E7%AE%97"><span class="toc-number">5.2.1.</span> <span class="toc-text">5.2.1 集群规模计算</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-2-%E6%A1%86%E6%9E%B6%E7%89%88%E6%9C%AC%E9%80%89%E5%9E%8B"><span class="toc-number">5.2.2.</span> <span class="toc-text">5.2.2 框架版本选型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-3-%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%80%89%E5%9E%8B"><span class="toc-number">5.2.3.</span> <span class="toc-text">5.2.3 服务器选型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3-%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%E6%A8%A1%E5%9D%97%E6%80%BB%E7%BB%93"><span class="toc-number">5.3.</span> <span class="toc-text">5.3 数据采集模块总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-1-Linux-Shell%E7%9B%B8%E5%85%B3%E6%80%BB%E7%BB%93"><span class="toc-number">5.3.1.</span> <span class="toc-text">5.3.1 Linux&amp;Shell相关总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-2-Hadoop%E7%9B%B8%E5%85%B3%E6%80%BB%E7%BB%93"><span class="toc-number">5.3.2.</span> <span class="toc-text">5.3.2 Hadoop相关总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-3-Zookeeper%E7%9B%B8%E5%85%B3%E6%80%BB%E7%BB%93"><span class="toc-number">5.3.3.</span> <span class="toc-text">5.3.3 Zookeeper相关总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-4-Flume%E7%9B%B8%E5%85%B3%E6%80%BB%E7%BB%93"><span class="toc-number">5.3.4.</span> <span class="toc-text">5.3.4 Flume相关总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-5-Kafka%E7%9B%B8%E5%85%B3%E6%80%BB%E7%BB%93"><span class="toc-number">5.3.5.</span> <span class="toc-text">5.3.5 Kafka相关总结</span></a></li></ol></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="momo"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="我的笔记"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">1用户行为数据仓库</h1><div class="post-meta"><div class="post-time" style="display:inline-block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="创建时间：2021-03-07 00:00:00" itemprop="dateCreated datePublished" datetime="2021-03-07T00:00:00+08:00">2021-03-07</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="修改时间：2021-07-11 16:54:53" itemprop="dateModified" datetime="2021-07-11T16:54:53+08:00">2021-07-11</time></div><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">大数据</span></a></span> > <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">电商数仓</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">大数据</span></a><a class="tag-item" href="/tags/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">电商数仓</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#0078E7;"><p>尚硅谷大数据项目之电商数仓（用户行为数据采集）</p>
<p>(作者：尚硅谷大数据研发部)</p>
<p>版本：V4.0</p>
<h1>第1章 数据仓库概念</h1>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307184306476.png" class="" title="image-20210307184306476" loading="lazy">
<h1>第2章 项目需求及架构设计</h1>
<h2 id="2-1-项目需求分析"><a class="header-anchor" href="#2-1-项目需求分析">¶</a>2.1 项目需求分析</h2>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307184417967.png" class="" title="image-20210307184417967" loading="lazy">
<h2 id="2-2-项目框架"><a class="header-anchor" href="#2-2-项目框架">¶</a>2.2 项目框架</h2>
<h3 id="2-2-1-技术选型"><a class="header-anchor" href="#2-2-1-技术选型">¶</a>2.2.1 技术选型</h3>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307184442402.png" class="" title="image-20210307184442402" loading="lazy">
<h3 id="2-2-2-系统数据流程设计"><a class="header-anchor" href="#2-2-2-系统数据流程设计">¶</a>2.2.2 系统数据流程设计</h3>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307184504794.png" class="" title="image-20210307184504794" loading="lazy">
<h3 id="2-2-3-框架版本选型"><a class="header-anchor" href="#2-2-3-框架版本选型">¶</a>2.2.3 框架版本选型</h3>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307184640819.png" class="" title="image-20210307184640819" loading="lazy">
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307184654242.png" class="" title="image-20210307184654242" loading="lazy">
<h3 id="2-2-4-服务器选型"><a class="header-anchor" href="#2-2-4-服务器选型">¶</a>2.2.4 服务器选型</h3>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307184712467.png" class="" title="image-20210307184712467" loading="lazy">
<h3 id="2-2-5-集群资源规划设计"><a class="header-anchor" href="#2-2-5-集群资源规划设计">¶</a>2.2.5 集群资源规划设计</h3>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307184800959.png" class="" title="image-20210307184800959" loading="lazy">
<p>2）测试集群服务器规划</p>
<table>
<thead>
<tr>
<th>服务名称</th>
<th>子服务</th>
<th>服务器hadoop102</th>
<th>服务器hadoop103</th>
<th>服务器hadoop104</th>
</tr>
</thead>
<tbody>
<tr>
<td>HDFS</td>
<td>NameNode</td>
<td>√</td>
<td></td>
<td></td>
</tr>
<tr>
<td>DataNode</td>
<td>√</td>
<td>√</td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>SecondaryNameNode</td>
<td></td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>Yarn</td>
<td>NodeManager</td>
<td>√</td>
<td>√</td>
<td>√</td>
</tr>
<tr>
<td>Resourcemanager</td>
<td></td>
<td>√</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Zookeeper</td>
<td>Zookeeper Server</td>
<td>√</td>
<td>√</td>
<td>√</td>
</tr>
<tr>
<td>Flume(采集日志)</td>
<td>Flume</td>
<td>√</td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>Kafka</td>
<td>Kafka</td>
<td>√</td>
<td>√</td>
<td>√</td>
</tr>
<tr>
<td>Flume（消费Kafka）</td>
<td>Flume</td>
<td></td>
<td></td>
<td>√</td>
</tr>
<tr>
<td>Hive</td>
<td>Hive</td>
<td>√</td>
<td></td>
<td></td>
</tr>
<tr>
<td>MySQL</td>
<td>MySQL</td>
<td>√</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Sqoop</td>
<td>Sqoop</td>
<td>√</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Presto</td>
<td>Coordinator</td>
<td>√</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Worker</td>
<td></td>
<td>√</td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>Azkaban</td>
<td>AzkabanWebServer</td>
<td>√</td>
<td></td>
<td></td>
</tr>
<tr>
<td>AzkabanExecutorServer</td>
<td>√</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Druid</td>
<td>Druid</td>
<td>√</td>
<td>√</td>
<td>√</td>
</tr>
<tr>
<td>服务数总计</td>
<td></td>
<td>13</td>
<td>8</td>
<td>9</td>
</tr>
</tbody>
</table>
<h1>第3章 数据生成模块</h1>
<h2 id="3-1-埋点数据基本格式"><a class="header-anchor" href="#3-1-埋点数据基本格式">¶</a>3.1 埋点数据基本格式</h2>
<ul>
<li>
<p>公共字段：基本所有安卓手机都包含的字段</p>
</li>
<li>
<p>业务字段：埋点上报的字段，有具体的业务类型</p>
</li>
</ul>
<p>下面就是一个示例，表示业务字段的上传。</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
<span class="token property">"ap"</span><span class="token operator">:</span><span class="token string">"xxxxx"</span><span class="token punctuation">,</span><span class="token comment">//项目数据来源 app pc</span>
<span class="token property">"cm"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>  <span class="token comment">//公共字段</span>
		<span class="token property">"mid"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>  <span class="token comment">// (String) 设备唯一标识</span>
        <span class="token property">"uid"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>  <span class="token comment">// (String) 用户标识</span>
        <span class="token property">"vc"</span><span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>  <span class="token comment">// (String) versionCode，程序版本号</span>
        <span class="token property">"vn"</span><span class="token operator">:</span> <span class="token string">"1.0"</span><span class="token punctuation">,</span>  <span class="token comment">// (String) versionName，程序版本名</span>
        <span class="token property">"l"</span><span class="token operator">:</span> <span class="token string">"zh"</span><span class="token punctuation">,</span>  <span class="token comment">// (String) 系统语言</span>
        <span class="token property">"sr"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>  <span class="token comment">// (String) 渠道号，应用从哪个渠道来的。</span>
        <span class="token property">"os"</span><span class="token operator">:</span> <span class="token string">"7.1.1"</span><span class="token punctuation">,</span>  <span class="token comment">// (String) Android系统版本</span>
        <span class="token property">"ar"</span><span class="token operator">:</span> <span class="token string">"CN"</span><span class="token punctuation">,</span>  <span class="token comment">// (String) 区域</span>
        <span class="token property">"md"</span><span class="token operator">:</span> <span class="token string">"BBB100-1"</span><span class="token punctuation">,</span>  <span class="token comment">// (String) 手机型号</span>
        <span class="token property">"ba"</span><span class="token operator">:</span> <span class="token string">"blackberry"</span><span class="token punctuation">,</span>  <span class="token comment">// (String) 手机品牌</span>
        <span class="token property">"sv"</span><span class="token operator">:</span> <span class="token string">"V2.2.1"</span><span class="token punctuation">,</span>  <span class="token comment">// (String) sdkVersion</span>
        <span class="token property">"g"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>  <span class="token comment">// (String) gmail</span>
        <span class="token property">"hw"</span><span class="token operator">:</span> <span class="token string">"1620x1080"</span><span class="token punctuation">,</span>  <span class="token comment">// (String) heightXwidth，屏幕宽高</span>
        <span class="token property">"t"</span><span class="token operator">:</span> <span class="token string">"1506047606608"</span><span class="token punctuation">,</span>  <span class="token comment">// (String) 客户端日志产生时的时间</span>
        <span class="token property">"nw"</span><span class="token operator">:</span> <span class="token string">"WIFI"</span><span class="token punctuation">,</span>  <span class="token comment">// (String) 网络模式</span>
        <span class="token property">"ln"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token comment">// (double) lng经度</span>
        <span class="token property">"la"</span><span class="token operator">:</span> <span class="token number">0</span>  <span class="token comment">// (double) lat 纬度</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token property">"et"</span><span class="token operator">:</span>  <span class="token punctuation">[</span>  <span class="token comment">//事件</span>
            <span class="token punctuation">&#123;</span>
                <span class="token property">"ett"</span><span class="token operator">:</span> <span class="token string">"1506047605364"</span><span class="token punctuation">,</span>  <span class="token comment">//客户端事件产生时间</span>
                <span class="token property">"en"</span><span class="token operator">:</span> <span class="token string">"display"</span><span class="token punctuation">,</span>  <span class="token comment">//事件名称</span>
                <span class="token property">"kv"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>  <span class="token comment">//事件结果，以key-value形式自行定义</span>
                    <span class="token property">"goodsid"</span><span class="token operator">:</span> <span class="token string">"236"</span><span class="token punctuation">,</span>
                    <span class="token property">"action"</span><span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
                    <span class="token property">"extend1"</span><span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
<span class="token property">"place"</span><span class="token operator">:</span> <span class="token string">"2"</span><span class="token punctuation">,</span>
<span class="token property">"category"</span><span class="token operator">:</span> <span class="token string">"75"</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>示例日志（服务器时间戳 | 日志）：</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token number">1540934156385</span>|<span class="token punctuation">&#123;</span>
    <span class="token property">"ap"</span><span class="token operator">:</span> <span class="token string">"gmall"</span><span class="token punctuation">,</span> 
    <span class="token property">"cm"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"uid"</span><span class="token operator">:</span> <span class="token string">"1234"</span><span class="token punctuation">,</span> 
        <span class="token property">"vc"</span><span class="token operator">:</span> <span class="token string">"2"</span><span class="token punctuation">,</span> 
        <span class="token property">"vn"</span><span class="token operator">:</span> <span class="token string">"1.0"</span><span class="token punctuation">,</span> 
        <span class="token property">"la"</span><span class="token operator">:</span> <span class="token string">"EN"</span><span class="token punctuation">,</span> 
        <span class="token property">"sr"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span> 
        <span class="token property">"os"</span><span class="token operator">:</span> <span class="token string">"7.1.1"</span><span class="token punctuation">,</span> 
        <span class="token property">"ar"</span><span class="token operator">:</span> <span class="token string">"CN"</span><span class="token punctuation">,</span> 
        <span class="token property">"md"</span><span class="token operator">:</span> <span class="token string">"BBB100-1"</span><span class="token punctuation">,</span> 
        <span class="token property">"ba"</span><span class="token operator">:</span> <span class="token string">"blackberry"</span><span class="token punctuation">,</span> 
        <span class="token property">"sv"</span><span class="token operator">:</span> <span class="token string">"V2.2.1"</span><span class="token punctuation">,</span> 
        <span class="token property">"g"</span><span class="token operator">:</span> <span class="token string">"abc@gmail.com"</span><span class="token punctuation">,</span> 
        <span class="token property">"hw"</span><span class="token operator">:</span> <span class="token string">"1620x1080"</span><span class="token punctuation">,</span> 
        <span class="token property">"t"</span><span class="token operator">:</span> <span class="token string">"1506047606608"</span><span class="token punctuation">,</span> 
        <span class="token property">"nw"</span><span class="token operator">:</span> <span class="token string">"WIFI"</span><span class="token punctuation">,</span> 
        <span class="token property">"ln"</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> 
        <span class="token property">"et"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">&#123;</span>
                <span class="token property">"ett"</span><span class="token operator">:</span> <span class="token string">"1506047605364"</span><span class="token punctuation">,</span>  <span class="token comment">//客户端事件产生时间</span>
                <span class="token property">"en"</span><span class="token operator">:</span> <span class="token string">"display"</span><span class="token punctuation">,</span>  <span class="token comment">//事件名称</span>
                <span class="token property">"kv"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>  <span class="token comment">//事件结果，以key-value形式自行定义</span>
                    <span class="token property">"goodsid"</span><span class="token operator">:</span> <span class="token string">"236"</span><span class="token punctuation">,</span>
                    <span class="token property">"action"</span><span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
                    <span class="token property">"extend1"</span><span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
<span class="token property">"place"</span><span class="token operator">:</span> <span class="token string">"2"</span><span class="token punctuation">,</span>
<span class="token property">"category"</span><span class="token operator">:</span> <span class="token string">"75"</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>
		        <span class="token property">"ett"</span><span class="token operator">:</span> <span class="token string">"1552352626835"</span><span class="token punctuation">,</span>
		        <span class="token property">"en"</span><span class="token operator">:</span> <span class="token string">"active_background"</span><span class="token punctuation">,</span>
		        <span class="token property">"kv"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
			         <span class="token property">"active_source"</span><span class="token operator">:</span> <span class="token string">"1"</span>
		        <span class="token punctuation">&#125;</span>
	        <span class="token punctuation">&#125;</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>下面是各个埋点日志格式。其中商品点击属于信息流的范畴</p>
<h2 id="3-2-事件日志数据"><a class="header-anchor" href="#3-2-事件日志数据">¶</a>3.2 事件日志数据</h2>
<h3 id="3-2-1-商品列表页-loading"><a class="header-anchor" href="#3-2-1-商品列表页-loading">¶</a>3.2.1 商品列表页(loading)</h3>
<p>事件名称：loading</p>
<table>
<thead>
<tr>
<th>标签</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>action</td>
<td>动作：开始加载=1，加载成功=2，加载失败=3</td>
</tr>
<tr>
<td>loading_time</td>
<td><strong>加载时长：计算下拉开始到接口返回数据的时间，（开始加载报0，加载成功或加载失败才上报时间）</strong></td>
</tr>
<tr>
<td>loading_way</td>
<td>加载类型：1-读取缓存，2-从接口拉新数据 （加载成功才上报加载类型）</td>
</tr>
<tr>
<td>extend1</td>
<td><strong>扩展字段 Extend1</strong></td>
</tr>
<tr>
<td>extend2</td>
<td>扩展字段 Extend2</td>
</tr>
<tr>
<td>type</td>
<td><strong>加载类型：自动加载=1，用户下拽加载=2，底部加载=3（底部条触发点击底部提示条/点击返回顶部加载）</strong></td>
</tr>
<tr>
<td>type1</td>
<td>加载失败码：把加载失败状态码报回来（报空为加载成功，没有失败）</td>
</tr>
</tbody>
</table>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307184826698.png" class="" title="image-20210307184826698" loading="lazy">
<h3 id="3-2-2-商品点击-display"><a class="header-anchor" href="#3-2-2-商品点击-display">¶</a>3.2.2 商品点击(display)</h3>
<p>事件标签：display</p>
<table>
<thead>
<tr>
<th>标签</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>action</td>
<td>动作：曝光商品=1，点击商品=2，</td>
</tr>
<tr>
<td>goodsid</td>
<td>商品ID（服务端下发的ID）</td>
</tr>
<tr>
<td>place</td>
<td>顺序（第几条商品，第一条为0，第二条为1，如此类推）</td>
</tr>
<tr>
<td>extend1</td>
<td>曝光类型：1 - 首次曝光 2-重复曝光</td>
</tr>
<tr>
<td>category</td>
<td>分类ID（服务端定义的分类ID）</td>
</tr>
</tbody>
</table>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307184844979.png" class="" title="image-20210307184844979" loading="lazy">
<h3 id="3-2-3-商品详情页-newsdetail"><a class="header-anchor" href="#3-2-3-商品详情页-newsdetail">¶</a>3.2.3 商品详情页(newsdetail)</h3>
<p>事件标签：newsdetail</p>
<table>
<thead>
<tr>
<th>标签</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>entry</td>
<td>页面入口来源：应用首页=1、push=2、详情页相关推荐=3</td>
</tr>
<tr>
<td>action</td>
<td>动作：开始加载=1，加载成功=2（pv），加载失败=3, 退出页面=4</td>
</tr>
<tr>
<td>goodsid</td>
<td>商品ID（服务端下发的ID）</td>
</tr>
<tr>
<td>show_style</td>
<td>商品样式：0、无图、1、一张大图、2、两张图、3、三张小图、4、一张小图、5、一张大图两张小图</td>
</tr>
<tr>
<td>news_staytime</td>
<td>页面停留时长：从商品开始加载时开始计算，到用户关闭页面所用的时间。若中途用跳转到其它页面了，则暂停计时，待回到详情页时恢复计时。或中途划出的时间超过10分钟，则本次计时作废，不上报本次数据。如未加载成功退出，则报空。</td>
</tr>
<tr>
<td>loading_time</td>
<td>加载时长：计算页面开始加载到接口返回数据的时间 （开始加载报0，加载成功或加载失败才上报时间）</td>
</tr>
<tr>
<td>type1</td>
<td>加载失败码：把加载失败状态码报回来（报空为加载成功，没有失败）</td>
</tr>
<tr>
<td>category</td>
<td>分类ID（服务端定义的分类ID）</td>
</tr>
</tbody>
</table>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307184916488.png" class="" title="image-20210307184916488" loading="lazy">
<h3 id="3-2-4-广告-ad"><a class="header-anchor" href="#3-2-4-广告-ad">¶</a>3.2.4 广告(ad)</h3>
<p>事件名称：ad</p>
<table>
<thead>
<tr>
<th>标签</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>entry</td>
<td>入口：商品列表页=1 应用首页=2 商品详情页=3</td>
</tr>
<tr>
<td>action</td>
<td>动作：请求广告=1 取缓存广告=2 广告位展示=3 广告展示=4 广告点击=5</td>
</tr>
<tr>
<td>content</td>
<td>状态：成功=1 失败=2</td>
</tr>
<tr>
<td>detail</td>
<td>失败码（没有则上报空）</td>
</tr>
<tr>
<td>source</td>
<td>广告来源:admob=1 facebook=2 ADX（百度）=3 VK（俄罗斯）=4</td>
</tr>
<tr>
<td>behavior</td>
<td>用户行为： 主动获取广告=1  被动获取广告=2</td>
</tr>
<tr>
<td>newstype</td>
<td>Type: 1- 图文 2-图集 3-段子 4-GIF 5-视频 6-调查 7-纯文 8-视频+图文 9-GIF+图文 0-其他</td>
</tr>
<tr>
<td>show_style</td>
<td>内容样式：无图(纯文字)=6 一张大图=1 三站小图+文=4 一张小图=2 一张大图两张小图+文=3 图集+文 = 5  一张大图+文=11  GIF大图+文=12 视频(大图)+文 = 13 来源于详情页相关推荐的商品，上报样式都为0（因为都是左文右图）</td>
</tr>
</tbody>
</table>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307184933515.png" class="" title="image-20210307184933515" loading="lazy">
<h3 id="3-2-5-消息通知-notification"><a class="header-anchor" href="#3-2-5-消息通知-notification">¶</a>3.2.5 消息通知(notification)</h3>
<p>事件标签：notification</p>
<table>
<thead>
<tr>
<th>标签</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>action</td>
<td>动作：通知产生=1，通知弹出=2，通知点击=3，常驻通知展示（不重复上报，一天之内只报一次）=4</td>
</tr>
<tr>
<td>type</td>
<td>通知id：预警通知=1，天气预报（早=2，晚=3），常驻=4</td>
</tr>
<tr>
<td>ap_time</td>
<td>客户端弹出时间</td>
</tr>
<tr>
<td>content</td>
<td>备用字段</td>
</tr>
</tbody>
</table>
<h3 id="3-2-6-用户前台活跃-active-foreground"><a class="header-anchor" href="#3-2-6-用户前台活跃-active-foreground">¶</a>3.2.6 用户前台活跃(active_foreground)</h3>
<p>事件标签: active_foreground</p>
<table>
<thead>
<tr>
<th>标签</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>push_id</td>
<td>推送的消息的id，如果不是从推送消息打开，传空</td>
</tr>
<tr>
<td>access</td>
<td>1.push 2.icon 3.其他</td>
</tr>
</tbody>
</table>
<h3 id="3-2-7-用户后台活跃-active-background"><a class="header-anchor" href="#3-2-7-用户后台活跃-active-background">¶</a>3.2.7 用户后台活跃(active_background)</h3>
<p>事件标签: active_background</p>
<table>
<thead>
<tr>
<th>标签</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>active_source</td>
<td>1=upgrade,2=download(下载),3=plugin_upgrade</td>
</tr>
</tbody>
</table>
<h3 id="3-2-8-评论（comment）"><a class="header-anchor" href="#3-2-8-评论（comment）">¶</a>3.2.8 评论（comment）</h3>
<p>描述：评论表</p>
<table>
<thead>
<tr>
<th><strong>序号</strong></th>
<th><strong>字段名称</strong></th>
<th><strong>字段描述</strong></th>
<th><strong>字段类型</strong></th>
<th><strong>长度</strong></th>
<th><strong>允许空</strong></th>
<th><strong>缺省值</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>comment_id</td>
<td>评论表</td>
<td>int</td>
<td>10,0</td>
<td></td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>userid</td>
<td>用户id</td>
<td>int</td>
<td>10,0</td>
<td>√</td>
<td>0</td>
</tr>
<tr>
<td>3</td>
<td>p_comment_id</td>
<td>父级评论id(为0则是一级评论,不为0则是回复)</td>
<td>int</td>
<td>10,0</td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>4</td>
<td>content</td>
<td>评论内容</td>
<td>string</td>
<td>1000</td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>5</td>
<td>addtime</td>
<td>创建时间</td>
<td>string</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>6</td>
<td>other_id</td>
<td>评论的相关id</td>
<td>int</td>
<td>10,0</td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>7</td>
<td>praise_count</td>
<td>点赞数量</td>
<td>int</td>
<td>10,0</td>
<td>√</td>
<td>0</td>
</tr>
<tr>
<td>8</td>
<td>reply_count</td>
<td>回复数量</td>
<td>int</td>
<td>10,0</td>
<td>√</td>
<td>0</td>
</tr>
</tbody>
</table>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307185025472.png" class="" title="image-20210307185025472" loading="lazy">
<h3 id="3-2-9-收藏（favorites）"><a class="header-anchor" href="#3-2-9-收藏（favorites）">¶</a>3.2.9 收藏（favorites）</h3>
<p>描述：收藏</p>
<table>
<thead>
<tr>
<th><em><strong>*序号*</strong></em></th>
<th><em><strong>*字段名称*</strong></em></th>
<th><em><strong>*字段描述*</strong></em></th>
<th><em><strong>*字段类型*</strong></em></th>
<th><em><strong>*长度*</strong></em></th>
<th><em><strong>*允许空*</strong></em></th>
<th><em><strong>*缺省值*</strong></em></th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>id</td>
<td>主键</td>
<td>int</td>
<td>10,0</td>
<td></td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>course_id</td>
<td>商品id</td>
<td>int</td>
<td>10,0</td>
<td>√</td>
<td>0</td>
</tr>
<tr>
<td>3</td>
<td>userid</td>
<td>用户ID</td>
<td>int</td>
<td>10,0</td>
<td>√</td>
<td>0</td>
</tr>
<tr>
<td>4</td>
<td>add_time</td>
<td>创建时间</td>
<td>string</td>
<td></td>
<td>√</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="3-2-10-点赞（praise）"><a class="header-anchor" href="#3-2-10-点赞（praise）">¶</a>3.2.10 点赞（praise）</h3>
<p>描述：所有的点赞表</p>
<table>
<thead>
<tr>
<th><em><strong>*序号*</strong></em></th>
<th><em><strong>*字段名称*</strong></em></th>
<th><em><strong>*字段描述*</strong></em></th>
<th><em><strong>*字段类型*</strong></em></th>
<th><em><strong>*长度*</strong></em></th>
<th><em><strong>*允许空*</strong></em></th>
<th><em><strong>*缺省值*</strong></em></th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>id</td>
<td>主键id</td>
<td>int</td>
<td>10,0</td>
<td></td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>userid</td>
<td>用户id</td>
<td>int</td>
<td>10,0</td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>3</td>
<td>target_id</td>
<td>点赞的对象id</td>
<td>int</td>
<td>10,0</td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>4</td>
<td>type</td>
<td>点赞类型 1问答点赞 2问答评论点赞 3 文章点赞数4 评论点赞</td>
<td>int</td>
<td>10,0</td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>5</td>
<td>add_time</td>
<td>添加时间</td>
<td>string</td>
<td></td>
<td>√</td>
<td></td>
</tr>
</tbody>
</table>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307185051717.png" class="" title="image-20210307185051717" loading="lazy">
<h3 id="3-2-11-错误日志"><a class="header-anchor" href="#3-2-11-错误日志">¶</a>3.2.11 错误日志</h3>
<hr>
<table>
<thead>
<tr>
<th>errorBrief</th>
<th>错误摘要</th>
</tr>
</thead>
<tbody>
<tr>
<td>errorDetail</td>
<td>错误详情</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="3-3-启动日志数据"><a class="header-anchor" href="#3-3-启动日志数据">¶</a>3.3 启动日志数据</h2>
<p>事件标签: start action=1可以算成前台活跃</p>
<hr>
<table>
<thead>
<tr>
<th>标签</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>entry</td>
<td>入口： push=1，widget=2，icon=3，notification=4, lockscreen_widget =5</td>
</tr>
<tr>
<td>open_ad_type</td>
<td>开屏广告类型:  开屏原生广告=1, 开屏插屏广告=2</td>
</tr>
<tr>
<td>action</td>
<td>状态：成功=1 失败=2</td>
</tr>
<tr>
<td>loading_time</td>
<td>加载时长：计算下拉开始到接口返回数据的时间，（开始加载报0，加载成功或加载失败才上报时间）</td>
</tr>
<tr>
<td>detail</td>
<td>失败码（没有则上报空）</td>
</tr>
<tr>
<td>extend1</td>
<td>失败的message（没有则上报空）</td>
</tr>
<tr>
<td>en</td>
<td>日志类型start</td>
</tr>
</tbody>
</table>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307185110440.png" class="" title="image-20210307185110440" loading="lazy">
<h2 id="3-4-数据生成脚本"><a class="header-anchor" href="#3-4-数据生成脚本">¶</a>3.4 数据生成脚本</h2>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307185124425.png" class="" title="image-20210307185124425" loading="lazy">
<h3 id="3-4-1-创建Maven工程"><a class="header-anchor" href="#3-4-1-创建Maven工程">¶</a>3.4.1 创建Maven工程</h3>
<p>1）创建log-collector</p>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307185147100.png" class="" title="image-20210307185147100" loading="lazy">
<p>2）创建一个包名：com.atguigu.appclient</p>
<p>3）在com.atguigu.appclient包下创建一个类，AppMain。</p>
<p>4）在pom.xml文件中添加如下内容</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!--版本号统一--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slf4j.version</span><span class="token punctuation">></span></span>1.7.20<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slf4j.version</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logback.version</span><span class="token punctuation">></span></span>1.0.7<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logback.version</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>
    <span class="token comment">&lt;!--阿里巴巴开源json解析框架--></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>fastjson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.2.51<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>

    <span class="token comment">&lt;!--日志生成框架--></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>ch.qos.logback<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>logback-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;logback.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>ch.qos.logback<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>logback-classic<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;logback.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span>

<span class="token comment">&lt;!--编译打包插件--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>maven-compiler-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.3.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span><span class="token punctuation">></span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>source</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>target</span><span class="token punctuation">></span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>target</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>maven-assembly-plugin <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>descriptorRefs</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>descriptorRef</span><span class="token punctuation">></span></span>jar-with-dependencies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>descriptorRef</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>descriptorRefs</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>archive</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>manifest</span><span class="token punctuation">></span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mainClass</span><span class="token punctuation">></span></span>com.atguigu.appclient.AppMain<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mainClass</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>manifest</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>archive</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>executions</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>execution</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>make-assembly<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>phase</span><span class="token punctuation">></span></span>package<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>phase</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goals</span><span class="token punctuation">></span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goal</span><span class="token punctuation">></span></span>single<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goal</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goals</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>execution</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>executions</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>注意：com.atguigu.appclient.AppMain要和自己建的全类名一致。</p>
<h3 id="3-4-2-公共字段Bean"><a class="header-anchor" href="#3-4-2-公共字段Bean">¶</a>3.4.2 公共字段Bean</h3>
<p>1）创建包名：com.atguigu.bean</p>
<p>2）在com.atguigu.bean包下依次创建如下bean对象</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bean</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * 公共日志
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppBase</span><span class="token punctuation">&#123;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> mid<span class="token punctuation">;</span> <span class="token comment">// (String) 设备唯一标识</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> uid<span class="token punctuation">;</span> <span class="token comment">// (String) 用户uid</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> vc<span class="token punctuation">;</span>  <span class="token comment">// (String) versionCode，程序版本号</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> vn<span class="token punctuation">;</span>  <span class="token comment">// (String) versionName，程序版本名</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> l<span class="token punctuation">;</span>   <span class="token comment">// (String) 系统语言</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> sr<span class="token punctuation">;</span>  <span class="token comment">// (String) 渠道号，应用从哪个渠道来的。</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> os<span class="token punctuation">;</span>  <span class="token comment">// (String) Android系统版本</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> ar<span class="token punctuation">;</span>  <span class="token comment">// (String) 区域</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> md<span class="token punctuation">;</span>  <span class="token comment">// (String) 手机型号</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> ba<span class="token punctuation">;</span>  <span class="token comment">// (String) 手机品牌</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> sv<span class="token punctuation">;</span>  <span class="token comment">// (String) sdkVersion</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> g<span class="token punctuation">;</span>   <span class="token comment">// (String) gmail</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> hw<span class="token punctuation">;</span>  <span class="token comment">// (String) heightXwidth，屏幕宽高</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> t<span class="token punctuation">;</span>   <span class="token comment">// (String) 客户端日志产生时的时间</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> nw<span class="token punctuation">;</span>  <span class="token comment">// (String) 网络模式</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> ln<span class="token punctuation">;</span>  <span class="token comment">// (double) lng经度</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> la<span class="token punctuation">;</span>  <span class="token comment">// (double) lat 纬度</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getMid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> mid<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMid</span><span class="token punctuation">(</span><span class="token class-name">String</span> mid<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>mid <span class="token operator">=</span> mid<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getUid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> uid<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUid</span><span class="token punctuation">(</span><span class="token class-name">String</span> uid<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>uid <span class="token operator">=</span> uid<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getVc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> vc<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setVc</span><span class="token punctuation">(</span><span class="token class-name">String</span> vc<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>vc <span class="token operator">=</span> vc<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getVn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> vn<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setVn</span><span class="token punctuation">(</span><span class="token class-name">String</span> vn<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>vn <span class="token operator">=</span> vn<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getL</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> l<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setL</span><span class="token punctuation">(</span><span class="token class-name">String</span> l<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>l <span class="token operator">=</span> l<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getSr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> sr<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setSr</span><span class="token punctuation">(</span><span class="token class-name">String</span> sr<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>sr <span class="token operator">=</span> sr<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getOs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> os<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setOs</span><span class="token punctuation">(</span><span class="token class-name">String</span> os<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>os <span class="token operator">=</span> os<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getAr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> ar<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAr</span><span class="token punctuation">(</span><span class="token class-name">String</span> ar<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>ar <span class="token operator">=</span> ar<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getMd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> md<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMd</span><span class="token punctuation">(</span><span class="token class-name">String</span> md<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>md <span class="token operator">=</span> md<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getBa</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> ba<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBa</span><span class="token punctuation">(</span><span class="token class-name">String</span> ba<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>ba <span class="token operator">=</span> ba<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getSv</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> sv<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setSv</span><span class="token punctuation">(</span><span class="token class-name">String</span> sv<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>sv <span class="token operator">=</span> sv<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getG</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> g<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setG</span><span class="token punctuation">(</span><span class="token class-name">String</span> g<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>g <span class="token operator">=</span> g<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getHw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> hw<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setHw</span><span class="token punctuation">(</span><span class="token class-name">String</span> hw<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>hw <span class="token operator">=</span> hw<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getT</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> t<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setT</span><span class="token punctuation">(</span><span class="token class-name">String</span> t<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>t <span class="token operator">=</span> t<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getNw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> nw<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setNw</span><span class="token punctuation">(</span><span class="token class-name">String</span> nw<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>nw <span class="token operator">=</span> nw<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getLn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> ln<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setLn</span><span class="token punctuation">(</span><span class="token class-name">String</span> ln<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>ln <span class="token operator">=</span> ln<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getLa</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> la<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setLa</span><span class="token punctuation">(</span><span class="token class-name">String</span> la<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>la <span class="token operator">=</span> la<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="3-4-3-启动日志Bean"><a class="header-anchor" href="#3-4-3-启动日志Bean">¶</a>3.4.3 启动日志Bean</h3>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bean</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * 启动日志
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppStart</span> <span class="token keyword">extends</span> <span class="token class-name">AppBase</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> entry<span class="token punctuation">;</span><span class="token comment">//入口： push=1，widget=2，icon=3，notification=4, lockscreen_widget =5</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> open_ad_type<span class="token punctuation">;</span><span class="token comment">//开屏广告类型:  开屏原生广告=1, 开屏插屏广告=2</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> action<span class="token punctuation">;</span><span class="token comment">//状态：成功=1  失败=2</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> loading_time<span class="token punctuation">;</span><span class="token comment">//加载时长：计算下拉开始到接口返回数据的时间，（开始加载报0，加载成功或加载失败才上报时间）</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> detail<span class="token punctuation">;</span><span class="token comment">//失败码（没有则上报空）</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> extend1<span class="token punctuation">;</span><span class="token comment">//失败的message（没有则上报空）</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> en<span class="token punctuation">;</span><span class="token comment">//启动日志类型标记</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getEntry</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> entry<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setEntry</span><span class="token punctuation">(</span><span class="token class-name">String</span> entry<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>entry <span class="token operator">=</span> entry<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getOpen_ad_type</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> open_ad_type<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setOpen_ad_type</span><span class="token punctuation">(</span><span class="token class-name">String</span> open_ad_type<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>open_ad_type <span class="token operator">=</span> open_ad_type<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> action<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAction</span><span class="token punctuation">(</span><span class="token class-name">String</span> action<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>action <span class="token operator">=</span> action<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getLoading_time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> loading_time<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setLoading_time</span><span class="token punctuation">(</span><span class="token class-name">String</span> loading_time<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>loading_time <span class="token operator">=</span> loading_time<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getDetail</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> detail<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setDetail</span><span class="token punctuation">(</span><span class="token class-name">String</span> detail<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>detail <span class="token operator">=</span> detail<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getExtend1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> extend1<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setExtend1</span><span class="token punctuation">(</span><span class="token class-name">String</span> extend1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>extend1 <span class="token operator">=</span> extend1<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getEn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> en<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setEn</span><span class="token punctuation">(</span><span class="token class-name">String</span> en<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>en <span class="token operator">=</span> en<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="3-4-3-错误日志Bean"><a class="header-anchor" href="#3-4-3-错误日志Bean">¶</a>3.4.3 错误日志Bean</h3>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bean</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * 错误日志
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppErrorLog</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> errorBrief<span class="token punctuation">;</span>    <span class="token comment">//错误摘要</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> errorDetail<span class="token punctuation">;</span>   <span class="token comment">//错误详情</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getErrorBrief</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> errorBrief<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setErrorBrief</span><span class="token punctuation">(</span><span class="token class-name">String</span> errorBrief<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>errorBrief <span class="token operator">=</span> errorBrief<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getErrorDetail</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> errorDetail<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setErrorDetail</span><span class="token punctuation">(</span><span class="token class-name">String</span> errorDetail<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>errorDetail <span class="token operator">=</span> errorDetail<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="3-4-4-事件日志Bean之商品点击"><a class="header-anchor" href="#3-4-4-事件日志Bean之商品点击">¶</a>3.4.4 事件日志Bean之商品点击</h3>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bean</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * 商品点击日志
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppDisplay</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> action<span class="token punctuation">;</span><span class="token comment">//动作：曝光商品=1，点击商品=2，</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> goodsid<span class="token punctuation">;</span><span class="token comment">//商品ID（服务端下发的ID）</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> place<span class="token punctuation">;</span><span class="token comment">//顺序（第几条商品，第一条为0，第二条为1，如此类推）</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> extend1<span class="token punctuation">;</span><span class="token comment">//曝光类型：1 - 首次曝光 2-重复曝光（没有使用）</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> category<span class="token punctuation">;</span><span class="token comment">//分类ID（服务端定义的分类ID）</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> action<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAction</span><span class="token punctuation">(</span><span class="token class-name">String</span> action<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>action <span class="token operator">=</span> action<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getGoodsid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> goodsid<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setGoodsid</span><span class="token punctuation">(</span><span class="token class-name">String</span> goodsid<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>goodsid <span class="token operator">=</span> goodsid<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getPlace</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> place<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPlace</span><span class="token punctuation">(</span><span class="token class-name">String</span> place<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>place <span class="token operator">=</span> place<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getExtend1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> extend1<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setExtend1</span><span class="token punctuation">(</span><span class="token class-name">String</span> extend1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>extend1 <span class="token operator">=</span> extend1<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getCategory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> category<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setCategory</span><span class="token punctuation">(</span><span class="token class-name">String</span> category<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>category <span class="token operator">=</span> category<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="3-4-5-事件日志Bean之商品详情页"><a class="header-anchor" href="#3-4-5-事件日志Bean之商品详情页">¶</a>3.4.5 事件日志Bean之商品详情页</h3>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bean</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * 商品详情
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppNewsDetail</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> entry<span class="token punctuation">;</span><span class="token comment">//页面入口来源：应用首页=1、push=2、详情页相关推荐=3</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> action<span class="token punctuation">;</span><span class="token comment">//动作：开始加载=1，加载成功=2（pv），加载失败=3, 退出页面=4</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> goodsid<span class="token punctuation">;</span><span class="token comment">//商品ID（服务端下发的ID）</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> showtype<span class="token punctuation">;</span><span class="token comment">//商品样式：0、无图1、一张大图2、两张图3、三张小图4、一张小图5、一张大图两张小图    来源于详情页相关推荐的商品，上报样式都为0（因为都是左文右图）</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> news_staytime<span class="token punctuation">;</span><span class="token comment">//页面停留时长：从商品开始加载时开始计算，到用户关闭页面所用的时间。若中途用跳转到其它页面了，则暂停计时，待回到详情页时恢复计时。或中途划出的时间超过10分钟，则本次计时作废，不上报本次数据。如未加载成功退出，则报空。</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> loading_time<span class="token punctuation">;</span><span class="token comment">//加载时长：计算页面开始加载到接口返回数据的时间 （开始加载报0，加载成功或加载失败才上报时间）</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> type1<span class="token punctuation">;</span><span class="token comment">//加载失败码：把加载失败状态码报回来（报空为加载成功，没有失败）</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> category<span class="token punctuation">;</span><span class="token comment">//分类ID（服务端定义的分类ID）</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getEntry</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> entry<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setEntry</span><span class="token punctuation">(</span><span class="token class-name">String</span> entry<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>entry <span class="token operator">=</span> entry<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> action<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAction</span><span class="token punctuation">(</span><span class="token class-name">String</span> action<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>action <span class="token operator">=</span> action<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getGoodsid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> goodsid<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setGoodsid</span><span class="token punctuation">(</span><span class="token class-name">String</span> goodsid<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>goodsid <span class="token operator">=</span> goodsid<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getShowtype</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> showtype<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setShowtype</span><span class="token punctuation">(</span><span class="token class-name">String</span> showtype<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>showtype <span class="token operator">=</span> showtype<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getNews_staytime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> news_staytime<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setNews_staytime</span><span class="token punctuation">(</span><span class="token class-name">String</span> news_staytime<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>news_staytime <span class="token operator">=</span> news_staytime<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getLoading_time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> loading_time<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setLoading_time</span><span class="token punctuation">(</span><span class="token class-name">String</span> loading_time<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>loading_time <span class="token operator">=</span> loading_time<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getType1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> type1<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setType1</span><span class="token punctuation">(</span><span class="token class-name">String</span> type1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>type1 <span class="token operator">=</span> type1<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getCategory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> category<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setCategory</span><span class="token punctuation">(</span><span class="token class-name">String</span> category<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>category <span class="token operator">=</span> category<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="3-4-6-事件日志Bean之商品列表页"><a class="header-anchor" href="#3-4-6-事件日志Bean之商品列表页">¶</a>3.4.6 事件日志Bean之商品列表页</h3>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bean</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * 商品列表
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppLoading</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> action<span class="token punctuation">;</span><span class="token comment">//动作：开始加载=1，加载成功=2，加载失败=3</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> loading_time<span class="token punctuation">;</span><span class="token comment">//加载时长：计算下拉开始到接口返回数据的时间，（开始加载报0，加载成功或加载失败才上报时间）</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> loading_way<span class="token punctuation">;</span><span class="token comment">//加载类型：1-读取缓存，2-从接口拉新数据   （加载成功才上报加载类型）</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> extend1<span class="token punctuation">;</span><span class="token comment">//扩展字段 Extend1</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> extend2<span class="token punctuation">;</span><span class="token comment">//扩展字段 Extend2</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> type<span class="token punctuation">;</span><span class="token comment">//加载类型：自动加载=1，用户下拽加载=2，底部加载=3（底部条触发点击底部提示条/点击返回顶部加载）</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> type1<span class="token punctuation">;</span><span class="token comment">//加载失败码：把加载失败状态码报回来（报空为加载成功，没有失败）</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> action<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAction</span><span class="token punctuation">(</span><span class="token class-name">String</span> action<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>action <span class="token operator">=</span> action<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getLoading_time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> loading_time<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setLoading_time</span><span class="token punctuation">(</span><span class="token class-name">String</span> loading_time<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>loading_time <span class="token operator">=</span> loading_time<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getLoading_way</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> loading_way<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setLoading_way</span><span class="token punctuation">(</span><span class="token class-name">String</span> loading_way<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>loading_way <span class="token operator">=</span> loading_way<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getExtend1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> extend1<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setExtend1</span><span class="token punctuation">(</span><span class="token class-name">String</span> extend1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>extend1 <span class="token operator">=</span> extend1<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getExtend2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> extend2<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setExtend2</span><span class="token punctuation">(</span><span class="token class-name">String</span> extend2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>extend2 <span class="token operator">=</span> extend2<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> type<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setType</span><span class="token punctuation">(</span><span class="token class-name">String</span> type<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> type<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getType1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> type1<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setType1</span><span class="token punctuation">(</span><span class="token class-name">String</span> type1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>type1 <span class="token operator">=</span> type1<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="3-4-7-事件日志Bean之广告"><a class="header-anchor" href="#3-4-7-事件日志Bean之广告">¶</a>3.4.7 事件日志Bean之广告</h3>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bean</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * 广告
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppAd</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> entry<span class="token punctuation">;</span><span class="token comment">//入口：商品列表页=1  应用首页=2 商品详情页=3</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> action<span class="token punctuation">;</span><span class="token comment">//动作：请求广告=1 取缓存广告=2  广告位展示=3 广告展示=4 广告点击=5</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> content<span class="token punctuation">;</span><span class="token comment">//状态：成功=1  失败=2</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> detail<span class="token punctuation">;</span><span class="token comment">//失败码（没有则上报空）</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> source<span class="token punctuation">;</span><span class="token comment">//广告来源:admob=1 facebook=2  ADX（百度）=3 VK（俄罗斯）=4</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> behavior<span class="token punctuation">;</span><span class="token comment">//用户行为：    主动获取广告=1    被动获取广告=2</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> newstype<span class="token punctuation">;</span><span class="token comment">//Type: 1- 图文 2-图集 3-段子 4-GIF 5-视频 6-调查 7-纯文 8-视频+图文  9-GIF+图文  0-其他</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> show_style<span class="token punctuation">;</span><span class="token comment">//内容样式：无图(纯文字)=6 一张大图=1  三站小图+文=4 一张小图=2 一张大图两张小图+文=3 图集+文 = 5</span>
                           <span class="token comment">//一张大图+文=11   GIF大图+文=12  视频(大图)+文 = 13</span>
                           <span class="token comment">//来源于详情页相关推荐的商品，上报样式都为0（因为都是左文右图）</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getEntry</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> entry<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setEntry</span><span class="token punctuation">(</span><span class="token class-name">String</span> entry<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>entry <span class="token operator">=</span> entry<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> action<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAction</span><span class="token punctuation">(</span><span class="token class-name">String</span> action<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>action <span class="token operator">=</span> action<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> content<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setContent</span><span class="token punctuation">(</span><span class="token class-name">String</span> content<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> content<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getDetail</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> detail<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setDetail</span><span class="token punctuation">(</span><span class="token class-name">String</span> detail<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>detail <span class="token operator">=</span> detail<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> source<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setSource</span><span class="token punctuation">(</span><span class="token class-name">String</span> source<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>source <span class="token operator">=</span> source<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getBehavior</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> behavior<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBehavior</span><span class="token punctuation">(</span><span class="token class-name">String</span> behavior<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>behavior <span class="token operator">=</span> behavior<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getNewstype</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> newstype<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setNewstype</span><span class="token punctuation">(</span><span class="token class-name">String</span> newstype<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>newstype <span class="token operator">=</span> newstype<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getShow_style</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> show_style<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setShow_style</span><span class="token punctuation">(</span><span class="token class-name">String</span> show_style<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>show_style <span class="token operator">=</span> show_style<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="3-4-8-事件日志Bean之消息通知"><a class="header-anchor" href="#3-4-8-事件日志Bean之消息通知">¶</a>3.4.8 事件日志Bean之消息通知</h3>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bean</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * 消息通知日志
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppNotification</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> action<span class="token punctuation">;</span><span class="token comment">//动作：通知产生=1，通知弹出=2，通知点击=3，常驻通知展示（不重复上报，一天之内只报一次）=4</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> type<span class="token punctuation">;</span><span class="token comment">//通知id：预警通知=1，天气预报（早=2，晚=3），常驻=4</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> ap_time<span class="token punctuation">;</span><span class="token comment">//客户端弹出时间</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> content<span class="token punctuation">;</span><span class="token comment">//备用字段</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> action<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAction</span><span class="token punctuation">(</span><span class="token class-name">String</span> action<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>action <span class="token operator">=</span> action<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> type<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setType</span><span class="token punctuation">(</span><span class="token class-name">String</span> type<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> type<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getAp_time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> ap_time<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAp_time</span><span class="token punctuation">(</span><span class="token class-name">String</span> ap_time<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>ap_time <span class="token operator">=</span> ap_time<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> content<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setContent</span><span class="token punctuation">(</span><span class="token class-name">String</span> content<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> content<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="3-4-9-事件日志Bean之用户前台活跃"><a class="header-anchor" href="#3-4-9-事件日志Bean之用户前台活跃">¶</a>3.4.9 事件日志Bean之用户前台活跃</h3>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bean</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * 用户前台活跃
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppActive_foreground</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> push_id<span class="token punctuation">;</span><span class="token comment">//推送的消息的id，如果不是从推送消息打开，传空</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> access<span class="token punctuation">;</span><span class="token comment">//1.push 2.icon 3.其他</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getPush_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> push_id<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPush_id</span><span class="token punctuation">(</span><span class="token class-name">String</span> push_id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>push_id <span class="token operator">=</span> push_id<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getAccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> access<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAccess</span><span class="token punctuation">(</span><span class="token class-name">String</span> access<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>access <span class="token operator">=</span> access<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="3-4-10-事件日志Bean之用户后台活跃"><a class="header-anchor" href="#3-4-10-事件日志Bean之用户后台活跃">¶</a>3.4.10 事件日志Bean之用户后台活跃</h3>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bean</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * 用户后台活跃
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppActive_background</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> active_source<span class="token punctuation">;</span><span class="token comment">//1=upgrade,2=download(下载),3=plugin_upgrade</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getActive_source</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> active_source<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setActive_source</span><span class="token punctuation">(</span><span class="token class-name">String</span> active_source<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>active_source <span class="token operator">=</span> active_source<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="3-4-11-事件日志Bean之用户评论"><a class="header-anchor" href="#3-4-11-事件日志Bean之用户评论">¶</a>3.4.11 事件日志Bean之用户评论</h3>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bean</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * 评论
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppComment</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">private</span> <span class="token keyword">int</span> comment_id<span class="token punctuation">;</span><span class="token comment">//评论表</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> userid<span class="token punctuation">;</span><span class="token comment">//用户id</span>
    <span class="token keyword">private</span>  <span class="token keyword">int</span> p_comment_id<span class="token punctuation">;</span><span class="token comment">//父级评论id(为0则是一级评论,不为0则是回复)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> content<span class="token punctuation">;</span><span class="token comment">//评论内容</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> addtime<span class="token punctuation">;</span><span class="token comment">//创建时间</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> other_id<span class="token punctuation">;</span><span class="token comment">//评论的相关id</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> praise_count<span class="token punctuation">;</span><span class="token comment">//点赞数量</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> reply_count<span class="token punctuation">;</span><span class="token comment">//回复数量</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getComment_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> comment_id<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setComment_id</span><span class="token punctuation">(</span><span class="token keyword">int</span> comment_id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>comment_id <span class="token operator">=</span> comment_id<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getUserid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> userid<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUserid</span><span class="token punctuation">(</span><span class="token keyword">int</span> userid<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>userid <span class="token operator">=</span> userid<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getP_comment_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> p_comment_id<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setP_comment_id</span><span class="token punctuation">(</span><span class="token keyword">int</span> p_comment_id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>p_comment_id <span class="token operator">=</span> p_comment_id<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> content<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setContent</span><span class="token punctuation">(</span><span class="token class-name">String</span> content<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> content<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getAddtime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> addtime<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAddtime</span><span class="token punctuation">(</span><span class="token class-name">String</span> addtime<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>addtime <span class="token operator">=</span> addtime<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getOther_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> other_id<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setOther_id</span><span class="token punctuation">(</span><span class="token keyword">int</span> other_id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>other_id <span class="token operator">=</span> other_id<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getPraise_count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> praise_count<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPraise_count</span><span class="token punctuation">(</span><span class="token keyword">int</span> praise_count<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>praise_count <span class="token operator">=</span> praise_count<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getReply_count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> reply_count<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setReply_count</span><span class="token punctuation">(</span><span class="token keyword">int</span> reply_count<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>reply_count <span class="token operator">=</span> reply_count<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="3-4-12-事件日志Bean之用户收藏"><a class="header-anchor" href="#3-4-12-事件日志Bean之用户收藏">¶</a>3.4.12 事件日志Bean之用户收藏</h3>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bean</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * 收藏
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppFavorites</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span><span class="token comment">//主键</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> course_id<span class="token punctuation">;</span><span class="token comment">//商品id</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> userid<span class="token punctuation">;</span><span class="token comment">//用户ID</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> add_time<span class="token punctuation">;</span><span class="token comment">//创建时间</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setId</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getCourse_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> course_id<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setCourse_id</span><span class="token punctuation">(</span><span class="token keyword">int</span> course_id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>course_id <span class="token operator">=</span> course_id<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getUserid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> userid<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUserid</span><span class="token punctuation">(</span><span class="token keyword">int</span> userid<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>userid <span class="token operator">=</span> userid<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getAdd_time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> add_time<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAdd_time</span><span class="token punctuation">(</span><span class="token class-name">String</span> add_time<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>add_time <span class="token operator">=</span> add_time<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="3-4-13-事件日志Bean之用户点赞"><a class="header-anchor" href="#3-4-13-事件日志Bean之用户点赞">¶</a>3.4.13 事件日志Bean之用户点赞</h3>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bean</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * 点赞
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppPraise</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span> <span class="token comment">//主键id</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> userid<span class="token punctuation">;</span><span class="token comment">//用户id</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> target_id<span class="token punctuation">;</span><span class="token comment">//点赞的对象id</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> type<span class="token punctuation">;</span><span class="token comment">//点赞类型 1问答点赞 2问答评论点赞 3 文章点赞数4 评论点赞</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> add_time<span class="token punctuation">;</span><span class="token comment">//添加时间</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setId</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getUserid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> userid<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUserid</span><span class="token punctuation">(</span><span class="token keyword">int</span> userid<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>userid <span class="token operator">=</span> userid<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getTarget_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> target_id<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTarget_id</span><span class="token punctuation">(</span><span class="token keyword">int</span> target_id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>target_id <span class="token operator">=</span> target_id<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> type<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setType</span><span class="token punctuation">(</span><span class="token keyword">int</span> type<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> type<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getAdd_time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> add_time<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAdd_time</span><span class="token punctuation">(</span><span class="token class-name">String</span> add_time<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>add_time <span class="token operator">=</span> add_time<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="3-4-14-主函数"><a class="header-anchor" href="#3-4-14-主函数">¶</a>3.4.14 主函数</h3>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307185810371.png" class="" title="image-20210307185810371" loading="lazy">
<p>在AppMain类中添加如下内容：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>appclient</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">UnsupportedEncodingException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Random</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span>JSON<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span><span class="token class-name">JSONArray</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span><span class="token class-name">JSONObject</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bean<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 日志行为数据模拟
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppMain</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">AppMain</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Random</span> rand <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 设备id</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> s_mid <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">// 用户id</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> s_uid <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">// 商品id</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> s_goodsid <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token comment">// 参数一：控制发送每条的延时时间，默认是0</span>
        <span class="token class-name">Long</span> delay <span class="token operator">=</span> args<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token function">parseLong</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0L</span><span class="token punctuation">;</span>

        <span class="token comment">// 参数二：循环遍历次数</span>
        <span class="token keyword">int</span> loop_len <span class="token operator">=</span> args<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">;</span>

        <span class="token comment">// 生成数据</span>
        <span class="token function">generateLog</span><span class="token punctuation">(</span>delay<span class="token punctuation">,</span> loop_len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">generateLog</span><span class="token punctuation">(</span><span class="token class-name">Long</span> delay<span class="token punctuation">,</span> <span class="token keyword">int</span> loop_len<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> loop_len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

            <span class="token keyword">int</span> flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">switch</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">case</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">:</span>
                    <span class="token comment">//应用启动</span>
                    <span class="token class-name">AppStart</span> appStart <span class="token operator">=</span> <span class="token function">generateStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name">String</span> jsonString <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>appStart<span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">//控制台打印</span>
                    logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>jsonString<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>

                <span class="token keyword">case</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">:</span>

                    <span class="token class-name">JSONObject</span> json <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    json<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"ap"</span><span class="token punctuation">,</span> <span class="token string">"app"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    json<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"cm"</span><span class="token punctuation">,</span> <span class="token function">generateComFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token class-name">JSONArray</span> eventsArray <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// 事件日志</span>
                    <span class="token comment">// 商品点击，展示</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextBoolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        eventsArray<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">generateDisplay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        json<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"et"</span><span class="token punctuation">,</span> eventsArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>

                    <span class="token comment">// 商品详情页</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextBoolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        eventsArray<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">generateNewsDetail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        json<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"et"</span><span class="token punctuation">,</span> eventsArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>

                    <span class="token comment">// 商品列表页</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextBoolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        eventsArray<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">generateNewList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        json<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"et"</span><span class="token punctuation">,</span> eventsArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>

                    <span class="token comment">// 广告</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextBoolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        eventsArray<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">generateAd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        json<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"et"</span><span class="token punctuation">,</span> eventsArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>

                    <span class="token comment">// 消息通知</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextBoolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        eventsArray<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">generateNotification</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        json<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"et"</span><span class="token punctuation">,</span> eventsArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>

                    <span class="token comment">// 用户前台活跃</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextBoolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        eventsArray<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">generatbeforeground</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        json<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"et"</span><span class="token punctuation">,</span> eventsArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>

                    <span class="token comment">// 用户后台活跃</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextBoolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        eventsArray<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">generateBackground</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        json<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"et"</span><span class="token punctuation">,</span> eventsArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>

                    <span class="token comment">//故障日志</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextBoolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        eventsArray<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">generateError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        json<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"et"</span><span class="token punctuation">,</span> eventsArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>

                    <span class="token comment">// 用户评论</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextBoolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        eventsArray<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">generateComment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        json<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"et"</span><span class="token punctuation">,</span> eventsArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>

                    <span class="token comment">// 用户收藏</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextBoolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        eventsArray<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">generateFavorites</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        json<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"et"</span><span class="token punctuation">,</span> eventsArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>

                    <span class="token comment">// 用户点赞</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextBoolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        eventsArray<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">generatePraise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        json<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"et"</span><span class="token punctuation">,</span> eventsArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>

                    <span class="token comment">//时间</span>
                    <span class="token keyword">long</span> millis <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">//控制台打印</span>
                    logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>millis <span class="token operator">+</span> <span class="token string">"|"</span> <span class="token operator">+</span> json<span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>

            <span class="token comment">// 延迟</span>
            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span>delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * 公共字段设置
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">JSONObject</span> <span class="token function">generateComFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token class-name">AppBase</span> appBase <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AppBase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//设备id</span>
        appBase<span class="token punctuation">.</span><span class="token function">setMid</span><span class="token punctuation">(</span>s_mid <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        s_mid<span class="token operator">++</span><span class="token punctuation">;</span>

        <span class="token comment">// 用户id</span>
        appBase<span class="token punctuation">.</span><span class="token function">setUid</span><span class="token punctuation">(</span>s_uid <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        s_uid<span class="token operator">++</span><span class="token punctuation">;</span>

        <span class="token comment">// 程序版本号 5,6等</span>
        appBase<span class="token punctuation">.</span><span class="token function">setVc</span><span class="token punctuation">(</span><span class="token string">""</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//程序版本名 v1.1.1</span>
        appBase<span class="token punctuation">.</span><span class="token function">setVn</span><span class="token punctuation">(</span><span class="token string">"1."</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"."</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 安卓系统版本</span>
        appBase<span class="token punctuation">.</span><span class="token function">setOs</span><span class="token punctuation">(</span><span class="token string">"8."</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"."</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 语言  es,en,pt</span>
        <span class="token keyword">int</span> flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">case</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">:</span>
                appBase<span class="token punctuation">.</span><span class="token function">setL</span><span class="token punctuation">(</span><span class="token string">"es"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">:</span>
                appBase<span class="token punctuation">.</span><span class="token function">setL</span><span class="token punctuation">(</span><span class="token string">"en"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">:</span>
                appBase<span class="token punctuation">.</span><span class="token function">setL</span><span class="token punctuation">(</span><span class="token string">"pt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// 渠道号   从哪个渠道来的</span>
        appBase<span class="token punctuation">.</span><span class="token function">setSr</span><span class="token punctuation">(</span><span class="token function">getRandomChar</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 区域</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
                appBase<span class="token punctuation">.</span><span class="token function">setAr</span><span class="token punctuation">(</span><span class="token string">"BR"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
                appBase<span class="token punctuation">.</span><span class="token function">setAr</span><span class="token punctuation">(</span><span class="token string">"MX"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// 手机品牌 ba ,手机型号 md，就取2位数字了</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
                appBase<span class="token punctuation">.</span><span class="token function">setBa</span><span class="token punctuation">(</span><span class="token string">"Sumsung"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                appBase<span class="token punctuation">.</span><span class="token function">setMd</span><span class="token punctuation">(</span><span class="token string">"sumsung-"</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
                appBase<span class="token punctuation">.</span><span class="token function">setBa</span><span class="token punctuation">(</span><span class="token string">"Huawei"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                appBase<span class="token punctuation">.</span><span class="token function">setMd</span><span class="token punctuation">(</span><span class="token string">"Huawei-"</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
                appBase<span class="token punctuation">.</span><span class="token function">setBa</span><span class="token punctuation">(</span><span class="token string">"HTC"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                appBase<span class="token punctuation">.</span><span class="token function">setMd</span><span class="token punctuation">(</span><span class="token string">"HTC-"</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// 嵌入sdk的版本</span>
        appBase<span class="token punctuation">.</span><span class="token function">setSv</span><span class="token punctuation">(</span><span class="token string">"V2."</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"."</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// gmail</span>
        appBase<span class="token punctuation">.</span><span class="token function">setG</span><span class="token punctuation">(</span><span class="token function">getRandomCharAndNumr</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"@gmail.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 屏幕宽高 hw</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
                appBase<span class="token punctuation">.</span><span class="token function">setHw</span><span class="token punctuation">(</span><span class="token string">"640*960"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
                appBase<span class="token punctuation">.</span><span class="token function">setHw</span><span class="token punctuation">(</span><span class="token string">"640*1136"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
                appBase<span class="token punctuation">.</span><span class="token function">setHw</span><span class="token punctuation">(</span><span class="token string">"750*1134"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>
                appBase<span class="token punctuation">.</span><span class="token function">setHw</span><span class="token punctuation">(</span><span class="token string">"1080*1920"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// 客户端产生日志时间</span>
        <span class="token keyword">long</span> millis <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        appBase<span class="token punctuation">.</span><span class="token function">setT</span><span class="token punctuation">(</span><span class="token string">""</span> <span class="token operator">+</span> <span class="token punctuation">(</span>millis <span class="token operator">-</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">99999999</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 手机网络模式 3G,4G,WIFI</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
                appBase<span class="token punctuation">.</span><span class="token function">setNw</span><span class="token punctuation">(</span><span class="token string">"3G"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
                appBase<span class="token punctuation">.</span><span class="token function">setNw</span><span class="token punctuation">(</span><span class="token string">"4G"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
                appBase<span class="token punctuation">.</span><span class="token function">setNw</span><span class="token punctuation">(</span><span class="token string">"WIFI"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// 拉丁美洲 西经34°46′至西经117°09；北纬32°42′至南纬53°54′</span>
        <span class="token comment">// 经度</span>
        appBase<span class="token punctuation">.</span><span class="token function">setLn</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">34</span> <span class="token operator">-</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">83</span><span class="token punctuation">)</span> <span class="token operator">-</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">10.0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 纬度</span>
        appBase<span class="token punctuation">.</span><span class="token function">setLa</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">-</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">85</span><span class="token punctuation">)</span> <span class="token operator">-</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">10.0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">JSONObject</span><span class="token punctuation">)</span> JSON<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span>appBase<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * 商品展示事件
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">JSONObject</span> <span class="token function">generateDisplay</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token class-name">AppDisplay</span> appDisplay <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AppDisplay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">boolean</span> boolFlag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">7</span><span class="token punctuation">;</span>

        <span class="token comment">// 动作：曝光商品=1，点击商品=2，</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>boolFlag<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            appDisplay<span class="token punctuation">.</span><span class="token function">setAction</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            appDisplay<span class="token punctuation">.</span><span class="token function">setAction</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// 商品id</span>
        <span class="token class-name">String</span> goodsId <span class="token operator">=</span> s_goodsid <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">;</span>
        s_goodsid<span class="token operator">++</span><span class="token punctuation">;</span>

        appDisplay<span class="token punctuation">.</span><span class="token function">setGoodsid</span><span class="token punctuation">(</span>goodsId<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 顺序  设置成6条吧</span>
        <span class="token keyword">int</span> flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        appDisplay<span class="token punctuation">.</span><span class="token function">setPlace</span><span class="token punctuation">(</span><span class="token string">""</span> <span class="token operator">+</span> flag<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 曝光类型</span>
        flag <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        appDisplay<span class="token punctuation">.</span><span class="token function">setExtend1</span><span class="token punctuation">(</span><span class="token string">""</span> <span class="token operator">+</span> flag<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 分类</span>
        flag <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        appDisplay<span class="token punctuation">.</span><span class="token function">setCategory</span><span class="token punctuation">(</span><span class="token string">""</span> <span class="token operator">+</span> flag<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">JSONObject</span> jsonObject <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">JSONObject</span><span class="token punctuation">)</span> JSON<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span>appDisplay<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token function">packEventJson</span><span class="token punctuation">(</span><span class="token string">"display"</span><span class="token punctuation">,</span> jsonObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * 商品详情页
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">JSONObject</span> <span class="token function">generateNewsDetail</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token class-name">AppNewsDetail</span> appNewsDetail <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AppNewsDetail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 页面入口来源</span>
        <span class="token keyword">int</span> flag <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        appNewsDetail<span class="token punctuation">.</span><span class="token function">setEntry</span><span class="token punctuation">(</span>flag <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 动作</span>
        appNewsDetail<span class="token punctuation">.</span><span class="token function">setAction</span><span class="token punctuation">(</span><span class="token string">""</span> <span class="token operator">+</span> <span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 商品id</span>
        appNewsDetail<span class="token punctuation">.</span><span class="token function">setGoodsid</span><span class="token punctuation">(</span>s_goodsid <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 商品来源类型</span>
        flag <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        appNewsDetail<span class="token punctuation">.</span><span class="token function">setShowtype</span><span class="token punctuation">(</span>flag <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 商品样式</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        appNewsDetail<span class="token punctuation">.</span><span class="token function">setShowtype</span><span class="token punctuation">(</span><span class="token string">""</span> <span class="token operator">+</span> flag<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 页面停留时长</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">*</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        appNewsDetail<span class="token punctuation">.</span><span class="token function">setNews_staytime</span><span class="token punctuation">(</span>flag <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 加载时长</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">*</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        appNewsDetail<span class="token punctuation">.</span><span class="token function">setLoading_time</span><span class="token punctuation">(</span>flag <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 加载失败码</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
                appNewsDetail<span class="token punctuation">.</span><span class="token function">setType1</span><span class="token punctuation">(</span><span class="token string">"102"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
                appNewsDetail<span class="token punctuation">.</span><span class="token function">setType1</span><span class="token punctuation">(</span><span class="token string">"201"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>
                appNewsDetail<span class="token punctuation">.</span><span class="token function">setType1</span><span class="token punctuation">(</span><span class="token string">"325"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span>
                appNewsDetail<span class="token punctuation">.</span><span class="token function">setType1</span><span class="token punctuation">(</span><span class="token string">"433"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span>
                appNewsDetail<span class="token punctuation">.</span><span class="token function">setType1</span><span class="token punctuation">(</span><span class="token string">"542"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">default</span><span class="token operator">:</span>
                appNewsDetail<span class="token punctuation">.</span><span class="token function">setType1</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// 分类</span>
        flag <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        appNewsDetail<span class="token punctuation">.</span><span class="token function">setCategory</span><span class="token punctuation">(</span><span class="token string">""</span> <span class="token operator">+</span> flag<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">JSONObject</span> eventJson <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">JSONObject</span><span class="token punctuation">)</span> JSON<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span>appNewsDetail<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token function">packEventJson</span><span class="token punctuation">(</span><span class="token string">"newsdetail"</span><span class="token punctuation">,</span> eventJson<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * 商品列表
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">JSONObject</span> <span class="token function">generateNewList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token class-name">AppLoading</span> appLoading <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AppLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 动作</span>
        <span class="token keyword">int</span> flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        appLoading<span class="token punctuation">.</span><span class="token function">setAction</span><span class="token punctuation">(</span>flag <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 加载时长</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">*</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        appLoading<span class="token punctuation">.</span><span class="token function">setLoading_time</span><span class="token punctuation">(</span>flag <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 失败码</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
                appLoading<span class="token punctuation">.</span><span class="token function">setType1</span><span class="token punctuation">(</span><span class="token string">"102"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
                appLoading<span class="token punctuation">.</span><span class="token function">setType1</span><span class="token punctuation">(</span><span class="token string">"201"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>
                appLoading<span class="token punctuation">.</span><span class="token function">setType1</span><span class="token punctuation">(</span><span class="token string">"325"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span>
                appLoading<span class="token punctuation">.</span><span class="token function">setType1</span><span class="token punctuation">(</span><span class="token string">"433"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span>
                appLoading<span class="token punctuation">.</span><span class="token function">setType1</span><span class="token punctuation">(</span><span class="token string">"542"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">default</span><span class="token operator">:</span>
                appLoading<span class="token punctuation">.</span><span class="token function">setType1</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// 页面  加载类型</span>
        flag <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        appLoading<span class="token punctuation">.</span><span class="token function">setLoading_way</span><span class="token punctuation">(</span><span class="token string">""</span> <span class="token operator">+</span> flag<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 扩展字段1</span>
        appLoading<span class="token punctuation">.</span><span class="token function">setExtend1</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 扩展字段2</span>
        appLoading<span class="token punctuation">.</span><span class="token function">setExtend2</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 用户加载类型</span>
        flag <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        appLoading<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token string">""</span> <span class="token operator">+</span> flag<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">JSONObject</span> jsonObject <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">JSONObject</span><span class="token punctuation">)</span> JSON<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span>appLoading<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token function">packEventJson</span><span class="token punctuation">(</span><span class="token string">"loading"</span><span class="token punctuation">,</span> jsonObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * 广告相关字段
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">JSONObject</span> <span class="token function">generateAd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token class-name">AppAd</span> appAd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AppAd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 入口</span>
        <span class="token keyword">int</span> flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        appAd<span class="token punctuation">.</span><span class="token function">setEntry</span><span class="token punctuation">(</span>flag <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 动作</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        appAd<span class="token punctuation">.</span><span class="token function">setAction</span><span class="token punctuation">(</span>flag <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 状态</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">6</span> <span class="token operator">?</span> <span class="token number">2</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
        appAd<span class="token punctuation">.</span><span class="token function">setContent</span><span class="token punctuation">(</span>flag <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 失败码</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
                appAd<span class="token punctuation">.</span><span class="token function">setDetail</span><span class="token punctuation">(</span><span class="token string">"102"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
                appAd<span class="token punctuation">.</span><span class="token function">setDetail</span><span class="token punctuation">(</span><span class="token string">"201"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>
                appAd<span class="token punctuation">.</span><span class="token function">setDetail</span><span class="token punctuation">(</span><span class="token string">"325"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span>
                appAd<span class="token punctuation">.</span><span class="token function">setDetail</span><span class="token punctuation">(</span><span class="token string">"433"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span>
                appAd<span class="token punctuation">.</span><span class="token function">setDetail</span><span class="token punctuation">(</span><span class="token string">"542"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">default</span><span class="token operator">:</span>
                appAd<span class="token punctuation">.</span><span class="token function">setDetail</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// 广告来源</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        appAd<span class="token punctuation">.</span><span class="token function">setSource</span><span class="token punctuation">(</span>flag <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 用户行为</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        appAd<span class="token punctuation">.</span><span class="token function">setBehavior</span><span class="token punctuation">(</span>flag <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 商品类型</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        appAd<span class="token punctuation">.</span><span class="token function">setNewstype</span><span class="token punctuation">(</span><span class="token string">""</span> <span class="token operator">+</span> flag<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 展示样式</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        appAd<span class="token punctuation">.</span><span class="token function">setShow_style</span><span class="token punctuation">(</span><span class="token string">""</span> <span class="token operator">+</span> flag<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">JSONObject</span> jsonObject <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">JSONObject</span><span class="token punctuation">)</span> JSON<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span>appAd<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token function">packEventJson</span><span class="token punctuation">(</span><span class="token string">"ad"</span><span class="token punctuation">,</span> jsonObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * 启动日志
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">AppStart</span> <span class="token function">generateStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token class-name">AppStart</span> appStart <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AppStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//设备id</span>
        appStart<span class="token punctuation">.</span><span class="token function">setMid</span><span class="token punctuation">(</span>s_mid <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        s_mid<span class="token operator">++</span><span class="token punctuation">;</span>

        <span class="token comment">// 用户id</span>
        appStart<span class="token punctuation">.</span><span class="token function">setUid</span><span class="token punctuation">(</span>s_uid <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        s_uid<span class="token operator">++</span><span class="token punctuation">;</span>

        <span class="token comment">// 程序版本号 5,6等</span>
        appStart<span class="token punctuation">.</span><span class="token function">setVc</span><span class="token punctuation">(</span><span class="token string">""</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//程序版本名 v1.1.1</span>
        appStart<span class="token punctuation">.</span><span class="token function">setVn</span><span class="token punctuation">(</span><span class="token string">"1."</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"."</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 安卓系统版本</span>
        appStart<span class="token punctuation">.</span><span class="token function">setOs</span><span class="token punctuation">(</span><span class="token string">"8."</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"."</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//设置日志类型</span>
        appStart<span class="token punctuation">.</span><span class="token function">setEn</span><span class="token punctuation">(</span><span class="token string">"start"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//    语言  es,en,pt</span>
        <span class="token keyword">int</span> flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">case</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">:</span>
                appStart<span class="token punctuation">.</span><span class="token function">setL</span><span class="token punctuation">(</span><span class="token string">"es"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">:</span>
                appStart<span class="token punctuation">.</span><span class="token function">setL</span><span class="token punctuation">(</span><span class="token string">"en"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">:</span>
                appStart<span class="token punctuation">.</span><span class="token function">setL</span><span class="token punctuation">(</span><span class="token string">"pt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// 渠道号   从哪个渠道来的</span>
        appStart<span class="token punctuation">.</span><span class="token function">setSr</span><span class="token punctuation">(</span><span class="token function">getRandomChar</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 区域</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
                appStart<span class="token punctuation">.</span><span class="token function">setAr</span><span class="token punctuation">(</span><span class="token string">"BR"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
                appStart<span class="token punctuation">.</span><span class="token function">setAr</span><span class="token punctuation">(</span><span class="token string">"MX"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// 手机品牌 ba ,手机型号 md，就取2位数字了</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
                appStart<span class="token punctuation">.</span><span class="token function">setBa</span><span class="token punctuation">(</span><span class="token string">"Sumsung"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                appStart<span class="token punctuation">.</span><span class="token function">setMd</span><span class="token punctuation">(</span><span class="token string">"sumsung-"</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
                appStart<span class="token punctuation">.</span><span class="token function">setBa</span><span class="token punctuation">(</span><span class="token string">"Huawei"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                appStart<span class="token punctuation">.</span><span class="token function">setMd</span><span class="token punctuation">(</span><span class="token string">"Huawei-"</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
                appStart<span class="token punctuation">.</span><span class="token function">setBa</span><span class="token punctuation">(</span><span class="token string">"HTC"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                appStart<span class="token punctuation">.</span><span class="token function">setMd</span><span class="token punctuation">(</span><span class="token string">"HTC-"</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// 嵌入sdk的版本</span>
        appStart<span class="token punctuation">.</span><span class="token function">setSv</span><span class="token punctuation">(</span><span class="token string">"V2."</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"."</span> <span class="token operator">+</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// gmail</span>
        appStart<span class="token punctuation">.</span><span class="token function">setG</span><span class="token punctuation">(</span><span class="token function">getRandomCharAndNumr</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"@gmail.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 屏幕宽高 hw</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
                appStart<span class="token punctuation">.</span><span class="token function">setHw</span><span class="token punctuation">(</span><span class="token string">"640*960"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
                appStart<span class="token punctuation">.</span><span class="token function">setHw</span><span class="token punctuation">(</span><span class="token string">"640*1136"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
                appStart<span class="token punctuation">.</span><span class="token function">setHw</span><span class="token punctuation">(</span><span class="token string">"750*1134"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>
                appStart<span class="token punctuation">.</span><span class="token function">setHw</span><span class="token punctuation">(</span><span class="token string">"1080*1920"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// 客户端产生日志时间</span>
        <span class="token keyword">long</span> millis <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        appStart<span class="token punctuation">.</span><span class="token function">setT</span><span class="token punctuation">(</span><span class="token string">""</span> <span class="token operator">+</span> <span class="token punctuation">(</span>millis <span class="token operator">-</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">99999999</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 手机网络模式 3G,4G,WIFI</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
                appStart<span class="token punctuation">.</span><span class="token function">setNw</span><span class="token punctuation">(</span><span class="token string">"3G"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
                appStart<span class="token punctuation">.</span><span class="token function">setNw</span><span class="token punctuation">(</span><span class="token string">"4G"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
                appStart<span class="token punctuation">.</span><span class="token function">setNw</span><span class="token punctuation">(</span><span class="token string">"WIFI"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// 拉丁美洲 西经34°46′至西经117°09；北纬32°42′至南纬53°54′</span>
        <span class="token comment">// 经度</span>
        appStart<span class="token punctuation">.</span><span class="token function">setLn</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">34</span> <span class="token operator">-</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">83</span><span class="token punctuation">)</span> <span class="token operator">-</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">10.0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 纬度</span>
        appStart<span class="token punctuation">.</span><span class="token function">setLa</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">-</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">85</span><span class="token punctuation">)</span> <span class="token operator">-</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">10.0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 入口</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        appStart<span class="token punctuation">.</span><span class="token function">setEntry</span><span class="token punctuation">(</span>flag <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 开屏广告类型</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        appStart<span class="token punctuation">.</span><span class="token function">setOpen_ad_type</span><span class="token punctuation">(</span>flag <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 状态</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">8</span> <span class="token operator">?</span> <span class="token number">2</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
        appStart<span class="token punctuation">.</span><span class="token function">setAction</span><span class="token punctuation">(</span>flag <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 加载时长</span>
        appStart<span class="token punctuation">.</span><span class="token function">setLoading_time</span><span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 失败码</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
                appStart<span class="token punctuation">.</span><span class="token function">setDetail</span><span class="token punctuation">(</span><span class="token string">"102"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
                appStart<span class="token punctuation">.</span><span class="token function">setDetail</span><span class="token punctuation">(</span><span class="token string">"201"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>
                appStart<span class="token punctuation">.</span><span class="token function">setDetail</span><span class="token punctuation">(</span><span class="token string">"325"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span>
                appStart<span class="token punctuation">.</span><span class="token function">setDetail</span><span class="token punctuation">(</span><span class="token string">"433"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span>
                appStart<span class="token punctuation">.</span><span class="token function">setDetail</span><span class="token punctuation">(</span><span class="token string">"542"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">default</span><span class="token operator">:</span>
                appStart<span class="token punctuation">.</span><span class="token function">setDetail</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// 扩展字段</span>
        appStart<span class="token punctuation">.</span><span class="token function">setExtend1</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> appStart<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">/**
     * 消息通知
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">JSONObject</span> <span class="token function">generateNotification</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token class-name">AppNotification</span> appNotification <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AppNotification</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">int</span> flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>

        <span class="token comment">// 动作</span>
        appNotification<span class="token punctuation">.</span><span class="token function">setAction</span><span class="token punctuation">(</span>flag <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 通知id</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        appNotification<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span>flag <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 客户端弹时间</span>
        appNotification<span class="token punctuation">.</span><span class="token function">setAp_time</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">99999999</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 备用字段</span>
        appNotification<span class="token punctuation">.</span><span class="token function">setContent</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">JSONObject</span> jsonObject <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">JSONObject</span><span class="token punctuation">)</span> JSON<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span>appNotification<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token function">packEventJson</span><span class="token punctuation">(</span><span class="token string">"notification"</span><span class="token punctuation">,</span> jsonObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * 前台活跃
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">JSONObject</span> <span class="token function">generatbeforeground</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token class-name">AppActive_foreground</span> appActive_foreground <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AppActive_foreground</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 推送消息的id</span>
        <span class="token keyword">int</span> flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
                appActive_foreground<span class="token punctuation">.</span><span class="token function">setAccess</span><span class="token punctuation">(</span>flag <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">default</span><span class="token operator">:</span>
                appActive_foreground<span class="token punctuation">.</span><span class="token function">setAccess</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// 1.push 2.icon 3.其他</span>
        flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        appActive_foreground<span class="token punctuation">.</span><span class="token function">setPush_id</span><span class="token punctuation">(</span>flag <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">JSONObject</span> jsonObject <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">JSONObject</span><span class="token punctuation">)</span> JSON<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span>appActive_foreground<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token function">packEventJson</span><span class="token punctuation">(</span><span class="token string">"active_foreground"</span><span class="token punctuation">,</span> jsonObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * 后台活跃
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">JSONObject</span> <span class="token function">generateBackground</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token class-name">AppActive_background</span> appActive_background <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AppActive_background</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 启动源</span>
        <span class="token keyword">int</span> flag <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        appActive_background<span class="token punctuation">.</span><span class="token function">setActive_source</span><span class="token punctuation">(</span>flag <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">JSONObject</span> jsonObject <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">JSONObject</span><span class="token punctuation">)</span> JSON<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span>appActive_background<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token function">packEventJson</span><span class="token punctuation">(</span><span class="token string">"active_background"</span><span class="token punctuation">,</span> jsonObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * 错误日志数据
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">JSONObject</span> <span class="token function">generateError</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token class-name">AppErrorLog</span> appErrorLog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AppErrorLog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> errorBriefs <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"at cn.lift.dfdf.web.AbstractBaseController.validInbound(AbstractBaseController.java:72)"</span><span class="token punctuation">,</span> <span class="token string">"at cn.lift.appIn.control.CommandUtil.getInfo(CommandUtil.java:67)"</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token comment">//错误摘要</span>
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> errorDetails <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"java.lang.NullPointerException\\n    "</span> <span class="token operator">+</span> <span class="token string">"at cn.lift.appIn.web.AbstractBaseController.validInbound(AbstractBaseController.java:72)\\n "</span> <span class="token operator">+</span> <span class="token string">"at cn.lift.dfdf.web.AbstractBaseController.validInbound"</span><span class="token punctuation">,</span> <span class="token string">"at cn.lift.dfdfdf.control.CommandUtil.getInfo(CommandUtil.java:67)\\n "</span> <span class="token operator">+</span> <span class="token string">"at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\n"</span> <span class="token operator">+</span> <span class="token string">" at java.lang.reflect.Method.invoke(Method.java:606)\\n"</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token comment">//错误详情</span>

        <span class="token comment">//错误摘要</span>
        appErrorLog<span class="token punctuation">.</span><span class="token function">setErrorBrief</span><span class="token punctuation">(</span>errorBriefs<span class="token punctuation">[</span>rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span>errorBriefs<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//错误详情</span>
        appErrorLog<span class="token punctuation">.</span><span class="token function">setErrorDetail</span><span class="token punctuation">(</span>errorDetails<span class="token punctuation">[</span>rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span>errorDetails<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">JSONObject</span> jsonObject <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">JSONObject</span><span class="token punctuation">)</span> JSON<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span>appErrorLog<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token function">packEventJson</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">,</span> jsonObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * 为各个事件类型的公共字段（时间、事件类型、Json数据）拼接
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">JSONObject</span> <span class="token function">packEventJson</span><span class="token punctuation">(</span><span class="token class-name">String</span> eventName<span class="token punctuation">,</span> <span class="token class-name">JSONObject</span> jsonObject<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token class-name">JSONObject</span> eventJson <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        eventJson<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"ett"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">99999999</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        eventJson<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"en"</span><span class="token punctuation">,</span> eventName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        eventJson<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"kv"</span><span class="token punctuation">,</span> jsonObject<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> eventJson<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * 获取随机字母组合
     *
     * @param length 字符串长度
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">getRandomChar</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token class-name">StringBuilder</span> str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Random</span> random <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token comment">// 字符串</span>
            str<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">65</span> <span class="token operator">+</span> random<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 取得大写字母</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * 获取随机字母数字组合
     *
     * @param length 字符串长度
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">getRandomCharAndNumr</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token class-name">StringBuilder</span> str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Random</span> random <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

            <span class="token keyword">boolean</span> b <span class="token operator">=</span> random<span class="token punctuation">.</span><span class="token function">nextBoolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// 字符串</span>
                <span class="token comment">// int choice = random.nextBoolean() ? 65 : 97; 取得65大写字母还是97小写字母</span>
                str<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">65</span> <span class="token operator">+</span> random<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 取得大写字母</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">// 数字</span>
                str<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * 收藏
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">JSONObject</span> <span class="token function">generateFavorites</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token class-name">AppFavorites</span> favorites <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AppFavorites</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        favorites<span class="token punctuation">.</span><span class="token function">setCourse_id</span><span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        favorites<span class="token punctuation">.</span><span class="token function">setUserid</span><span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        favorites<span class="token punctuation">.</span><span class="token function">setAdd_time</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">99999999</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">JSONObject</span> jsonObject <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">JSONObject</span><span class="token punctuation">)</span> JSON<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span>favorites<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token function">packEventJson</span><span class="token punctuation">(</span><span class="token string">"favorites"</span><span class="token punctuation">,</span> jsonObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * 点赞
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">JSONObject</span> <span class="token function">generatePraise</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token class-name">AppPraise</span> praise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AppPraise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        praise<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        praise<span class="token punctuation">.</span><span class="token function">setUserid</span><span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        praise<span class="token punctuation">.</span><span class="token function">setTarget_id</span><span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        praise<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        praise<span class="token punctuation">.</span><span class="token function">setAdd_time</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">99999999</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">JSONObject</span> jsonObject <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">JSONObject</span><span class="token punctuation">)</span> JSON<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span>praise<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token function">packEventJson</span><span class="token punctuation">(</span><span class="token string">"praise"</span><span class="token punctuation">,</span> jsonObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * 评论
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">JSONObject</span> <span class="token function">generateComment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token class-name">AppComment</span> comment <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AppComment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        comment<span class="token punctuation">.</span><span class="token function">setComment_id</span><span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        comment<span class="token punctuation">.</span><span class="token function">setUserid</span><span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        comment<span class="token punctuation">.</span><span class="token function">setP_comment_id</span><span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        comment<span class="token punctuation">.</span><span class="token function">setContent</span><span class="token punctuation">(</span><span class="token function">getCONTENT</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        comment<span class="token punctuation">.</span><span class="token function">setAddtime</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">99999999</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        comment<span class="token punctuation">.</span><span class="token function">setOther_id</span><span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        comment<span class="token punctuation">.</span><span class="token function">setPraise_count</span><span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        comment<span class="token punctuation">.</span><span class="token function">setReply_count</span><span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">JSONObject</span> jsonObject <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">JSONObject</span><span class="token punctuation">)</span> JSON<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span>comment<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token function">packEventJson</span><span class="token punctuation">(</span><span class="token string">"comment"</span><span class="token punctuation">,</span> jsonObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * 生成单个汉字
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">char</span> <span class="token function">getRandomChar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token class-name">String</span> str <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> hightPos<span class="token punctuation">;</span> <span class="token comment">//</span>
        <span class="token keyword">int</span> lowPos<span class="token punctuation">;</span>

        <span class="token class-name">Random</span> random <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//随机生成汉子的两个字节</span>
        hightPos <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">176</span> <span class="token operator">+</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">39</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        lowPos <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">161</span> <span class="token operator">+</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">93</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>hightPos<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">byteValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>lowPos<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">byteValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
            str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token string">"GBK"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">UnsupportedEncodingException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"错误"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">/**
     * 拼接成多个汉字
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">getCONTENT</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token class-name">StringBuilder</span> str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            str<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token function">getRandomChar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="3-4-15-配置日志打印Logback"><a class="header-anchor" href="#3-4-15-配置日志打印Logback">¶</a>3.4.15 配置日志打印Logback</h3>
<p>Logback主要用于在磁盘和控制台打印日志。</p>
<p>Logback具体使用：</p>
<blockquote>
<p>1）在resources文件夹下创建logback.xml文件。</p>
<p>2）在logback.xml文件中填写如下配置</p>
</blockquote>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span> <span class="token attr-name">debug</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
   <span class="token comment">&lt;!--定义日志文件的存储地址 勿在 LogBack 的配置中使用相对路径 --></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>LOG_HOME<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/tmp/logs/<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>

   <span class="token comment">&lt;!-- 控制台输出 --></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>STDOUT<span class="token punctuation">"</span></span>
      <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.ConsoleAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span>
         <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.encoder.PatternLayoutEncoder<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
         <span class="token comment">&lt;!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度%msg：日志消息，%n是换行符 --></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>
   
   <span class="token comment">&lt;!-- 按照每天生成日志文件。存储事件日志 --></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>FILE<span class="token punctuation">"</span></span>
      <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
      <span class="token comment">&lt;!-- &lt;File>$&#123;LOG_HOME&#125;/app.log&lt;/File>设置日志不超过$&#123;log.max.size&#125;时的保存路径，注意，如果是web项目会保存到Tomcat的bin目录 下 --></span>  
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span>
         <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
         <span class="token comment">&lt;!--日志文件输出的文件名 --></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FileNamePattern</span><span class="token punctuation">></span></span>$&#123;LOG_HOME&#125;/app-%d&#123;yyyy-MM-dd&#125;.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FileNamePattern</span><span class="token punctuation">></span></span>
         <span class="token comment">&lt;!--日志文件保留天数 --></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MaxHistory</span><span class="token punctuation">></span></span>30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>MaxHistory</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span>
         <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.encoder.PatternLayoutEncoder<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>
      <span class="token comment">&lt;!--日志文件最大的大小 --></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>triggeringPolicy</span>
         <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MaxFileSize</span><span class="token punctuation">></span></span>10MB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>MaxFileSize</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>triggeringPolicy</span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>

    <span class="token comment">&lt;!--异步打印日志--></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ASYNC_FILE<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>ch.qos.logback.classic.AsyncAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!-- 不丢失日志.默认的,如果队列的80%已满,则会丢弃TRACT、DEBUG、INFO级别的日志 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>discardingThreshold</span> <span class="token punctuation">></span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>discardingThreshold</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!-- 更改默认的队列的深度,该值会影响性能.默认值为256 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>queueSize</span><span class="token punctuation">></span></span>512<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>queueSize</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!-- 添加附加的appender,最多只能添加一个 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>FILE<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>

    <span class="token comment">&lt;!-- 日志输出级别 --></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>INFO<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>STDOUT<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ASYNC_FILE<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>error<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="3-4-16-打包"><a class="header-anchor" href="#3-4-16-打包">¶</a>3.4.16 打包</h3>
<p>1）采用Maven对程序打包</p>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307190133105.png" class="" title="image-20210307190133105" loading="lazy">
<p>2）采用带依赖的jar包。包含了程序运行需要的所有依赖。</p>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307190144526.png" class="" title="image-20210307190144526" loading="lazy">
<p>3）后续日志生成过程，在安装完Hadoop和Zookeeper之后执行。</p>
<h1>第4章 数据采集模块</h1>
<h2 id="4-1-Hadoop安装"><a class="header-anchor" href="#4-1-Hadoop安装">¶</a>4.1 Hadoop安装</h2>
<p>详见：尚硅谷大数据技术之Hadoop（入门）</p>
<p>1）集群规划：</p>
<table>
<thead>
<tr>
<th></th>
<th>服务器hadoop102</th>
<th>服务器hadoop103</th>
<th>服务器hadoop104</th>
</tr>
</thead>
<tbody>
<tr>
<td>HDFS</td>
<td>NameNodeDataNode</td>
<td>DataNode</td>
<td>DataNodeSecondaryNameNode</td>
</tr>
<tr>
<td>Yarn</td>
<td>NodeManager</td>
<td>ResourcemanagerNodeManager</td>
<td>NodeManager</td>
</tr>
</tbody>
</table>
<p>注意：尽量使用离线方式安装</p>
<h3 id="4-1-1-项目经验之HDFS存储多目录"><a class="header-anchor" href="#4-1-1-项目经验之HDFS存储多目录">¶</a>4.1.1 项目经验之HDFS存储多目录</h3>
<p>1）确认HDFS的存储目录，保证存储在空间最大硬盘上</p>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307190231034.png" class="" title="image-20210307190231034" loading="lazy">
<p>2）在hdfs-site.xml文件中配置多目录，最好提前配置好，否则更改目录需要重新启动集群</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>dfs.datanode.data.dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>file:///$&#123;hadoop.tmp.dir&#125;/dfs/data1,file:///hd2/dfs/data2,file:///hd3/dfs/data3,file:///hd4/dfs/data4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="4-1-2-项目经验之支持LZO压缩配置"><a class="header-anchor" href="#4-1-2-项目经验之支持LZO压缩配置">¶</a>4.1.2 项目经验之支持LZO压缩配置</h3>
<p>1）先下载lzo的jar项目</p>
<p><a target="_blank" rel="noopener" href="https://github.com/twitter/hadoop-lzo/archive/master.zip">[https://github.com/twitter/hadoop-lzo/archive/master.zip]{.underline}</a></p>
<p>2）下载后的文件名是hadoop-lzo-master，它是一个zip格式的压缩包，先进行解压，然后用maven编译。生成hadoop-lzo-0.4.20.jar。</p>
<p>3）将编译好后的hadoop-lzo-0.4.20.jar<br>
放入hadoop-2.7.2/share/hadoop/common/</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">[atguigu@hadoop102 common]$ pwd
&#x2F;opt&#x2F;module&#x2F;hadoop-2.7.2&#x2F;share&#x2F;hadoop&#x2F;common
[atguigu@hadoop102 common]$ ls
hadoop-lzo-0.4.20.jar<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>4）同步hadoop-lzo-0.4.20.jar到hadoop103、hadoop104</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">[atguigu@hadoop102 common]$ xsync hadoop-lzo-0.4.20.jar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>5）core-site.xml增加配置支持LZO压缩</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token prolog">&lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>io.compression.codecs<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>
org.apache.hadoop.io.compress.GzipCodec,
org.apache.hadoop.io.compress.DefaultCodec,
org.apache.hadoop.io.compress.BZip2Codec,
org.apache.hadoop.io.compress.SnappyCodec,
com.hadoop.compression.lzo.LzoCodec,
com.hadoop.compression.lzo.LzopCodec
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>io.compression.codec.lzo.class<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>com.hadoop.compression.lzo.LzoCodec<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>5）同步core-site.xml到hadoop103、hadoop104</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 hadoop]$ xsync core-site.xml<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>6）启动及查看集群</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 hadoop-2.7.2]$ sbin&#x2F;start-dfs.sh
[atguigu@hadoop103 hadoop-2.7.2]$ sbin&#x2F;start-yarn.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>（1）web和进程查看</p>
<ul>
<li>
<p>Web查看：<a target="_blank" rel="noopener" href="http://hadoop102:50070">[http://hadoop102:50070]{.underline}</a></p>
</li>
<li>
<p>进程查看：jps查看各个节点状态。</p>
</li>
</ul>
<p>（2）当启动发生错误的时候：</p>
<ul>
<li>
<p>查看日志：/home/atguigu/module/hadoop-2.7.2/logs</p>
</li>
<li>
<p>如果进入安全模式，可以通过hdfs dfsadmin -safemode leave</p>
</li>
<li>
<p>停止所有进程，删除data和log文件夹，然后hdfs namenode -format<br>
来格式化</p>
</li>
</ul>
<h3 id="4-1-3-项目经验之基准测试"><a class="header-anchor" href="#4-1-3-项目经验之基准测试">¶</a>4.1.3 项目经验之基准测试</h3>
<p>1） 测试HDFS写性能</p>
<p>测试内容：向HDFS集群写10个128M的文件</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 mapreduce]$ hadoop jar &#x2F;opt&#x2F;module&#x2F;hadoop-2.7.2&#x2F;share&#x2F;hadoop&#x2F;mapreduce&#x2F;hadoop-mapreduce-client-jobclient-2.7.2-tests.jar TestDFSIO -write -nrFiles 10 -fileSize 128MB

19&#x2F;05&#x2F;02 11:44:26 INFO fs.TestDFSIO: TestDFSIO.1.8
19&#x2F;05&#x2F;02 11:44:26 INFO fs.TestDFSIO: nrFiles &#x3D; 10
19&#x2F;05&#x2F;02 11:44:26 INFO fs.TestDFSIO: nrBytes (MB) &#x3D; 128.0
19&#x2F;05&#x2F;02 11:44:26 INFO fs.TestDFSIO: bufferSize &#x3D; 1000000
19&#x2F;05&#x2F;02 11:44:26 INFO fs.TestDFSIO: baseDir &#x3D; &#x2F;benchmarks&#x2F;TestDFSIO
19&#x2F;05&#x2F;02 11:44:28 INFO fs.TestDFSIO: creating control file: 134217728 bytes, 10 files
19&#x2F;05&#x2F;02 11:44:30 INFO fs.TestDFSIO: created control files for: 10 files
19&#x2F;05&#x2F;02 11:44:30 INFO client.RMProxy: Connecting to ResourceManager at hadoop103&#x2F;192.168.1.103:8032
19&#x2F;05&#x2F;02 11:44:31 INFO client.RMProxy: Connecting to ResourceManager at hadoop103&#x2F;192.168.1.103:8032
19&#x2F;05&#x2F;02 11:44:32 INFO mapred.FileInputFormat: Total input paths to process : 10
19&#x2F;05&#x2F;02 11:44:32 INFO mapreduce.JobSubmitter: number of splits:10
19&#x2F;05&#x2F;02 11:44:33 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1556766549220_0003
19&#x2F;05&#x2F;02 11:44:34 INFO impl.YarnClientImpl: Submitted application application_1556766549220_0003
19&#x2F;05&#x2F;02 11:44:34 INFO mapreduce.Job: The url to track the job: http:&#x2F;&#x2F;hadoop103:8088&#x2F;proxy&#x2F;application_1556766549220_0003&#x2F;
19&#x2F;05&#x2F;02 11:44:34 INFO mapreduce.Job: Running job: job_1556766549220_0003
19&#x2F;05&#x2F;02 11:44:47 INFO mapreduce.Job: Job job_1556766549220_0003 running in uber mode : false
19&#x2F;05&#x2F;02 11:44:47 INFO mapreduce.Job:  map 0% reduce 0%
19&#x2F;05&#x2F;02 11:45:05 INFO mapreduce.Job:  map 13% reduce 0%
19&#x2F;05&#x2F;02 11:45:06 INFO mapreduce.Job:  map 27% reduce 0%
19&#x2F;05&#x2F;02 11:45:08 INFO mapreduce.Job:  map 43% reduce 0%
19&#x2F;05&#x2F;02 11:45:09 INFO mapreduce.Job:  map 60% reduce 0%
19&#x2F;05&#x2F;02 11:45:10 INFO mapreduce.Job:  map 73% reduce 0%
19&#x2F;05&#x2F;02 11:45:15 INFO mapreduce.Job:  map 77% reduce 0%
19&#x2F;05&#x2F;02 11:45:18 INFO mapreduce.Job:  map 87% reduce 0%
19&#x2F;05&#x2F;02 11:45:19 INFO mapreduce.Job:  map 100% reduce 0%
19&#x2F;05&#x2F;02 11:45:21 INFO mapreduce.Job:  map 100% reduce 100%
19&#x2F;05&#x2F;02 11:45:22 INFO mapreduce.Job: Job job_1556766549220_0003 completed successfully
19&#x2F;05&#x2F;02 11:45:22 INFO mapreduce.Job: Counters: 51
        File System Counters
                FILE: Number of bytes read&#x3D;856
                FILE: Number of bytes written&#x3D;1304826
                FILE: Number of read operations&#x3D;0
                FILE: Number of large read operations&#x3D;0
                FILE: Number of write operations&#x3D;0
                HDFS: Number of bytes read&#x3D;2350
                HDFS: Number of bytes written&#x3D;1342177359
                HDFS: Number of read operations&#x3D;43
                HDFS: Number of large read operations&#x3D;0
                HDFS: Number of write operations&#x3D;12
        Job Counters 
                Killed map tasks&#x3D;1
                Launched map tasks&#x3D;10
                Launched reduce tasks&#x3D;1
                Data-local map tasks&#x3D;8
                Rack-local map tasks&#x3D;2
                Total time spent by all maps in occupied slots (ms)&#x3D;263635
                Total time spent by all reduces in occupied slots (ms)&#x3D;9698
                Total time spent by all map tasks (ms)&#x3D;263635
                Total time spent by all reduce tasks (ms)&#x3D;9698
                Total vcore-milliseconds taken by all map tasks&#x3D;263635
                Total vcore-milliseconds taken by all reduce tasks&#x3D;9698
                Total megabyte-milliseconds taken by all map tasks&#x3D;269962240
                Total megabyte-milliseconds taken by all reduce tasks&#x3D;9930752
        Map-Reduce Framework
                Map input records&#x3D;10
                Map output records&#x3D;50
                Map output bytes&#x3D;750
                Map output materialized bytes&#x3D;910
                Input split bytes&#x3D;1230
                Combine input records&#x3D;0
                Combine output records&#x3D;0
                Reduce input groups&#x3D;5
                Reduce shuffle bytes&#x3D;910
                Reduce input records&#x3D;50
                Reduce output records&#x3D;5
                Spilled Records&#x3D;100
                Shuffled Maps &#x3D;10
                Failed Shuffles&#x3D;0
                Merged Map outputs&#x3D;10
                GC time elapsed (ms)&#x3D;17343
                CPU time spent (ms)&#x3D;96930
                Physical memory (bytes) snapshot&#x3D;2821341184
                Virtual memory (bytes) snapshot&#x3D;23273218048
                Total committed heap usage (bytes)&#x3D;2075656192
        Shuffle Errors
                BAD_ID&#x3D;0
                CONNECTION&#x3D;0
                IO_ERROR&#x3D;0
                WRONG_LENGTH&#x3D;0
                WRONG_MAP&#x3D;0
                WRONG_REDUCE&#x3D;0
        File Input Format Counters 
                Bytes Read&#x3D;1120
        File Output Format Counters 
                Bytes Written&#x3D;79
19&#x2F;05&#x2F;02 11:45:23 INFO fs.TestDFSIO: ----- TestDFSIO ----- : write
19&#x2F;05&#x2F;02 11:45:23 INFO fs.TestDFSIO:            Date &amp; time: Thu May 02 11:45:23 CST 2019
19&#x2F;05&#x2F;02 11:45:23 INFO fs.TestDFSIO:        Number of files: 10
19&#x2F;05&#x2F;02 11:45:23 INFO fs.TestDFSIO: Total MBytes processed: 1280.0
19&#x2F;05&#x2F;02 11:45:23 INFO fs.TestDFSIO:      Throughput mb&#x2F;sec: 10.69751115716984
19&#x2F;05&#x2F;02 11:45:23 INFO fs.TestDFSIO: Average IO rate mb&#x2F;sec: 14.91699504852295
19&#x2F;05&#x2F;02 11:45:23 INFO fs.TestDFSIO:  IO rate std deviation: 11.160882132355928
19&#x2F;05&#x2F;02 11:45:23 INFO fs.TestDFSIO:     Test exec time sec: 52.315<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>2）测试HDFS读性能</p>
<p>测试内容：读取HDFS集群10个128M的文件</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">[atguigu@hadoop102 mapreduce]$ hadoop jar &#x2F;opt&#x2F;module&#x2F;hadoop-2.7.2&#x2F;share&#x2F;hadoop&#x2F;mapreduce&#x2F;hadoop-mapreduce-client-jobclient-2.7.2-tests.jar TestDFSIO -read -nrFiles 10 -fileSize 128MB

19&#x2F;05&#x2F;02 11:55:42 INFO fs.TestDFSIO: TestDFSIO.1.8
19&#x2F;05&#x2F;02 11:55:42 INFO fs.TestDFSIO: nrFiles &#x3D; 10
19&#x2F;05&#x2F;02 11:55:42 INFO fs.TestDFSIO: nrBytes (MB) &#x3D; 128.0
19&#x2F;05&#x2F;02 11:55:42 INFO fs.TestDFSIO: bufferSize &#x3D; 1000000
19&#x2F;05&#x2F;02 11:55:42 INFO fs.TestDFSIO: baseDir &#x3D; &#x2F;benchmarks&#x2F;TestDFSIO
19&#x2F;05&#x2F;02 11:55:45 INFO fs.TestDFSIO: creating control file: 134217728 bytes, 10 files
19&#x2F;05&#x2F;02 11:55:47 INFO fs.TestDFSIO: created control files for: 10 files
19&#x2F;05&#x2F;02 11:55:47 INFO client.RMProxy: Connecting to ResourceManager at hadoop103&#x2F;192.168.1.103:8032
19&#x2F;05&#x2F;02 11:55:48 INFO client.RMProxy: Connecting to ResourceManager at hadoop103&#x2F;192.168.1.103:8032
19&#x2F;05&#x2F;02 11:55:49 INFO mapred.FileInputFormat: Total input paths to process : 10
19&#x2F;05&#x2F;02 11:55:49 INFO mapreduce.JobSubmitter: number of splits:10
19&#x2F;05&#x2F;02 11:55:49 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1556766549220_0004
19&#x2F;05&#x2F;02 11:55:50 INFO impl.YarnClientImpl: Submitted application application_1556766549220_0004
19&#x2F;05&#x2F;02 11:55:50 INFO mapreduce.Job: The url to track the job: http:&#x2F;&#x2F;hadoop103:8088&#x2F;proxy&#x2F;application_1556766549220_0004&#x2F;
19&#x2F;05&#x2F;02 11:55:50 INFO mapreduce.Job: Running job: job_1556766549220_0004
19&#x2F;05&#x2F;02 11:56:04 INFO mapreduce.Job: Job job_1556766549220_0004 running in uber mode : false
19&#x2F;05&#x2F;02 11:56:04 INFO mapreduce.Job:  map 0% reduce 0%
19&#x2F;05&#x2F;02 11:56:24 INFO mapreduce.Job:  map 7% reduce 0%
19&#x2F;05&#x2F;02 11:56:27 INFO mapreduce.Job:  map 23% reduce 0%
19&#x2F;05&#x2F;02 11:56:28 INFO mapreduce.Job:  map 63% reduce 0%
19&#x2F;05&#x2F;02 11:56:29 INFO mapreduce.Job:  map 73% reduce 0%
19&#x2F;05&#x2F;02 11:56:30 INFO mapreduce.Job:  map 77% reduce 0%
19&#x2F;05&#x2F;02 11:56:31 INFO mapreduce.Job:  map 87% reduce 0%
19&#x2F;05&#x2F;02 11:56:32 INFO mapreduce.Job:  map 100% reduce 0%
19&#x2F;05&#x2F;02 11:56:35 INFO mapreduce.Job:  map 100% reduce 100%
19&#x2F;05&#x2F;02 11:56:36 INFO mapreduce.Job: Job job_1556766549220_0004 completed successfully
19&#x2F;05&#x2F;02 11:56:36 INFO mapreduce.Job: Counters: 51
        File System Counters
                FILE: Number of bytes read&#x3D;852
                FILE: Number of bytes written&#x3D;1304796
                FILE: Number of read operations&#x3D;0
                FILE: Number of large read operations&#x3D;0
                FILE: Number of write operations&#x3D;0
                HDFS: Number of bytes read&#x3D;1342179630
                HDFS: Number of bytes written&#x3D;78
                HDFS: Number of read operations&#x3D;53
                HDFS: Number of large read operations&#x3D;0
                HDFS: Number of write operations&#x3D;2
        Job Counters 
                Killed map tasks&#x3D;1
                Launched map tasks&#x3D;10
                Launched reduce tasks&#x3D;1
                Data-local map tasks&#x3D;8
                Rack-local map tasks&#x3D;2
                Total time spent by all maps in occupied slots (ms)&#x3D;233690
                Total time spent by all reduces in occupied slots (ms)&#x3D;7215
                Total time spent by all map tasks (ms)&#x3D;233690
                Total time spent by all reduce tasks (ms)&#x3D;7215
                Total vcore-milliseconds taken by all map tasks&#x3D;233690
                Total vcore-milliseconds taken by all reduce tasks&#x3D;7215
                Total megabyte-milliseconds taken by all map tasks&#x3D;239298560
                Total megabyte-milliseconds taken by all reduce tasks&#x3D;7388160
        Map-Reduce Framework
                Map input records&#x3D;10
                Map output records&#x3D;50
                Map output bytes&#x3D;746
                Map output materialized bytes&#x3D;906
                Input split bytes&#x3D;1230
                Combine input records&#x3D;0
                Combine output records&#x3D;0
                Reduce input groups&#x3D;5
                Reduce shuffle bytes&#x3D;906
                Reduce input records&#x3D;50
                Reduce output records&#x3D;5
                Spilled Records&#x3D;100
                Shuffled Maps &#x3D;10
                Failed Shuffles&#x3D;0
                Merged Map outputs&#x3D;10
                GC time elapsed (ms)&#x3D;6473
                CPU time spent (ms)&#x3D;57610
                Physical memory (bytes) snapshot&#x3D;2841436160
                Virtual memory (bytes) snapshot&#x3D;23226683392
                Total committed heap usage (bytes)&#x3D;2070413312
        Shuffle Errors
                BAD_ID&#x3D;0
                CONNECTION&#x3D;0
                IO_ERROR&#x3D;0
                WRONG_LENGTH&#x3D;0
                WRONG_MAP&#x3D;0
                WRONG_REDUCE&#x3D;0
        File Input Format Counters 
                Bytes Read&#x3D;1120
        File Output Format Counters 
                Bytes Written&#x3D;78
19&#x2F;05&#x2F;02 11:56:36 INFO fs.TestDFSIO: ----- TestDFSIO ----- : read
19&#x2F;05&#x2F;02 11:56:36 INFO fs.TestDFSIO:            Date &amp; time: Thu May 02 11:56:36 CST 2019
19&#x2F;05&#x2F;02 11:56:36 INFO fs.TestDFSIO:        Number of files: 10
19&#x2F;05&#x2F;02 11:56:36 INFO fs.TestDFSIO: Total MBytes processed: 1280.0
19&#x2F;05&#x2F;02 11:56:36 INFO fs.TestDFSIO:      Throughput mb&#x2F;sec: 16.001000062503905
19&#x2F;05&#x2F;02 11:56:36 INFO fs.TestDFSIO: Average IO rate mb&#x2F;sec: 17.202795028686523
19&#x2F;05&#x2F;02 11:56:36 INFO fs.TestDFSIO:  IO rate std deviation: 4.881590515873911
19&#x2F;05&#x2F;02 11:56:36 INFO fs.TestDFSIO:     Test exec time sec: 49.116
19&#x2F;05&#x2F;02 11:56:36 INFO fs.TestDFSIO:<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>3）删除测试生成数据</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 mapreduce]$ hadoop jar &#x2F;opt&#x2F;module&#x2F;hadoop-2.7.2&#x2F;share&#x2F;hadoop&#x2F;mapreduce&#x2F;hadoop-mapreduce-client-jobclient-2.7.2-tests.jar TestDFSIO -clean<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>4）使用Sort程序评测MapReduce</p>
<p>（1）使用RandomWriter来产生随机数，每个节点运行10个Map任务，每个Map产生大约1G大小的二进制随机数</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 mapreduce]$ hadoop jar &#x2F;opt&#x2F;module&#x2F;hadoop-2.7.2&#x2F;share&#x2F;hadoop&#x2F;mapreduce&#x2F;hadoop-mapreduce-examples-2.7.2.jar randomwriter random-data<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>（2）执行Sort程序</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 mapreduce]$ hadoop jar &#x2F;opt&#x2F;module&#x2F;hadoop-2.7.2&#x2F;share&#x2F;hadoop&#x2F;mapreduce&#x2F;hadoop-mapreduce-examples-2.7.2.jar sort random-data sorted-data<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>（3）验证数据是否真正排好序了</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 mapreduce]$ hadoop jar &#x2F;opt&#x2F;module&#x2F;hadoop-2.7.2&#x2F;share&#x2F;hadoop&#x2F;mapreduce&#x2F;hadoop-mapreduce-examples-2.7.2.jar testmapredsort -sortInput random-data -sortOutput sorted-data<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="4-1-4-项目经验之Hadoop参数调优"><a class="header-anchor" href="#4-1-4-项目经验之Hadoop参数调优">¶</a>4.1.4 项目经验之Hadoop参数调优</h3>
<p>1）HDFS参数调优hdfs-site.xml</p>
<p>（1）dfs.namenode.handler.count=20 * log2(Cluster<br>
Size)，比如集群规模为8台时，此参数设置为60</p>
<pre class="line-numbers language-none"><code class="language-none">The number of Namenode RPC server threads that listen to requests from clients. If dfs.namenode.servicerpc-address is not configured then Namenode RPC server threads listen to requests from all nodes.
NameNode有一个工作线程池，用来处理不同DataNode的并发心跳以及客户端并发的元数据操作。对于大集群或者有大量客户端的集群来说，通常需要增大参数dfs.namenode.handler.count的默认值10。设置该值的一般原则是将其设置为集群大小的自然对数乘以20，即20logN，N为集群大小。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>（2）编辑日志存储路径dfs.namenode.edits.dir设置与镜像文件存储路径dfs.namenode.name.dir尽量分开，达到最低写入延迟</p>
<p>2）YARN参数调优yarn-site.xml</p>
<p>（1）情景描述：总共7台机器，每天几亿条数据，数据源-&gt;Flume-&gt;Kafka-&gt;HDFS-&gt;Hive</p>
<p>面临问题：数据统计主要用HiveSQL，没有数据倾斜，小文件已经做了合并处理，开启的JVM重用，而且IO没有阻塞，内存用了不到50%。但是还是跑的非常慢，而且数据量洪峰过来时，整个集群都会宕掉。基于这种情况有没有优化方案。</p>
<p>（2）解决办法：</p>
<p>内存利用率不够。这个一般是Yarn的2个配置造成的，单个任务可以申请的最大内存大小，和Hadoop单个节点可用内存大小。调节这两个参数能提高系统内存的利用率。</p>
<p>（a）yarn.nodemanager.resource.memory-mb</p>
<p>表示该节点上YARN可使用的物理内存总量，默认是8192（MB），注意，如果你的节点内存资源不够8GB，则需要调减小这个值，而YARN不会智能的探测节点的物理内存总量。</p>
<p>（b）yarn.scheduler.maximum-allocation-mb</p>
<p>单个任务可申请的最多物理内存量，默认是8192（MB）。</p>
<p>3）Hadoop宕机</p>
<p>（1）如果MR造成系统宕机。此时要控制Yarn同时运行的任务数，和每个任务申请的最大内存。调整参数：yarn.scheduler.maximum-allocation-mb（单个任务可申请的最多物理内存量，默认是8192MB）</p>
<p>（2）如果写入文件过量造成NameNode宕机。那么调高Kafka的存储大小，控制从Kafka到HDFS的写入速度。高峰期的时候用Kafka进行缓存，高峰期过去数据同步会自动跟上。</p>
<h2 id="4-2-Zookeeper安装"><a class="header-anchor" href="#4-2-Zookeeper安装">¶</a>4.2 Zookeeper安装</h2>
<h3 id="4-2-1-安装ZK"><a class="header-anchor" href="#4-2-1-安装ZK">¶</a>4.2.1 安装ZK</h3>
<p>详见：尚硅谷大数据技术之Zookeeper</p>
<p>集群规划</p>
<table>
<thead>
<tr>
<th></th>
<th>服务器hadoop102</th>
<th>服务器hadoop103</th>
<th>服务器hadoop104</th>
</tr>
</thead>
<tbody>
<tr>
<td>Zookeeper</td>
<td>Zookeeper</td>
<td>Zookeeper</td>
<td>Zookeeper</td>
</tr>
</tbody>
</table>
<h3 id="4-2-2-ZK集群启动停止脚本"><a class="header-anchor" href="#4-2-2-ZK集群启动停止脚本">¶</a>4.2.2 ZK集群启动停止脚本</h3>
<p>1）在hadoop102的/home/atguigu/bin目录下创建脚本</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 bin]$ vim zk.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>在脚本中编写如下内容</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">#! &#x2F;bin&#x2F;bash

case $1 in
&quot;start&quot;)&#123;
	for i in hadoop102 hadoop103 hadoop104
	do
		ssh $i &quot;&#x2F;opt&#x2F;module&#x2F;zookeeper-3.4.10&#x2F;bin&#x2F;zkServer.sh start&quot;
	done
&#125;;;
&quot;stop&quot;)&#123;
	for i in hadoop102 hadoop103 hadoop104
	do
		ssh $i &quot;&#x2F;opt&#x2F;module&#x2F;zookeeper-3.4.10&#x2F;bin&#x2F;zkServer.sh stop&quot;
	done
&#125;;;
&quot;status&quot;)&#123;
	for i in hadoop102 hadoop103 hadoop104
	do
		ssh $i &quot;&#x2F;opt&#x2F;module&#x2F;zookeeper-3.4.10&#x2F;bin&#x2F;zkServer.sh status&quot;
	done
&#125;;;
esac<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>2）增加脚本执行权限</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 bin]$ chmod 777 zk.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>3）Zookeeper集群启动脚本</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 module]$ zk.sh start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>4）Zookeeper集群停止脚本</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 module]$ zk.sh stop<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="4-2-3-项目经验之Linux环境变量"><a class="header-anchor" href="#4-2-3-项目经验之Linux环境变量">¶</a>4.2.3 项目经验之Linux环境变量</h3>
<p>1）修改/etc/profile文件：用来设置系统环境参数，比如$PATH.<br>
这里面的环境变量是对系统内所有用户生效。使用bash命令，需要source<br>
/etc/profile一下。</p>
<p>2）修改~/.bashrc文件：针对某一个特定的用户，环境变量的设置只对该用户自己有效。使用bash命令，只要以该用户身份运行命令行就会读取该文件。</p>
<p>3）把/etc/profile里面的环境变量追加到~/.bashrc目录</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 ~]$ cat &#x2F;etc&#x2F;profile &gt;&gt; ~&#x2F;.bashrc
[atguigu@hadoop103 ~]$ cat &#x2F;etc&#x2F;profile &gt;&gt; ~&#x2F;.bashrc
[atguigu@hadoop104 ~]$ cat &#x2F;etc&#x2F;profile &gt;&gt; ~&#x2F;.bashrc<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2 id="4-3-日志生成"><a class="header-anchor" href="#4-3-日志生成">¶</a>4.3 日志生成</h2>
<h3 id="4-3-1-日志启动"><a class="header-anchor" href="#4-3-1-日志启动">¶</a>4.3.1 日志启动</h3>
<p>1）代码参数说明</p>
<pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F; 参数一：控制发送每条的延时时间，默认是0
Long delay &#x3D; args.length &gt; 0 ? Long.parseLong(args[0]) : 0L;

&#x2F;&#x2F; 参数二：循环遍历次数
int loop_len &#x3D; args.length &gt; 1 ? Integer.parseInt(args[1]) : 1000;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>2）将生成的jar包log-collector-0.0.1-SNAPSHOT-jar-with-dependencies.jar拷贝到hadoop102、服务器上，并同步到hadoop103的/opt/module路径下，</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 module]$ xsync log-collector-1.0-SNAPSHOT-jar-with-dependencies.jar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>3）在hadoop102上执行jar程序</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 module]$ java -classpath log-collector-1.0-SNAPSHOT-jar-with-dependencies.jar com.atguigu.appclient.AppMain  &gt;&#x2F;opt&#x2F;module&#x2F;test.log<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>4）在/tmp/logs路径下查看生成的日志文件</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 module]$ cd &#x2F;tmp&#x2F;logs&#x2F;
[atguigu@hadoop102 logs]$ ls
app-2019-02-10.log<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="4-3-2-集群日志生成启动脚本"><a class="header-anchor" href="#4-3-2-集群日志生成启动脚本">¶</a>4.3.2 集群日志生成启动脚本</h3>
<p>1）在/home/atguigu/bin目录下创建脚本lg.sh</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 bin]$ vim lg.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>2）在脚本中编写如下内容</p>
<pre class="line-numbers language-none"><code class="language-none">#! &#x2F;bin&#x2F;bash

	for i in hadoop102 hadoop103 
	do
		ssh $i &quot;java -classpath &#x2F;opt&#x2F;module&#x2F;log-collector-1.0-SNAPSHOT-jar-with-dependencies.jar com.atguigu.appclient.AppMain $1 $2 &gt;&#x2F;opt&#x2F;module&#x2F;test.log &amp;&quot;
	done<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>3）修改脚本执行权限</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 bin]$ chmod 777 lg.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>4）启动脚本</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 module]$ lg.sh <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>5）分别在hadoop102、hadoop103的/tmp/logs目录上查看生成的数据</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 logs]$ ls
app-2019-02-10.log
[atguigu@hadoop103 logs]$ ls
app-2019-02-10.log<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="4-3-3-集群时间同步修改脚本"><a class="header-anchor" href="#4-3-3-集群时间同步修改脚本">¶</a>4.3.3 集群时间同步修改脚本</h3>
<p>1）在/home/atguigu/bin目录下创建脚本dt.sh</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 bin]$ vim dt.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>2）在脚本中编写如下内容</p>
<pre class="line-numbers language-none"><code class="language-none">#!&#x2F;bin&#x2F;bash

log_date&#x3D;$1

for i in hadoop102 hadoop103 hadoop104
do
	ssh -t $i &quot;sudo date -s $log_date&quot;
done<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>说明（ssh -t）：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/kevingrace/p/6110842.html">https://www.cnblogs.com/kevingrace/p/6110842.html</a></p>
<p>3）修改脚本执行权限</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 bin]$ chmod 777 dt.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>4）启动脚本</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 bin]$ dt.sh 2019-2-10<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="4-3-4-集群所有进程查看脚本"><a class="header-anchor" href="#4-3-4-集群所有进程查看脚本">¶</a>4.3.4 集群所有进程查看脚本</h3>
<p>1）在/home/atguigu/bin目录下创建脚本xcall.sh</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 bin]$ vim xcall.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>2）在脚本中编写如下内容</p>
<pre class="line-numbers language-none"><code class="language-none">#! &#x2F;bin&#x2F;bash

for i in hadoop102 hadoop103 hadoop104
do
        echo --------- $i ----------
        ssh $i &quot;$*&quot;
done<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>3）修改脚本执行权限</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 bin]$ chmod 777 xcall.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>4）启动脚本</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 bin]$ xcall.sh jps<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="4-4-采集日志Flume"><a class="header-anchor" href="#4-4-采集日志Flume">¶</a>4.4 采集日志Flume</h2>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307191301258.png" class="" title="image-20210307191301258" loading="lazy">
<h3 id="4-4-1-日志采集Flume安装"><a class="header-anchor" href="#4-4-1-日志采集Flume安装">¶</a>4.4.1 日志采集Flume安装</h3>
<p>详见：尚硅谷大数据技术之Flume</p>
<p>集群规划：</p>
<table>
<thead>
<tr>
<th></th>
<th>服务器hadoop102</th>
<th>服务器hadoop103</th>
<th>服务器hadoop104</th>
</tr>
</thead>
<tbody>
<tr>
<td>Flume(采集日志)</td>
<td>Flume</td>
<td>Flume</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="4-4-2-项目经验之Flume组件"><a class="header-anchor" href="#4-4-2-项目经验之Flume组件">¶</a>4.4.2 项目经验之Flume组件</h3>
<p>1）Source</p>
<p>（1）Taildir Source相比Exec Source、Spooling Directory Source的优势</p>
<p>TailDir<br>
Source：断点续传、多目录。Flume1.6以前需要自己自定义Source记录每次读取文件位置，实现断点续传。</p>
<p>Exec<br>
Source可以实时搜集数据，但是在Flume不运行或者Shell命令出错的情况下，数据将会丢失。</p>
<p>Spooling Directory Source监控目录，不支持断点续传。</p>
<p>（2）batchSize大小如何设置？</p>
<p>答：Event 1K左右时，500-1000合适（默认为100）</p>
<p>2）Channel</p>
<p>采用Kafka Channel，省去了Sink，提高了效率。</p>
<h3 id="4-4-3-日志采集Flume配置"><a class="header-anchor" href="#4-4-3-日志采集Flume配置">¶</a>4.4.3 日志采集Flume配置</h3>
<p>1）Flume配置分析</p>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307191357000.png" class="" title="image-20210307191357000" loading="lazy">
<p>Flume直接读log日志的数据，log日志的格式是app-yyyy-mm-dd.log。</p>
<p>2）Flume的具体配置如下：</p>
<p>（1）在/opt/module/flume/conf目录下创建file-flume-kafka.conf文件</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 conf]$ vim file-flume-kafka.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>在文件配置如下内容</p>
<pre class="line-numbers language-conf" data-language="conf"><code class="language-conf">a1.sources&#x3D;r1
a1.channels&#x3D;c1 c2

# configure source
a1.sources.r1.type &#x3D; TAILDIR
a1.sources.r1.positionFile &#x3D; &#x2F;opt&#x2F;module&#x2F;flume&#x2F;test&#x2F;log_position.json
a1.sources.r1.filegroups &#x3D; f1
a1.sources.r1.filegroups.f1 &#x3D; &#x2F;tmp&#x2F;logs&#x2F;app.+
a1.sources.r1.fileHeader &#x3D; true
a1.sources.r1.channels &#x3D; c1 c2

#interceptor
a1.sources.r1.interceptors &#x3D;  i1 i2
a1.sources.r1.interceptors.i1.type &#x3D; com.atguigu.flume.interceptor.LogETLInterceptor$Builder
a1.sources.r1.interceptors.i2.type &#x3D; com.atguigu.flume.interceptor.LogTypeInterceptor$Builder

a1.sources.r1.selector.type &#x3D; multiplexing
a1.sources.r1.selector.header &#x3D; topic
a1.sources.r1.selector.mapping.topic_start &#x3D; c1
a1.sources.r1.selector.mapping.topic_event &#x3D; c2

# configure channel
a1.channels.c1.type &#x3D; org.apache.flume.channel.kafka.KafkaChannel
a1.channels.c1.kafka.bootstrap.servers &#x3D; hadoop102:9092,hadoop103:9092,hadoop104:9092
a1.channels.c1.kafka.topic &#x3D; topic_start
a1.channels.c1.parseAsFlumeEvent &#x3D; false
a1.channels.c1.kafka.consumer.group.id &#x3D; flume-consumer

a1.channels.c2.type &#x3D; org.apache.flume.channel.kafka.KafkaChannel
a1.channels.c2.kafka.bootstrap.servers &#x3D; hadoop102:9092,hadoop103:9092,hadoop104:9092
a1.channels.c2.kafka.topic &#x3D; topic_event
a1.channels.c2.parseAsFlumeEvent &#x3D; false
a1.channels.c2.kafka.consumer.group.id &#x3D; flume-consumer<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>注意：com.atguigu.flume.interceptor.LogETLInterceptor和com.atguigu.flume.interceptor.LogTypeInterceptor是自定义的拦截器的全类名。需要根据用户自定义的拦截器做相应修改。</p>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307191558720.png" class="" title="image-20210307191558720" loading="lazy">
<h3 id="4-4-4-Flume的ETL和分类型拦截器"><a class="header-anchor" href="#4-4-4-Flume的ETL和分类型拦截器">¶</a>4.4.4 Flume的ETL和分类型拦截器</h3>
<p>本项目中自定义了两个拦截器，分别是：ETL拦截器、日志类型区分拦截器。</p>
<p>ETL拦截器主要用于，过滤时间戳不合法和Json数据不完整的日志</p>
<p>日志类型区分拦截器主要用于，将启动日志和事件日志区分开来，方便发往Kafka的不同Topic。</p>
<p>1）创建Maven工程flume-interceptor</p>
<p>2）创建包名：com.atguigu.flume.interceptor</p>
<p>3）在pom.xml文件中添加如下配置</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.flume<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>flume-ng-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.7.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>maven-compiler-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.3.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span><span class="token punctuation">></span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>source</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>target</span><span class="token punctuation">></span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>target</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>maven-assembly-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>descriptorRefs</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>descriptorRef</span><span class="token punctuation">></span></span>jar-with-dependencies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>descriptorRef</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>descriptorRefs</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>executions</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>execution</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>make-assembly<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>phase</span><span class="token punctuation">></span></span>package<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>phase</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goals</span><span class="token punctuation">></span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goal</span><span class="token punctuation">></span></span>single<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goal</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goals</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>execution</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>executions</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>4）在com.atguigu.flume.interceptor包下创建LogETLInterceptor类名</p>
<p>Flume ETL拦截器LogETLInterceptor</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>flume<span class="token punctuation">.</span>interceptor</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flume<span class="token punctuation">.</span></span><span class="token class-name">Context</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flume<span class="token punctuation">.</span></span><span class="token class-name">Event</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flume<span class="token punctuation">.</span>interceptor<span class="token punctuation">.</span></span><span class="token class-name">Interceptor</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>charset<span class="token punctuation">.</span></span><span class="token class-name">Charset</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LogETLInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">Interceptor</span> <span class="token punctuation">&#123;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

    <span class="token punctuation">&#125;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Event</span> <span class="token function">intercept</span><span class="token punctuation">(</span><span class="token class-name">Event</span> event<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token comment">// 1 获取数据</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> log <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">,</span> <span class="token class-name">Charset</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 2 判断数据类型并向Header中赋值</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>log<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"start"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">LogUtils</span><span class="token punctuation">.</span><span class="token function">validateStart</span><span class="token punctuation">(</span>log<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                <span class="token keyword">return</span> event<span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">LogUtils</span><span class="token punctuation">.</span><span class="token function">validateEvent</span><span class="token punctuation">(</span>log<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                <span class="token keyword">return</span> event<span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// 3 返回校验结果</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Event</span><span class="token punctuation">></span></span> <span class="token function">intercept</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Event</span><span class="token punctuation">></span></span> events<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Event</span><span class="token punctuation">></span></span> interceptors <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Event</span> event <span class="token operator">:</span> events<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">Event</span> intercept1 <span class="token operator">=</span> <span class="token function">intercept</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>intercept1 <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                interceptors<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>intercept1<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">return</span> interceptors<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Builder</span> <span class="token keyword">implements</span> <span class="token class-name">Interceptor</span><span class="token punctuation">.</span><span class="token class-name">Builder</span><span class="token punctuation">&#123;</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token class-name">Interceptor</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">LogETLInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>4）Flume日志过滤工具类</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>flume<span class="token punctuation">.</span>interceptor</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">NumberUtils</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LogUtils</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">validateEvent</span><span class="token punctuation">(</span><span class="token class-name">String</span> log<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// 服务器时间 | json</span>
        <span class="token comment">// 1549696569054 | &#123;"cm":&#123;"ln":"-89.2","sv":"V2.0.4","os":"8.2.0","g":"M67B4QYU@gmail.com","nw":"4G","l":"en","vc":"18","hw":"1080*1920","ar":"MX","uid":"u8678","t":"1549679122062","la":"-27.4","md":"sumsung-12","vn":"1.1.3","ba":"Sumsung","sr":"Y"&#125;,"ap":"weather","et":[]&#125;</span>

        <span class="token comment">// 1 切割</span>
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> logContents <span class="token operator">=</span> log<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"\\|"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 2 校验</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>logContents<span class="token punctuation">.</span>length <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">//3 校验服务器时间</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>logContents<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">13</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token class-name">NumberUtils</span><span class="token punctuation">.</span><span class="token function">isDigits</span><span class="token punctuation">(</span>logContents<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// 4 校验json</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>logContents<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"&#123;"</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span>logContents<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">"&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">validateStart</span><span class="token punctuation">(</span><span class="token class-name">String</span> log<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
 <span class="token comment">// &#123;"action":"1","ar":"MX","ba":"HTC","detail":"542","en":"start","entry":"2","extend1":"","g":"S3HQ7LKM@gmail.com","hw":"640*960","l":"en","la":"-43.4","ln":"-98.3","loading_time":"10","md":"HTC-5","mid":"993","nw":"WIFI","open_ad_type":"1","os":"8.2.1","sr":"D","sv":"V2.9.0","t":"1559551922019","uid":"993","vc":"0","vn":"1.1.5"&#125;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>log <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// 校验json</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>log<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"&#123;"</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span>log<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">"&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>5）Flume日志类型区分拦截器LogTypeInterceptor</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>flume<span class="token punctuation">.</span>interceptor</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flume<span class="token punctuation">.</span></span><span class="token class-name">Context</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flume<span class="token punctuation">.</span></span><span class="token class-name">Event</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flume<span class="token punctuation">.</span>interceptor<span class="token punctuation">.</span></span><span class="token class-name">Interceptor</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>charset<span class="token punctuation">.</span></span><span class="token class-name">Charset</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LogTypeInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">Interceptor</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

    <span class="token punctuation">&#125;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Event</span> <span class="token function">intercept</span><span class="token punctuation">(</span><span class="token class-name">Event</span> event<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token comment">// 区分日志类型：   body  header</span>
        <span class="token comment">// 1 获取body数据</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> log <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">,</span> <span class="token class-name">Charset</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 2 获取header</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> headers <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">getHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 3 判断数据类型并向Header中赋值</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>log<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"start"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            headers<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"topic"</span><span class="token punctuation">,</span><span class="token string">"topic_start"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            headers<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"topic"</span><span class="token punctuation">,</span><span class="token string">"topic_event"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">return</span> event<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Event</span><span class="token punctuation">></span></span> <span class="token function">intercept</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Event</span><span class="token punctuation">></span></span> events<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Event</span><span class="token punctuation">></span></span> interceptors <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Event</span> event <span class="token operator">:</span> events<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">Event</span> intercept1 <span class="token operator">=</span> <span class="token function">intercept</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>

            interceptors<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>intercept1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">return</span> interceptors<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Builder</span> <span class="token keyword">implements</span>  <span class="token class-name">Interceptor</span><span class="token punctuation">.</span><span class="token class-name">Builder</span><span class="token punctuation">&#123;</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token class-name">Interceptor</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">LogTypeInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>6）打包</p>
<p>拦截器打包之后，只需要单独包，不需要将依赖的包上传。打包之后要放入Flume的lib文件夹下面。</p>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307191818447.png" class="" title="image-20210307191818447" loading="lazy">
<p>注意：为什么不需要依赖包？因为依赖包在flume的lib目录下面已经存在了。</p>
<p>7）需要先将打好的包放入到hadoop102的/opt/module/flume/lib文件夹下面。</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 lib]$ ls | grep interceptor
flume-interceptor-1.0-SNAPSHOT.jar<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>8）分发Flume到hadoop103、hadoop104</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 module]$ xsync flume&#x2F;

[atguigu@hadoop102 flume]$ bin&#x2F;flume-ng agent --name a1 --conf-file conf&#x2F;file-flume-kafka.conf &amp;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="4-4-5-日志采集Flume启动停止脚本"><a class="header-anchor" href="#4-4-5-日志采集Flume启动停止脚本">¶</a>4.4.5 日志采集Flume启动停止脚本</h3>
<p>1）在/home/atguigu/bin目录下创建脚本f1.sh</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 bin]$ vim f1.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>在脚本中填写如下内容</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">#! &#x2F;bin&#x2F;bash

case $1 in
&quot;start&quot;)&#123;
        for i in hadoop102 hadoop103
        do
                echo &quot; --------启动 $i 采集flume-------&quot;
                ssh $i &quot;nohup &#x2F;opt&#x2F;module&#x2F;flume&#x2F;bin&#x2F;flume-ng agent --conf-file &#x2F;opt&#x2F;module&#x2F;flume&#x2F;conf&#x2F;file-flume-kafka.conf --name a1 -Dflume.root.logger&#x3D;INFO,LOGFILE &gt;&#x2F;dev&#x2F;null 2&gt;&amp;1 &amp;&quot;
        done
&#125;;;	
&quot;stop&quot;)&#123;
        for i in hadoop102 hadoop103
        do
                echo &quot; --------停止 $i 采集flume-------&quot;
                ssh $i &quot;ps -ef | grep file-flume-kafka | grep -v grep |awk &#39;&#123;print \$2&#125;&#39; | xargs kill&quot;
        done

&#125;;;
esac<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>说明1：nohup，该命令可以在你退出帐户/关闭终端之后继续运行相应的进程。nohup就是不挂起的意思，不挂断地运行命令。</p>
<p>说明2：/dev/null代表linux的空设备文件，所有往这个文件里面写入的内容都会丢失，俗称&quot;黑洞&quot;。</p>
<p>标准输入0：从键盘获得输入 /proc/self/fd/0</p>
<p>标准输出1：输出到屏幕（即控制台） /proc/self/fd/1</p>
<p>错误输出2：输出到屏幕（即控制台） /proc/self/fd/2</p>
<p>2）增加脚本执行权限</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 bin]$ chmod 777 f1.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>3）f1集群启动脚本</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 module]$ f1.sh start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>4）f1集群停止脚本</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 module]$ f1.sh stop<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="4-5-Kafka安装"><a class="header-anchor" href="#4-5-Kafka安装">¶</a>4.5 Kafka安装</h2>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307192044196.png" class="" title="image-20210307192044196" loading="lazy">
<h3 id="4-5-1-Kafka集群安装"><a class="header-anchor" href="#4-5-1-Kafka集群安装">¶</a>4.5.1 Kafka集群安装</h3>
<p>详见：尚硅谷大数据技术之Kafka</p>
<p>集群规划：</p>
<table>
<thead>
<tr>
<th></th>
<th>服务器hadoop102</th>
<th>服务器hadoop103</th>
<th>服务器hadoop104</th>
</tr>
</thead>
<tbody>
<tr>
<td>Kafka</td>
<td>Kafka</td>
<td>Kafka</td>
<td>Kafka</td>
</tr>
</tbody>
</table>
<h3 id="4-5-2-Kafka集群启动停止脚本"><a class="header-anchor" href="#4-5-2-Kafka集群启动停止脚本">¶</a>4.5.2 Kafka集群启动停止脚本</h3>
<p>1）在/home/atguigu/bin目录下创建脚本kf.sh</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 bin]$ vim kf.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>在脚本中填写如下内容</p>
<pre class="line-numbers language-none"><code class="language-none">#! &#x2F;bin&#x2F;bash

case $1 in
&quot;start&quot;)&#123;
        for i in hadoop102 hadoop103 hadoop104
        do
                echo &quot; --------启动 $i Kafka-------&quot;
                # 用于KafkaManager监控
                ssh $i &quot;export JMX_PORT&#x3D;9988 &amp;&amp; &#x2F;opt&#x2F;module&#x2F;kafka&#x2F;bin&#x2F;kafka-server-start.sh -daemon &#x2F;opt&#x2F;module&#x2F;kafka&#x2F;config&#x2F;server.properties &quot;
        done
&#125;;;
&quot;stop&quot;)&#123;
        for i in hadoop102 hadoop103 hadoop104
        do
                echo &quot; --------停止 $i Kafka-------&quot;
                ssh $i &quot;&#x2F;opt&#x2F;module&#x2F;kafka&#x2F;bin&#x2F;kafka-server-stop.sh stop&quot;
        done
&#125;;;
esac<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>说明：启动Kafka时要先开启JMX端口，是用于后续KafkaManager监控。</p>
<p>2）增加脚本执行权限</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 bin]$ chmod 777 kf.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>3）kf集群启动脚本</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 module]$ kf.sh start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>4）kf集群停止脚本</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 module]$ kf.sh stop<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="4-5-3-查看Kafka-Topic列表"><a class="header-anchor" href="#4-5-3-查看Kafka-Topic列表">¶</a>4.5.3 查看Kafka Topic列表</h3>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 kafka]$ bin&#x2F;kafka-topics.sh --zookeeper hadoop102:2181 --list<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="4-5-4-创建Kafka-Topic"><a class="header-anchor" href="#4-5-4-创建Kafka-Topic">¶</a>4.5.4 创建Kafka Topic</h3>
<p>进入到/opt/module/kafka/目录下分别创建：启动日志主题、事件日志主题。</p>
<p>1）创建启动日志主题</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 kafka]$ bin&#x2F;kafka-topics.sh --zookeeper hadoop102:2181,hadoop103:2181,hadoop104:2181  --create --replication-factor 1 --partitions 1 --topic topic_start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>2）创建事件日志主题</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 kafka]$ bin&#x2F;kafka-topics.sh --zookeeper hadoop102:2181,hadoop103:2181,hadoop104:2181  --create --replication-factor 1 --partitions 1 --topic topic_event<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="4-5-5-删除Kafka-Topic"><a class="header-anchor" href="#4-5-5-删除Kafka-Topic">¶</a>4.5.5 删除Kafka Topic</h3>
<p>1）删除启动日志主题</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 kafka]$ bin&#x2F;kafka-topics.sh --delete --zookeeper hadoop102:2181,hadoop103:2181,hadoop104:2181 --topic topic_start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>2）删除事件日志主题</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 kafka]$ bin&#x2F;kafka-topics.sh --delete --zookeeper hadoop102:2181,hadoop103:2181,hadoop104:2181 --topic topic_event<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="4-5-6-Kafka生产消息"><a class="header-anchor" href="#4-5-6-Kafka生产消息">¶</a>4.5.6 Kafka生产消息</h3>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 kafka]$ bin&#x2F;kafka-console-producer.sh \
--broker-list hadoop102:9092 --topic topic_start
&gt;hello world
&gt;atguigu  atguigu<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="4-5-7-Kafka消费消息"><a class="header-anchor" href="#4-5-7-Kafka消费消息">¶</a>4.5.7 Kafka消费消息</h3>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 kafka]$ bin&#x2F;kafka-console-consumer.sh \
--zookeeper hadoop102:2181 --from-beginning --topic topic_start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>–from-beginning：会把主题中以往所有的数据都读取出来。根据业务场景选择是否增加该配置。</p>
<h3 id="4-5-8-查看Kafka-Topic详情"><a class="header-anchor" href="#4-5-8-查看Kafka-Topic详情">¶</a>4.5.8 查看Kafka Topic详情</h3>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 kafka]$ bin&#x2F;kafka-topics.sh --zookeeper hadoop102:2181 \
--describe --topic topic_start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="4-5-9-Kafka-Manager安装"><a class="header-anchor" href="#4-5-9-Kafka-Manager安装">¶</a>4.5.9 Kafka Manager安装</h3>
<p>Kafka Manager是yahoo的一个Kafka监控管理项目。</p>
<p>1）下载地址</p>
<p><a target="_blank" rel="noopener" href="https://github.com/yahoo/kafka-manager">https://github.com/yahoo/kafka-manager</a></p>
<p>下载之后编译源码，编译完成后，拷贝出：kafka-manager-1.3.3.22.zip</p>
<p>2）拷贝kafka-manager-1.3.3.22.zip到hadoop102的/opt/module目录</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 module]$ pwd
&#x2F;opt&#x2F;module<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>3）解压kafka-manager-1.3.3.22.zip到/opt/module目录</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 module]$ unzip kafka-manager-1.3.3.22.zip<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>4）进入到/opt/module/kafka-manager-1.3.3.22/conf目录，在application.conf文件中修改kafka-manager.zkhosts</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 conf]$ vim application.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>修改为：</p>
<pre class="line-numbers language-none"><code class="language-none">kafka-manager.zkhosts&#x3D;&quot;hadoop102:2181,hadoop103:2181,hadoop104:2181&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>5）启动KafkaManager</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">[atguigu@hadoop102 kafka-manager-1.3.3.22]$ 
nohup bin&#x2F;kafka-manager   -Dhttp.port&#x3D;7456 &gt;&#x2F;opt&#x2F;module&#x2F;kafka-manager-1.3.3.22&#x2F;start.log 2&gt;&amp;1 &amp;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>6）在浏览器中打开</p>
<p><a target="_blank" rel="noopener" href="http://hadoop102:7456">http://hadoop102:7456</a></p>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307192434156.png" class="" title="image-20210307192434156" loading="lazy">
<p>可以看到这个界面，选择添加 cluster；</p>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307192448066.png" class="" title="image-20210307192448066" loading="lazy">
<p>我们要配置好Zookeeper的Hosts，Cluster的Name，Kafka的版本，点击确定。</p>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307192513983.png" class="" title="image-20210307192513983" loading="lazy">
<p>至此，就可以查看整个Kafka集群的状态，包括：Topic的状态、Brokers的状态、Cosumer的状态。</p>
<p>在Kafka的/opt/module/kafka-manager-1.3.3.22/application.home_IS_UNDEFINED<br>
目录下面，可以看到Kafka-Manager的日志。</p>
<p>7）KafkaManager使用</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/u011089412/article/details/87895652">https://blog.csdn.net/u011089412/article/details/87895652</a></p>
<h3 id="4-5-10-Kafka-Manager启动停止脚本"><a class="header-anchor" href="#4-5-10-Kafka-Manager启动停止脚本">¶</a>4.5.10 Kafka Manager启动停止脚本</h3>
<p>1）在/home/atguigu/bin目录下创建脚本km.sh</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 bin]$ vim km.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>在脚本中填写如下内容</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">#! &#x2F;bin&#x2F;bash

case $1 in
&quot;start&quot;)&#123;
        echo &quot; -------- 启动 KafkaManager -------&quot;
        nohup &#x2F;opt&#x2F;module&#x2F;kafka-manager-1.3.3.22&#x2F;bin&#x2F;kafka-manager   -Dhttp.port&#x3D;7456 &gt;start.log 2&gt;&amp;1 &amp;
&#125;;;
&quot;stop&quot;)&#123;
        echo &quot; -------- 停止 KafkaManager -------&quot;
        ps -ef | grep ProdServerStart | grep -v grep |awk &#39;&#123;print $2&#125;&#39; | xargs kill 
&#125;;;
esac<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>2）增加脚本执行权限</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">[atguigu@hadoop102 bin]$ chmod 777 km.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>3）km集群启动脚本</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">[atguigu@hadoop102 module]$ km.sh start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>4）km集群停止脚本</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">[atguigu@hadoop102 module]$ km.sh stop<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="4-5-11-项目经验之Kafka压力测试"><a class="header-anchor" href="#4-5-11-项目经验之Kafka压力测试">¶</a>4.5.11 项目经验之Kafka压力测试</h3>
<p>1）Kafka压测</p>
<p>用Kafka官方自带的脚本，对Kafka进行压测。Kafka压测时，可以查看到哪个地方出现了瓶颈（CPU，内存，网络IO）。一般都是网络IO达到瓶颈。</p>
<pre class="line-numbers language-none"><code class="language-none">kafka-consumer-perf-test.sh
kafka-producer-perf-test.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>2）Kafka Producer压力测试</p>
<p>（1）在/opt/module/kafka/bin目录下面有这两个文件。我们来测试一下</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">[atguigu@hadoop102 kafka]$ bin&#x2F;kafka-producer-perf-test.sh  --topic test --record-size 100 --num-records 100000 --throughput 1000 --producer-props bootstrap.servers&#x3D;hadoop102:9092,hadoop103:9092,hadoop104:9092<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>说明：record-size是一条信息有多大，单位是字节。num-records是总共发送多少条信息。throughput<br>
是每秒多少条信息。</p>
<p>（2）Kafka会打印下面的信息</p>
<pre class="line-numbers language-none"><code class="language-none">5000 records sent, 999.4 records&#x2F;sec (0.10 MB&#x2F;sec), 1.9 ms avg latency, 254.0 max latency.
5002 records sent, 1000.4 records&#x2F;sec (0.10 MB&#x2F;sec), 0.7 ms avg latency, 12.0 max latency.
5001 records sent, 1000.0 records&#x2F;sec (0.10 MB&#x2F;sec), 0.8 ms avg latency, 4.0 max latency.
5000 records sent, 1000.0 records&#x2F;sec (0.10 MB&#x2F;sec), 0.7 ms avg latency, 3.0 max latency.
5000 records sent, 1000.0 records&#x2F;sec (0.10 MB&#x2F;sec), 0.8 ms avg latency, 5.0 max latency.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>参数解析：本例中一共写入10w条消息，每秒向Kafka写入了<strong>0.10MB</strong>的数据，平均是1000条消息/秒，每次写入的平均延迟为0.8毫秒，最大的延迟为254毫秒。</p>
<p>3）Kafka Consumer压力测试</p>
<p>Consumer的测试，如果这四个指标（IO，CPU，内存，网络）都不能改变，考虑增加分区数来提升性能。</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">[atguigu@hadoop102 kafka]$ 
bin&#x2F;kafka-consumer-perf-test.sh --zookeeper hadoop102:2181 --topic test --fetch-size 10000 --messages 10000000 --threads 1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>参数说明：</p>
<p>–zookeeper 指定zookeeper的链接信息</p>
<p>–topic 指定topic的名称</p>
<p>–fetch-size 指定每次fetch的数据的大小</p>
<p>–messages 总共要消费的消息个数</p>
<p>测试结果说明：</p>
<p><code>start.time, end.time, data.consumed.in.MB, MB.sec,data.consumed.in.nMsg, nMsg.sec 2019-02-19 20:29:07:566, 2019-02-19 20:29:12:170, 9.5368,2.0714, 100010, 21722.4153</code></p>
<p><strong>开始测试时间，测试结束数据，最大吞吐率</strong>9.5368MB/s，平均每秒消费<strong>2.0714MB/s，最大每秒消费</strong>100010条，平均每秒消费<strong>21722.4153条。</strong></p>
<h3 id="4-5-12-项目经验之Kafka机器数量计算"><a class="header-anchor" href="#4-5-12-项目经验之Kafka机器数量计算">¶</a>4.5.12 项目经验之Kafka机器数量计算</h3>
<p>Kafka机器数量（经验公式）=2*（峰值生产速度*副本数/100）+1</p>
<p>先要预估一天大概产生多少数据，然后用Kafka自带的生产压测（只测试Kafka的写入速度，保证数据不积压），计算出峰值生产速度。再根据设定的副本数，就能预估出需要部署Kafka的数量。</p>
<p>比如我们采用压力测试测出写入的速度是10M/s一台，峰值的业务数据的速度是50M/s。副本数为2。</p>
<p>Kafka机器数量=2*（50*2/100）+ 1=3台</p>
<h2 id="4-6-消费Kafka数据Flume"><a class="header-anchor" href="#4-6-消费Kafka数据Flume">¶</a>4.6 消费Kafka数据Flume</h2>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307193005195.png" class="" title="image-20210307193005195" loading="lazy">
<p>集群规划</p>
<table>
<thead>
<tr>
<th></th>
<th>服务器hadoop102</th>
<th>服务器hadoop103</th>
<th>服务器hadoop104</th>
</tr>
</thead>
<tbody>
<tr>
<td>Flume（消费Kafka）</td>
<td></td>
<td></td>
<td>Flume</td>
</tr>
</tbody>
</table>
<h3 id="4-6-1-日志消费Flume配置"><a class="header-anchor" href="#4-6-1-日志消费Flume配置">¶</a>4.6.1 日志消费Flume配置</h3>
<p>1）Flume配置分析</p>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307193052351.png" class="" title="image-20210307193052351" loading="lazy">
<p>2）Flume的具体配置如下：</p>
<p>（1）在hadoop104的/opt/module/flume/conf目录下创建kafka-flume-hdfs.conf文件</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop104 conf]$ vim kafka-flume-hdfs.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>在文件配置如下内容</p>
<pre class="line-numbers language-conf" data-language="conf"><code class="language-conf">## 组件
a1.sources&#x3D;r1 r2
a1.channels&#x3D;c1 c2
a1.sinks&#x3D;k1 k2

## source1
a1.sources.r1.type &#x3D; org.apache.flume.source.kafka.KafkaSource
a1.sources.r1.batchSize &#x3D; 5000
a1.sources.r1.batchDurationMillis &#x3D; 2000
a1.sources.r1.kafka.bootstrap.servers &#x3D; hadoop102:9092,hadoop103:9092,hadoop104:9092
a1.sources.r1.kafka.topics&#x3D;topic_start

## source2
a1.sources.r2.type &#x3D; org.apache.flume.source.kafka.KafkaSource
a1.sources.r2.batchSize &#x3D; 5000
a1.sources.r2.batchDurationMillis &#x3D; 2000
a1.sources.r2.kafka.bootstrap.servers &#x3D; hadoop102:9092,hadoop103:9092,hadoop104:9092
a1.sources.r2.kafka.topics&#x3D;topic_event

## channel1
a1.channels.c1.type &#x3D; file
a1.channels.c1.checkpointDir &#x3D; &#x2F;opt&#x2F;module&#x2F;flume&#x2F;checkpoint&#x2F;behavior1
a1.channels.c1.dataDirs &#x3D; &#x2F;opt&#x2F;module&#x2F;flume&#x2F;data&#x2F;behavior1&#x2F;
a1.channels.c1.maxFileSize &#x3D; 2146435071
a1.channels.c1.capacity &#x3D; 1000000
a1.channels.c1.keep-alive &#x3D; 6

## channel2
a1.channels.c2.type &#x3D; file
a1.channels.c2.checkpointDir &#x3D; &#x2F;opt&#x2F;module&#x2F;flume&#x2F;checkpoint&#x2F;behavior2
a1.channels.c2.dataDirs &#x3D; &#x2F;opt&#x2F;module&#x2F;flume&#x2F;data&#x2F;behavior2&#x2F;
a1.channels.c2.maxFileSize &#x3D; 2146435071
a1.channels.c2.capacity &#x3D; 1000000
a1.channels.c2.keep-alive &#x3D; 6

## sink1
a1.sinks.k1.type &#x3D; hdfs
a1.sinks.k1.hdfs.path &#x3D; &#x2F;origin_data&#x2F;gmall&#x2F;log&#x2F;topic_start&#x2F;%Y-%m-%d
a1.sinks.k1.hdfs.filePrefix &#x3D; logstart-
a1.sinks.k1.hdfs.round &#x3D; true
a1.sinks.k1.hdfs.roundValue &#x3D; 10
a1.sinks.k1.hdfs.roundUnit &#x3D; second

##sink2
a1.sinks.k2.type &#x3D; hdfs
a1.sinks.k2.hdfs.path &#x3D; &#x2F;origin_data&#x2F;gmall&#x2F;log&#x2F;topic_event&#x2F;%Y-%m-%d
a1.sinks.k2.hdfs.filePrefix &#x3D; logevent-
a1.sinks.k2.hdfs.round &#x3D; true
a1.sinks.k2.hdfs.roundValue &#x3D; 10
a1.sinks.k2.hdfs.roundUnit &#x3D; second

## 不要产生大量小文件
a1.sinks.k1.hdfs.rollInterval &#x3D; 10
a1.sinks.k1.hdfs.rollSize &#x3D; 134217728
a1.sinks.k1.hdfs.rollCount &#x3D; 0

a1.sinks.k2.hdfs.rollInterval &#x3D; 10
a1.sinks.k2.hdfs.rollSize &#x3D; 134217728
a1.sinks.k2.hdfs.rollCount &#x3D; 0

## 控制输出文件是原生文件。
a1.sinks.k1.hdfs.fileType &#x3D; CompressedStream 
a1.sinks.k2.hdfs.fileType &#x3D; CompressedStream 

a1.sinks.k1.hdfs.codeC &#x3D; lzop
a1.sinks.k2.hdfs.codeC &#x3D; lzop

## 拼装
a1.sources.r1.channels &#x3D; c1
a1.sinks.k1.channel&#x3D; c1

a1.sources.r2.channels &#x3D; c2
a1.sinks.k2.channel&#x3D; c2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307193218141.png" class="" title="image-20210307193218141" loading="lazy">
<h3 id="4-6-2-项目经验之Flume内存优化"><a class="header-anchor" href="#4-6-2-项目经验之Flume内存优化">¶</a>4.6.2 项目经验之Flume内存优化</h3>
<p>1）问题描述：如果启动消费Flume抛出如下异常</p>
<pre class="line-numbers language-none"><code class="language-none">ERROR hdfs.HDFSEventSink: process failed
java.lang.OutOfMemoryError: GC overhead limit exceeded<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>2）解决方案步骤：</p>
<p>（1）在hadoop102服务器的/opt/module/flume/conf/flume-env.sh文件中增加如下配置</p>
<pre class="line-numbers language-none"><code class="language-none">export JAVA_OPTS&#x3D;&quot;-Xms100m -Xmx2000m -Dcom.sun.management.jmxremote&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>（2）同步配置到hadoop103、hadoop104服务器</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">[atguigu@hadoop102 conf]$ xsync flume-env.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>3）Flume内存参数设置及优化</p>
<p>JVM heap一般设置为4G或更高，部署在单独的服务器上（4核8线程16G内存）</p>
<p>-Xmx与-Xms最好设置一致，减少内存抖动带来的性能影响，如果设置不一致容易导致频繁fullgc。</p>
<h3 id="4-6-3-项目经验之Flume组件"><a class="header-anchor" href="#4-6-3-项目经验之Flume组件">¶</a>4.6.3 项目经验之Flume组件</h3>
<p>1）FileChannel和MemoryChannel区别</p>
<p>MemoryChannel传输数据速度更快，但因为数据保存在JVM的堆内存中，Agent进程挂掉会导致数据丢失，适用于对数据质量要求不高的需求。</p>
<p>FileChannel传输速度相对于Memory慢，但数据安全保障高，Agent进程挂掉也可以从失败中恢复数据。</p>
<p>2）FileChannel优化</p>
<p>通过配置dataDirs指向多个路径，每个路径对应不同的硬盘，增大Flume吞吐量。</p>
<p>官方说明如下：</p>
<pre class="line-numbers language-none"><code class="language-none">Comma separated list of directories for storing log files. Using multiple directories on separate disks can improve file channel peformance<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>checkpointDir和backupCheckpointDir也尽量配置在不同硬盘对应的目录中，保证checkpoint坏掉后，可以快速使用backupCheckpointDir恢复数据</p>
<p>3）Sink：HDFS Sink</p>
<p>（1）HDFS存入大量小文件，有什么影响？</p>
<p>**元数据层面：**每个小文件都有一份元数据，其中包括文件路径，文件名，所有者，所属组，权限，创建时间等，这些信息都保存在Namenode内存中。所以小文件过多，会占用Namenode服务器大量内存，影响Namenode性能和使用寿命</p>
<p>**计算层面：**默认情况下MR会对每个小文件启用一个Map任务计算，非常影响计算性能。同时也影响磁盘寻址时间。</p>
<p>（2）HDFS小文件处理</p>
<p>官方默认的这三个参数配置写入HDFS后会产生小文件，hdfs.rollInterval、hdfs.rollSize、hdfs.rollCount</p>
<p>基于以上hdfs.rollInterval=3600，hdfs.rollSize=134217728，hdfs.rollCount<br>
=0，hdfs.roundValue=10，hdfs.roundUnit=<br>
second几个参数综合作用，效果如下：</p>
<p>（1）tmp文件在达到128M时会滚动生成正式文件</p>
<p>（2）tmp文件创建超3600秒时会滚动生成正式文件</p>
<p>举例：在2018-01-01 05:23的时侯sink接收到数据，那会产生如下tmp文件：</p>
<p>/atguigu/20180101/atguigu.201801010620.tmp</p>
<p>即使文件内容没有达到128M，也会在06:23时滚动生成正式文件</p>
<h3 id="4-6-4-日志消费Flume启动停止脚本"><a class="header-anchor" href="#4-6-4-日志消费Flume启动停止脚本">¶</a>4.6.4 日志消费Flume启动停止脚本</h3>
<p>1）在/home/atguigu/bin目录下创建脚本f2.sh</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 bin]$ vim f2.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>在脚本中填写如下内容</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">#! &#x2F;bin&#x2F;bash

case $1 in
&quot;start&quot;)&#123;
        for i in hadoop104
        do
                echo &quot; --------启动 $i 消费flume-------&quot;
                ssh $i &quot;nohup &#x2F;opt&#x2F;module&#x2F;flume&#x2F;bin&#x2F;flume-ng agent --conf-file &#x2F;opt&#x2F;module&#x2F;flume&#x2F;conf&#x2F;kafka-flume-hdfs.conf --name a1 -Dflume.root.logger&#x3D;INFO,LOGFILE &gt;&#x2F;opt&#x2F;module&#x2F;flume&#x2F;log.txt   2&gt;&amp;1 &amp;&quot;
        done
&#125;;;
&quot;stop&quot;)&#123;
        for i in hadoop104
        do
                echo &quot; --------停止 $i 消费flume-------&quot;
                ssh $i &quot;ps -ef | grep kafka-flume-hdfs | grep -v grep |awk &#39;&#123;print \$2&#125;&#39; | xargs kill&quot;
        done

&#125;;;
esac<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>2）增加脚本执行权限</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 bin]$ chmod 777 f2.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>3）f2集群启动脚本</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 module]$ f2.sh start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>4）f2集群停止脚本</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 module]$ f2.sh stop<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="4-7-采集通道启动-停止脚本"><a class="header-anchor" href="#4-7-采集通道启动-停止脚本">¶</a>4.7 采集通道启动/停止脚本</h2>
<p>1）在/home/atguigu/bin目录下创建脚本cluster.sh</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 bin]$ vim cluster.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>在脚本中填写如下内容</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">#! &#x2F;bin&#x2F;bash

case $1 in
&quot;start&quot;)&#123;
	echo &quot; -------- 启动 集群 -------&quot;

	echo &quot; -------- 启动 hadoop集群 -------&quot;
	&#x2F;opt&#x2F;module&#x2F;hadoop-2.7.2&#x2F;sbin&#x2F;start-dfs.sh 
	ssh hadoop103 &quot;&#x2F;opt&#x2F;module&#x2F;hadoop-2.7.2&#x2F;sbin&#x2F;start-yarn.sh&quot;

	#启动 Zookeeper集群
	zk.sh start

sleep 4s;

	#启动 Flume采集集群
	f1.sh start

	#启动 Kafka采集集群
	kf.sh start

sleep 6s;

	#启动 Flume消费集群
	f2.sh start

	#启动 KafkaManager
	km.sh start
&#125;;;
&quot;stop&quot;)&#123;
    echo &quot; -------- 停止 集群 -------&quot;

	#停止 KafkaManager
	km.sh stop

    #停止 Flume消费集群
	f2.sh stop

	#停止 Kafka采集集群
	kf.sh stop

    sleep 6s;

	#停止 Flume采集集群
	f1.sh stop

	#停止 Zookeeper集群
	zk.sh stop

	echo &quot; -------- 停止 hadoop集群 -------&quot;
	ssh hadoop103 &quot;&#x2F;opt&#x2F;module&#x2F;hadoop-2.7.2&#x2F;sbin&#x2F;stop-yarn.sh&quot;
	&#x2F;opt&#x2F;module&#x2F;hadoop-2.7.2&#x2F;sbin&#x2F;stop-dfs.sh 
&#125;;;
esac<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>2）增加脚本执行权限</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 bin]$ chmod 777 cluster.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>3）cluster集群启动脚本</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 module]$ cluster.sh start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>4）cluster集群停止脚本</p>
<pre class="line-numbers language-none"><code class="language-none">[atguigu@hadoop102 module]$ cluster.sh stop<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h1>第5章 总结</h1>
<h2 id="5-1-数仓概念总结"><a class="header-anchor" href="#5-1-数仓概念总结">¶</a>5.1 数仓概念总结</h2>
<p><strong>1）数据仓库的输入数据源和输出系统分别是什么？</strong></p>
<p>输入系统：埋点产生的用户行为数据、JavaEE后台产生的业务数据。</p>
<p>输出系统：报表系统、用户画像系统、推荐系统</p>
<h2 id="5-2-项目需求及架构总结"><a class="header-anchor" href="#5-2-项目需求及架构总结">¶</a>5.2 项目需求及架构总结</h2>
<h3 id="5-2-1-集群规模计算"><a class="header-anchor" href="#5-2-1-集群规模计算">¶</a>5.2.1 集群规模计算</h3>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307193532322.png" class="" title="image-20210307193532322" loading="lazy">
<h3 id="5-2-2-框架版本选型"><a class="header-anchor" href="#5-2-2-框架版本选型">¶</a>5.2.2 框架版本选型</h3>
<p>1）Apache：运维麻烦，组件间兼容性需要自己调研。（一般大厂使用，技术实力雄厚，有专业的运维人员）</p>
<p>2）CDH：国内使用最多的版本，但CM不开源，但其实对中、小公司使用来说没有影响（建议使用）</p>
<p>3）HDP：开源，可以进行二次开发，但是没有CDH稳定,国内使用较少</p>
<h3 id="5-2-3-服务器选型"><a class="header-anchor" href="#5-2-3-服务器选型">¶</a>5.2.3 服务器选型</h3>
<p>服务器使用物理机还是云主机？</p>
<p>1）机器成本考虑：</p>
<p>（1）物理机：以128G内存，20核物理CPU，40线程，8THDD和2TSSD硬盘，单台报价4W出头，需考虑托管服务器费用。一般物理机寿命5年左右</p>
<p>（2）云主机，以阿里云为例，差不多相同配置，每年5W</p>
<p>2）运维成本考虑：</p>
<p>（1）物理机：需要有专业的运维人员</p>
<p>（2）云主机：很多运维工作都由阿里云已经完成，运维相对较轻松</p>
<h2 id="5-3-数据采集模块总结"><a class="header-anchor" href="#5-3-数据采集模块总结">¶</a>5.3 数据采集模块总结</h2>
<h3 id="5-3-1-Linux-Shell相关总结"><a class="header-anchor" href="#5-3-1-Linux-Shell相关总结">¶</a>5.3.1 Linux&amp;Shell相关总结</h3>
<p>1）Linux常用命令</p>
<table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>命令解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>top</td>
<td>查看内存</td>
</tr>
<tr>
<td>2</td>
<td>df -h</td>
<td>查看磁盘存储情况</td>
</tr>
<tr>
<td>3</td>
<td>iotop</td>
<td>查看磁盘IO读写(yum install iotop安装）</td>
</tr>
<tr>
<td>4</td>
<td>iotop -o</td>
<td>直接查看比较高的磁盘读写程序</td>
</tr>
<tr>
<td>5</td>
<td>netstat -tunlp | grep 端口号</td>
<td>查看端口占用情况</td>
</tr>
<tr>
<td>6</td>
<td>uptime</td>
<td>查看报告系统运行时长及平均负载</td>
</tr>
<tr>
<td>7</td>
<td>ps  aux</td>
<td>查看进程</td>
</tr>
</tbody>
</table>
<p>2）Shell常用工具</p>
<p>awk、sed、cut、sort</p>
<h3 id="5-3-2-Hadoop相关总结"><a class="header-anchor" href="#5-3-2-Hadoop相关总结">¶</a>5.3.2 Hadoop相关总结</h3>
<p><strong>1）Hadoop默认不支持LZO压缩，如果需要支持LZO压缩，需要添加jar包，并在hadoop的cores-site.xml文件中添加相关压缩配置。</strong></p>
<p>2）Hadoop常用端口号</p>
<p>3）Hadoop配置文件以及简单的Hadoop集群搭建</p>
<p>4）HDFS读流程和写流程</p>
<p>5）MapReduce的Shuffle过程及Hadoop优化（包括：压缩、小文件、集群优化）</p>
<p>6）Yarn的Job提交流程</p>
<p>7）Yarn的默认调度器、调度器分类、以及他们之间的区别</p>
<p>8）HDFS存储多目录</p>
<p>9）Hadoop参数调优</p>
<p>10）项目经验之基准测试</p>
<h3 id="5-3-3-Zookeeper相关总结"><a class="header-anchor" href="#5-3-3-Zookeeper相关总结">¶</a>5.3.3 Zookeeper相关总结</h3>
<p>1）选举机制</p>
<p>半数机制</p>
<p>2）常用命令</p>
<p>ls、get、create</p>
<h3 id="5-3-4-Flume相关总结"><a class="header-anchor" href="#5-3-4-Flume相关总结">¶</a>5.3.4 Flume相关总结</h3>
<p>1）Flume组成，Put事务，Take事务</p>
<p>Taildir Source：断点续传、多目录。Flume1.6以前需要自己自定义Source记录每次读取文件位置，实现断点续传。</p>
<p>File Channel：数据存储在磁盘，宕机数据可以保存。但是传输速率慢。适合对数据传输可靠性要求高的场景，比如，金融行业。</p>
<p>Memory Channel：数据存储在内存中，宕机数据丢失。传输速率快。适合对数据传输可靠性要求不高的场景，比如，普通的日志数据。</p>
<p>Kafka Channel：减少了Flume的Sink阶段，提高了传输效率。</p>
<p>Source到Channel是Put事务</p>
<p>Channel到Sink是Take事务</p>
<p>2）Flume拦截器</p>
<p>（1）拦截器注意事项</p>
<p>项目中自定义了：ETL拦截器和区分类型拦截器。</p>
<p>采用两个拦截器的优缺点：优点，模块化开发和可移植性；缺点，性能会低一些</p>
<p>（2）自定义拦截器步骤</p>
<p>a）实现 Interceptor</p>
<p>b）重写四个方法</p>
<ul>
<li>
<p>initialize 初始化</p>
</li>
<li>
<p>public Event intercept(Event event) 处理单个Event</p>
</li>
<li>
<p>public List&lt;Event&gt; intercept(List&lt;Event&gt; events)<br>
处理多个Event，在这个方法中调用Event intercept(Event event)</p>
</li>
<li>
<p>close 方法</p>
</li>
</ul>
<p>c）静态内部类，实现Interceptor.Builder</p>
<p>3）Flume Channel选择器</p>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307193759592.png" class="" title="image-20210307193759592" loading="lazy">
<p>4）Flume 监控器</p>
<p>Ganglia</p>
<p>5）Flume采集数据会丢失吗?</p>
<p>不会，Channel存储可以存储在File中，数据传输自身有事务。</p>
<p>6）Flume内存</p>
<p>开发中在flume-env.sh中设置JVM heap为4G或更高，部署在单独的服务器上（4核8线程16G内存）</p>
<p>-Xmx与-Xms最好设置一致，减少内存抖动带来的性能影响，如果设置不一致容易导致频繁fullgc。</p>
<p>7）FileChannel优化</p>
<p>通过配置dataDirs指向多个路径，每个路径对应不同的硬盘，增大Flume吞吐量。</p>
<p>官方说明如下：</p>
<pre class="line-numbers language-none"><code class="language-none">Comma separated list of directories for storing log files. Using multiple directories on separate disks can improve file channel peformance<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>checkpointDir和backupCheckpointDir也尽量配置在不同硬盘对应的目录中，保证checkpoint坏掉后，可以快速使用backupCheckpointDir恢复数据</p>
<p>8）Sink：HDFS Sink小文件处理</p>
<p>（1）HDFS存入大量小文件，有什么影响？</p>
<p>**元数据层面：**每个小文件都有一份元数据，其中包括文件路径，文件名，所有者，所属组，权限，创建时间等，这些信息都保存在Namenode内存中。所以小文件过多，会占用Namenode服务器大量内存，影响Namenode性能和使用寿命</p>
<p>**计算层面：**默认情况下MR会对每个小文件启用一个Map任务计算，非常影响计算性能。同时也影响磁盘寻址时间。</p>
<p>（2）HDFS小文件处理</p>
<p>官方默认的这三个参数配置写入HDFS后会产生小文件，hdfs.rollInterval、hdfs.rollSize、hdfs.rollCount</p>
<p>基于以上hdfs.rollInterval=3600，hdfs.rollSize=134217728，hdfs.rollCount<br>
=0，hdfs.roundValue=10，hdfs.roundUnit=<br>
second几个参数综合作用，效果如下：</p>
<p>（1）tmp文件在达到128M时会滚动生成正式文件</p>
<p>（2）tmp文件创建超10秒时会滚动生成正式文件</p>
<p>举例：在2018-01-01 05:23的时侯sink接收到数据，那会产生如下tmp文件：</p>
<p>/atguigu/20180101/atguigu.201801010520.tmp</p>
<p>即使文件内容没有达到128M，也会在05:33时滚动生成正式文件</p>
<h3 id="5-3-5-Kafka相关总结"><a class="header-anchor" href="#5-3-5-Kafka相关总结">¶</a>5.3.5 Kafka相关总结</h3>
<img src="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/image-20210307193909679.png" class="" title="image-20210307193909679" loading="lazy">
<p>1）Kafka压测</p>
<blockquote>
<p>Kafka官方自带压力测试脚本（<a target="_blank" rel="noopener" href="http://kafka-consumer-perf-test.sh">kafka-consumer-perf-test.sh</a>、<a target="_blank" rel="noopener" href="http://kafka-producer-perf-test.sh">kafka-producer-perf-test.sh</a>）。Kafka压测时，可以查看到哪个地方出现了瓶颈（CPU，内存，网络IO）。一般都是网络IO达到瓶颈。</p>
</blockquote>
<p>2）Kafka的机器数量</p>
<p>Kafka机器数量=2*（峰值生产速度*副本数/100）+1</p>
<p>3）Kafka的日志保存时间</p>
<p>7天</p>
<p>4）Kafka的硬盘大小</p>
<p>每天的数据量*7天</p>
<p>5）Kafka监控</p>
<p>公司自己开发的监控器；</p>
<p>开源的监控器：KafkaManager、KafkaMonitor</p>
<p>6）Kakfa分区数。</p>
<p>分区数并不是越多越好，一般分区数不要超过集群机器数量。分区数越多占用内存越大（ISR等），一个节点集中的分区也就越多，当它宕机的时候，对系统的影响也就越大。</p>
<p>分区数一般设置为：3-10个</p>
<p>7）副本数设定</p>
<p>一般我们设置成2个或3个，很多企业设置为2个。</p>
<p>8）多少个Topic</p>
<p>通常情况：多少个日志类型就多少个Topic。也有对日志类型进行合并的。</p>
<p>9）Kafka丢不丢数据</p>
<p>Ack=0，相当于异步发送，消息发送完毕即offset增加，继续生产。</p>
<p>Ack=1，leader收到leader replica<br>
对一个消息的接受ack才增加offset，然后继续生产。</p>
<p>Ack=-1，leader收到所有replica<br>
对一个消息的接受ack才增加offset，然后继续生产。</p>
<p>10）Kafka的ISR副本同步队列</p>
<p>ISR（In-Sync<br>
Replicas），副本同步队列。ISR中包括Leader和Follower。如果Leader进程挂掉，会在ISR队列中选择一个服务作为新的Leader。有replica.lag.max.messages（延迟条数）<a target="_blank" rel="noopener" href="http://xn--replica-7r4l.lag.time.max.ms">和replica.lag.time.max.ms</a>（延迟时间）两个参数决定一台服务是否可以加入ISR副本队列，在0.10版本移除了replica.lag.max.messages参数，防止服务频繁的进去队列。</p>
<p>任意一个维度超过阈值都会把Follower剔除出ISR，存入OSR（Outof-Sync<br>
Replicas）列表，新加入的Follower也会先存放在OSR中。</p>
<p>11）Kafka分区分配策略</p>
<p>在 Kafka内部存在两种默认的分区分配策略：Range和 RoundRobin。</p>
<p>Range是默认策略。Range是对每个Topic而言的（即一个Topic一个Topic分），首先对同一个Topic里面的分区按照序号进行排序，并对消费者按照字母顺序进行排序。然后用Partitions分区的个数除以消费者线程的总数来决定每个消费者线程消费几个分区。如果除不尽，那么前面几个消费者线程将会多消费一个分区。</p>
<p>例如：我们有10个分区，两个消费者（C1，C2），3个消费者线程，10 / 3 =<br>
3而且除不尽。</p>
<p>C1-0 将消费 0, 1, 2, 3 分区</p>
<p>C2-0 将消费 4, 5, 6 分区</p>
<p>C2-1 将消费 7, 8, 9 分区</p>
<p>RoundRobin：前提：同一个Consumer<br>
Group里面的所有消费者的num.streams（消费者消费线程数）必须相等；每个消费者订阅的主题必须相同。</p>
<p>第一步：将所有主题分区组成TopicAndPartition列表，然后对TopicAndPartition列表按照hashCode进行排序，最后按照轮询的方式发给每一个消费线程。</p>
<p>12）Kafka中数据量计算</p>
<p>每天总数据量100g，每天产生1亿条日志， 10000万/24/60/60=1150条/每秒钟</p>
<p>平均每秒钟：1150条</p>
<p>低谷每秒钟：400条</p>
<p>高峰每秒钟：1150条*（2-20倍）=2300条-23000条</p>
<p>每条日志大小：0.5k-2k</p>
<p>每秒多少数据量：2.3M-20MB</p>
<p>13） Kafka挂掉</p>
<blockquote>
<p>（1）Flume记录</p>
<p>（2）日志有记录</p>
<p>（3）短期没事</p>
</blockquote>
<p>14） Kafka消息数据积压，Kafka消费能力不足怎么处理？</p>
<p>（1）如果是Kafka消费能力不足，则可以考虑增加Topic的分区数，并且同时提升消费组的消费者数量，消费者数=分区数。（两者缺一不可）</p>
<p>（2）如果是下游的数据处理不及时：提高每批次拉取的数量。批次拉取数据过少（拉取数据/处理时间&lt;生产速度），使处理的数据小于生产的数据，也会造成数据积压。</p>
</div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="打赏" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">I'm so cute. Please give me money.</div><div id="qr" style="display:none;"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/alipay-qrcode.jpg"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/alipay-qrcode.jpg" alt="支付宝" title="支付宝"></a><div><span style="color:#00A3EE"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-alipay-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/qqpay-qrcode.png"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/qqpay-qrcode.png" alt="QQ 支付" title="QQ 支付"></a><div><span style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/wechatpay-qrcode.jpg"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/wechatpay-qrcode.jpg" alt="微信支付" title="微信支付"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>momo</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/" title="1用户行为数据仓库">https://ppxiaodi.github.io/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E7%94%B5%E5%95%86%E6%95%B0%E4%BB%93%EF%BC%881%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%EF%BC%89/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> 许可协议。</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2021/03/07/CollectionNote/big/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/Zookeeper/" rel="prev" title="Zookeeper"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">Zookeeper</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2021/03/04/CollectionNote/%E6%94%B6%E8%97%8F%E9%93%BE%E6%8E%A5/linux/vagrant%E6%94%B6%E8%97%8F/" rel="next" title="vagrant收藏链接"><span class="post-nav-text">vagrant收藏链接</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>要不要和我说些什么？</span><br></div></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 – 2022 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> momo</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v5.2.0</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.7.0</span></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="搜索"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="/js/search/local-search.js" defer></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="搜索..." value=""></div><div id="local-search-result"></div></div></div></body></html>